<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.20">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ch05 – Math-3020: Statistics for Science &amp; Engineering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/LogoSMSS.webp" rel="icon">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-bd0f20613ab34a035844aaae9062fb4e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b26e8146b40141c674d57af9b78800f5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #522D80;
      }

      .quarto-title-block .quarto-title-banner {
        color: #522D80;
      }
</style>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles/custom1.css">
<link rel="stylesheet" href="styles/slides.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/LogoSMSS.webp" alt="SMSS Logo" class="navbar-logo light-content">
    <img src="../images/LogoSMSS.webp" alt="SMSS Logo" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Math-3020</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../book/index.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/index.html"> 
<span class="menu-text">Lecture Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../introR/index.html"> 
<span class="menu-text">Intro to R</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li class="dropdown-header">Data Sets</li>
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/MYaseen208"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://twitter.com/MYaseen208"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text">Twitter</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/muhammad-yaseen-247800b4/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/index.html">Table of Contents</a></li><li class="breadcrumb-item"><a href="../book/Ch05.html">Decision Making for Two Samples</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/index.html">Table of Contents</a></li><li class="breadcrumb-item"><a href="../book/Ch05.html">Decision Making for Two Samples</a></li></ol></nav></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Table of Contents</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Role of Statistics in Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Summary and Presentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Variables and Probability Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Decision Making for a Single Sample</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch05.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Decision Making for Two Samples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building Empirical Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#decision-making-for-two-samples" id="toc-decision-making-for-two-samples" class="nav-link active" data-scroll-target="#decision-making-for-two-samples"><span class="header-section-number">1</span> Decision Making for Two Samples</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">1.1</span> Introduction</a></li>
  <li><a href="#inference-on-the-means-of-two-populations-variances-known" id="toc-inference-on-the-means-of-two-populations-variances-known" class="nav-link" data-scroll-target="#inference-on-the-means-of-two-populations-variances-known"><span class="header-section-number">1.2</span> Inference on the Means of Two Populations, Variances Known</a>
  <ul class="collapse">
  <li><a href="#hypothesis-testing-on-the-difference-in-means" id="toc-hypothesis-testing-on-the-difference-in-means" class="nav-link" data-scroll-target="#hypothesis-testing-on-the-difference-in-means"><span class="header-section-number">1.2.1</span> Hypothesis Testing on the Difference in Means</a></li>
  <li><a href="#example-comparing-two-manufacturing-processes" id="toc-example-comparing-two-manufacturing-processes" class="nav-link" data-scroll-target="#example-comparing-two-manufacturing-processes"><span class="header-section-number">1.2.2</span> Example: Comparing Two Manufacturing Processes</a></li>
  <li><a href="#type-ii-error-and-choice-of-sample-size" id="toc-type-ii-error-and-choice-of-sample-size" class="nav-link" data-scroll-target="#type-ii-error-and-choice-of-sample-size"><span class="header-section-number">1.2.3</span> Type II Error and Choice of Sample Size</a></li>
  <li><a href="#example-power-analysis" id="toc-example-power-analysis" class="nav-link" data-scroll-target="#example-power-analysis"><span class="header-section-number">1.2.4</span> Example: Power Analysis</a></li>
  <li><a href="#confidence-interval-on-the-difference-in-means" id="toc-confidence-interval-on-the-difference-in-means" class="nav-link" data-scroll-target="#confidence-interval-on-the-difference-in-means"><span class="header-section-number">1.2.5</span> Confidence Interval on the Difference in Means</a></li>
  </ul></li>
  <li><a href="#inference-on-the-means-of-two-populations-variances-unknown" id="toc-inference-on-the-means-of-two-populations-variances-unknown" class="nav-link" data-scroll-target="#inference-on-the-means-of-two-populations-variances-unknown"><span class="header-section-number">1.3</span> Inference on the Means of Two Populations, Variances Unknown</a>
  <ul class="collapse">
  <li><a href="#hypothesis-testing-on-the-difference-in-means-1" id="toc-hypothesis-testing-on-the-difference-in-means-1" class="nav-link" data-scroll-target="#hypothesis-testing-on-the-difference-in-means-1"><span class="header-section-number">1.3.1</span> Hypothesis Testing on the Difference in Means</a></li>
  <li><a href="#example-comparing-material-strength" id="toc-example-comparing-material-strength" class="nav-link" data-scroll-target="#example-comparing-material-strength"><span class="header-section-number">1.3.2</span> Example: Comparing Material Strength</a></li>
  <li><a href="#type-ii-error-and-choice-of-sample-size-1" id="toc-type-ii-error-and-choice-of-sample-size-1" class="nav-link" data-scroll-target="#type-ii-error-and-choice-of-sample-size-1"><span class="header-section-number">1.3.3</span> Type II Error and Choice of Sample Size</a></li>
  <li><a href="#confidence-interval-on-the-difference-in-means-1" id="toc-confidence-interval-on-the-difference-in-means-1" class="nav-link" data-scroll-target="#confidence-interval-on-the-difference-in-means-1"><span class="header-section-number">1.3.4</span> Confidence Interval on the Difference in Means</a></li>
  </ul></li>
  <li><a href="#the-paired-t-test" id="toc-the-paired-t-test" class="nav-link" data-scroll-target="#the-paired-t-test"><span class="header-section-number">1.4</span> The Paired t-Test</a>
  <ul class="collapse">
  <li><a href="#example-beforeafter-comparison" id="toc-example-beforeafter-comparison" class="nav-link" data-scroll-target="#example-beforeafter-comparison"><span class="header-section-number">1.4.1</span> Example: Before/After Comparison</a></li>
  </ul></li>
  <li><a href="#inference-on-the-ratio-of-variances-of-two-normal-populations" id="toc-inference-on-the-ratio-of-variances-of-two-normal-populations" class="nav-link" data-scroll-target="#inference-on-the-ratio-of-variances-of-two-normal-populations"><span class="header-section-number">1.5</span> Inference on the Ratio of Variances of Two Normal Populations</a>
  <ul class="collapse">
  <li><a href="#hypothesis-testing-on-the-ratio-of-two-variances" id="toc-hypothesis-testing-on-the-ratio-of-two-variances" class="nav-link" data-scroll-target="#hypothesis-testing-on-the-ratio-of-two-variances"><span class="header-section-number">1.5.1</span> Hypothesis Testing on the Ratio of Two Variances</a></li>
  <li><a href="#example-variance-comparison" id="toc-example-variance-comparison" class="nav-link" data-scroll-target="#example-variance-comparison"><span class="header-section-number">1.5.2</span> Example: Variance Comparison</a></li>
  <li><a href="#confidence-interval-on-the-ratio-of-two-variances" id="toc-confidence-interval-on-the-ratio-of-two-variances" class="nav-link" data-scroll-target="#confidence-interval-on-the-ratio-of-two-variances"><span class="header-section-number">1.5.3</span> Confidence Interval on the Ratio of Two Variances</a></li>
  </ul></li>
  <li><a href="#inference-on-two-population-proportions" id="toc-inference-on-two-population-proportions" class="nav-link" data-scroll-target="#inference-on-two-population-proportions"><span class="header-section-number">1.6</span> Inference on Two Population Proportions</a>
  <ul class="collapse">
  <li><a href="#hypothesis-testing-on-the-equality-of-two-proportions" id="toc-hypothesis-testing-on-the-equality-of-two-proportions" class="nav-link" data-scroll-target="#hypothesis-testing-on-the-equality-of-two-proportions"><span class="header-section-number">1.6.1</span> Hypothesis Testing on the Equality of Two Proportions</a></li>
  <li><a href="#example-comparing-defect-rates" id="toc-example-comparing-defect-rates" class="nav-link" data-scroll-target="#example-comparing-defect-rates"><span class="header-section-number">1.6.2</span> Example: Comparing Defect Rates</a></li>
  <li><a href="#type-ii-error-and-choice-of-sample-size-2" id="toc-type-ii-error-and-choice-of-sample-size-2" class="nav-link" data-scroll-target="#type-ii-error-and-choice-of-sample-size-2"><span class="header-section-number">1.6.3</span> Type II Error and Choice of Sample Size</a></li>
  <li><a href="#confidence-interval-on-the-difference-in-proportions" id="toc-confidence-interval-on-the-difference-in-proportions" class="nav-link" data-scroll-target="#confidence-interval-on-the-difference-in-proportions"><span class="header-section-number">1.6.4</span> Confidence Interval on the Difference in Proportions</a></li>
  </ul></li>
  <li><a href="#summary-tables-for-inference-procedures-for-two-samples" id="toc-summary-tables-for-inference-procedures-for-two-samples" class="nav-link" data-scroll-target="#summary-tables-for-inference-procedures-for-two-samples"><span class="header-section-number">1.7</span> Summary Tables for Inference Procedures for Two Samples</a></li>
  <li><a href="#what-if-we-have-more-than-two-samples" id="toc-what-if-we-have-more-than-two-samples" class="nav-link" data-scroll-target="#what-if-we-have-more-than-two-samples"><span class="header-section-number">1.8</span> What if We Have More than Two Samples?</a>
  <ul class="collapse">
  <li><a href="#completely-randomized-experiment-and-analysis-of-variance" id="toc-completely-randomized-experiment-and-analysis-of-variance" class="nav-link" data-scroll-target="#completely-randomized-experiment-and-analysis-of-variance"><span class="header-section-number">1.8.1</span> Completely Randomized Experiment and Analysis of Variance</a></li>
  <li><a href="#example-comparing-multiple-processes" id="toc-example-comparing-multiple-processes" class="nav-link" data-scroll-target="#example-comparing-multiple-processes"><span class="header-section-number">1.8.2</span> Example: Comparing Multiple Processes</a></li>
  <li><a href="#randomized-complete-block-experiment" id="toc-randomized-complete-block-experiment" class="nav-link" data-scroll-target="#randomized-complete-block-experiment"><span class="header-section-number">1.8.3</span> Randomized Complete Block Experiment</a></li>
  <li><a href="#example-blocked-experiment" id="toc-example-blocked-experiment" class="nav-link" data-scroll-target="#example-blocked-experiment"><span class="header-section-number">1.8.4</span> Example: Blocked Experiment</a></li>
  </ul></li>
  <li><a href="#comprehensive-example-quality-improvement-study" id="toc-comprehensive-example-quality-improvement-study" class="nav-link" data-scroll-target="#comprehensive-example-quality-improvement-study"><span class="header-section-number">1.9</span> Comprehensive Example: Quality Improvement Study</a></li>
  <li><a href="#key-formulas-and-decision-framework" id="toc-key-formulas-and-decision-framework" class="nav-link" data-scroll-target="#key-formulas-and-decision-framework"><span class="header-section-number">1.10</span> Key Formulas and Decision Framework</a></li>
  <li><a href="#sample-size-and-power-analysis" id="toc-sample-size-and-power-analysis" class="nav-link" data-scroll-target="#sample-size-and-power-analysis"><span class="header-section-number">1.11</span> Sample Size and Power Analysis</a></li>
  <li><a href="#effect-size-analysis" id="toc-effect-size-analysis" class="nav-link" data-scroll-target="#effect-size-analysis"><span class="header-section-number">1.12</span> Effect Size Analysis</a></li>
  <li><a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="header-section-number">1.13</span> Chapter Summary</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="decision-making-for-two-samples" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Decision Making for Two Samples</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Major Themes of Chapter 5
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Two-Sample Comparisons:</strong> Comparing parameters between two populations or treatments</p></li>
<li><p><strong>Paired vs.&nbsp;Independent Samples:</strong> Understanding when to use different comparison methods</p></li>
<li><p><strong>Variance Comparisons:</strong> Testing equality of variances using F-tests</p></li>
<li><p><strong>Proportion Comparisons:</strong> Comparing success rates between two groups</p></li>
<li><p><strong>Introduction to ANOVA:</strong> Extending two-sample methods to multiple samples</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>After careful study of this chapter, you should be able to do the following:</p>
<ol type="1">
<li><p>Test hypotheses and construct confidence intervals for the <span style="color:green">difference between two means</span> when variances are known and unknown.</p></li>
<li><p>Understand and apply the <span style="color:green">pooled variance procedure</span> for two-sample t-tests.</p></li>
<li><p>Conduct and interpret <span style="color:green">paired t-tests</span> for dependent samples.</p></li>
<li><p>Test hypotheses and construct confidence intervals for the <span style="color:green">ratio of two variances</span> using F-tests.</p></li>
<li><p>Compare <span style="color:green">two population proportions</span> using appropriate statistical methods.</p></li>
<li><p>Calculate <span style="color:green">sample sizes</span> and <span style="color:green">power</span> for two-sample tests.</p></li>
<li><p>Understand the basic concepts of <span style="color:green">Analysis of Variance (ANOVA)</span>.</p></li>
<li><p>Distinguish between <span style="color:green">completely randomized</span> and <span style="color:green">randomized complete block</span> experimental designs.</p></li>
</ol>
</div>
</div>
<section id="introduction" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1.1</span> Introduction</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Two-Sample Problems
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many engineering problems involve comparing two populations, processes, or treatments. Common scenarios include:</p>
<ul>
<li><p>Comparing the mean strength of materials from two suppliers</p></li>
<li><p>Testing whether a new manufacturing process reduces defect rates</p></li>
<li><p>Evaluating if a design modification improves performance</p></li>
<li><p>Comparing measurements before and after a process change</p></li>
</ul>
<p>The choice of statistical method depends on:</p>
<ul>
<li><p>Whether samples are <strong>independent</strong> or <strong>paired</strong></p></li>
<li><p>Whether population variances are <strong>known</strong> or <strong>unknown</strong></p></li>
<li><p>Whether variances can be assumed <strong>equal</strong> or <strong>unequal</strong></p></li>
</ul>
</div>
</div>
</section>
<section id="inference-on-the-means-of-two-populations-variances-known" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="inference-on-the-means-of-two-populations-variances-known"><span class="header-section-number">1.2</span> Inference on the Means of Two Populations, Variances Known</h2>
<section id="hypothesis-testing-on-the-difference-in-means" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="hypothesis-testing-on-the-difference-in-means"><span class="header-section-number">1.2.1</span> Hypothesis Testing on the Difference in Means</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Two-Sample Z-Test (σ₁, σ₂ known)
</div>
</div>
<div class="callout-body-container callout-body">
<p>When both population variances are known, the test statistic for testing H₀: μ₁ = μ₂ is:</p>
<p><span class="math display">Z_0 = \frac{(\overline{X_1} - \overline{X_2}) - (\mu_1 - \mu_2)}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}</span></p>
<p>Under H₀: μ₁ - μ₂ = 0, Z₀ ~ N(0,1)</p>
<p><strong>Common Hypothesis Tests:</strong></p>
<ul>
<li><p><strong>Two-sided:</strong> H₀: μ₁ = μ₂ vs H₁: μ₁ ≠ μ₂</p></li>
<li><p><strong>One-sided:</strong> H₀: μ₁ ≤ μ₂ vs H₁: μ₁ &gt; μ₂</p></li>
<li><p><strong>One-sided:</strong> H₀: μ₁ ≥ μ₂ vs H₁: μ₁ &lt; μ₂</p></li>
</ul>
</div>
</div>
</section>
<section id="example-comparing-two-manufacturing-processes" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="example-comparing-two-manufacturing-processes"><span class="header-section-number">1.2.2</span> Example: Comparing Two Manufacturing Processes</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A company wants to compare the tensile strength of cables produced by two different machines. Machine 1 produces cables with σ₁ = 12 psi, and Machine 2 with σ₂ = 10 psi. Random samples yield:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"></a><a href="data/cable_strength.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cable Strength Data Summary by Machine:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     machine     n      Min       Q1   Median     Mean       Q3      Max
      &lt;char&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
1: Machine_1    20 221.4006 239.0774 246.4398 246.6995 251.5847 266.4430
2: Machine_2    25 221.1331 231.0529 235.9208 238.0735 246.2158 259.6896
          SD       Var
       &lt;num&gt;     &lt;num&gt;
1: 11.671984 136.23521
2:  9.449202  89.28741</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">library</span>(data.table)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">library</span>(scales)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># Cable strength comparison (two-sample Z-test, sigma known)</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a>cable_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb3-12"><a href="#cb3-12"></a>  <span class="at">machine =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Machine_1"</span>, <span class="st">"Machine_2"</span>), <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>)),</span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="at">strength =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">245</span>, <span class="at">sd =</span> <span class="dv">12</span>), <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">238</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb3-14"><a href="#cb3-14"></a>)</span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co"># Summary statistics using collapse functions</span></span>
<span id="cb3-17"><a href="#cb3-17"></a>cable_summary <span class="ot">&lt;-</span> cable_data <span class="sc">%&gt;%</span> </span>
<span id="cb3-18"><a href="#cb3-18"></a>  <span class="fu">fgroup_by</span>(machine) <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a href="#cb3-19"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(strength),</span>
<span id="cb3-21"><a href="#cb3-21"></a>    <span class="at">Min =</span> <span class="fu">fmin</span>(strength),</span>
<span id="cb3-22"><a href="#cb3-22"></a>    <span class="at">Q1 =</span> <span class="fu">fquantile</span>(strength, <span class="fl">0.25</span>),</span>
<span id="cb3-23"><a href="#cb3-23"></a>    <span class="at">Median =</span> <span class="fu">fmedian</span>(strength),</span>
<span id="cb3-24"><a href="#cb3-24"></a>    <span class="at">Mean =</span> <span class="fu">fmean</span>(strength),</span>
<span id="cb3-25"><a href="#cb3-25"></a>    <span class="at">Q3 =</span> <span class="fu">fquantile</span>(strength, <span class="fl">0.75</span>),</span>
<span id="cb3-26"><a href="#cb3-26"></a>    <span class="at">Max =</span> <span class="fu">fmax</span>(strength),</span>
<span id="cb3-27"><a href="#cb3-27"></a>    <span class="at">SD =</span> <span class="fu">fsd</span>(strength),</span>
<span id="cb3-28"><a href="#cb3-28"></a>    <span class="at">Var =</span> <span class="fu">fvar</span>(strength)</span>
<span id="cb3-29"><a href="#cb3-29"></a>  )</span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="fu">print</span>(<span class="st">"Cable Strength Data Summary by Machine:"</span>)</span>
<span id="cb3-32"><a href="#cb3-32"></a><span class="fu">print</span>(cable_summary)</span>
<span id="cb3-33"><a href="#cb3-33"></a></span>
<span id="cb3-34"><a href="#cb3-34"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="fu">fwrite</span>(cable_data, <span class="st">"data/cable_strength.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">

</div>
</div>
</div>
<p>Test H₀: μ₁ = μ₂ vs H₁: μ₁ ≠ μ₂ at α = 0.05.</p>
<p><strong>Manual Calculation:</strong></p>
<p>Given: n₁ = 20, x̄₁ = 245, σ₁ = 12, n₂ = 25, x̄₂ = 238, σ₂ = 10</p>
<ol type="1">
<li><p><strong>Test Statistic:</strong> <span class="math display">Z_0 = \frac{(245 - 238) - 0}{\sqrt{\frac{12^2}{20} + \frac{10^2}{25}}} = \frac{7}{\sqrt{7.2 + 4}} = \frac{7}{3.35} = 2.09</span></p></li>
<li><p><strong>Critical Value:</strong> z₀.₀₂₅ = 1.96</p></li>
<li><p><strong>Decision:</strong> |Z₀| = 2.09 &gt; 1.96, so reject H₀</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-Sample Z-Test Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Test_Type    n1    n2 xbar1  xbar2 sigma1 sigma2 Pooled_SE
                        &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;     &lt;num&gt;
1: Two-sample Z-test (σ known)    20    25 246.7 238.07     12     10     3.347
   Z_Statistic P_Value Alpha Z_Critical  Decision
         &lt;num&gt;   &lt;num&gt; &lt;num&gt;      &lt;num&gt;    &lt;char&gt;
1:      2.5775    0.01  0.05       1.96 Reject H0
                          Conclusion
                              &lt;char&gt;
1: Means are significantly different</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Two-sample Z-test (manual and R calculations)</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># Known population standard deviations</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co"># Extract sample statistics</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>machine1_data <span class="ot">&lt;-</span> cable_data[machine <span class="sc">==</span> <span class="st">"Machine_1"</span>]</span>
<span id="cb6-9"><a href="#cb6-9"></a>machine2_data <span class="ot">&lt;-</span> cable_data[machine <span class="sc">==</span> <span class="st">"Machine_2"</span>]</span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a>n1 <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(machine1_data<span class="sc">$</span>strength)</span>
<span id="cb6-12"><a href="#cb6-12"></a>n2 <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(machine2_data<span class="sc">$</span>strength)</span>
<span id="cb6-13"><a href="#cb6-13"></a>xbar1 <span class="ot">&lt;-</span> <span class="fu">fmean</span>(machine1_data<span class="sc">$</span>strength)</span>
<span id="cb6-14"><a href="#cb6-14"></a>xbar2 <span class="ot">&lt;-</span> <span class="fu">fmean</span>(machine2_data<span class="sc">$</span>strength)</span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co"># Manual calculation</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>pooled_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((sigma1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n1 <span class="sc">+</span> (sigma2<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n2)</span>
<span id="cb6-18"><a href="#cb6-18"></a>z_stat <span class="ot">&lt;-</span> (xbar1 <span class="sc">-</span> xbar2) <span class="sc">/</span> pooled_se</span>
<span id="cb6-19"><a href="#cb6-19"></a>p_value_z <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stat)))  <span class="co"># Two-sided test</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>z_critical <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb6-21"><a href="#cb6-21"></a></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co"># Test results</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>z_test_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb6-24"><a href="#cb6-24"></a>  <span class="at">Test_Type =</span> <span class="st">"Two-sample Z-test (σ known)"</span>,</span>
<span id="cb6-25"><a href="#cb6-25"></a>  <span class="at">n1 =</span> n1,</span>
<span id="cb6-26"><a href="#cb6-26"></a>  <span class="at">n2 =</span> n2,</span>
<span id="cb6-27"><a href="#cb6-27"></a>  <span class="at">xbar1 =</span> <span class="fu">round</span>(xbar1, <span class="dv">2</span>),</span>
<span id="cb6-28"><a href="#cb6-28"></a>  <span class="at">xbar2 =</span> <span class="fu">round</span>(xbar2, <span class="dv">2</span>),</span>
<span id="cb6-29"><a href="#cb6-29"></a>  <span class="at">sigma1 =</span> sigma1,</span>
<span id="cb6-30"><a href="#cb6-30"></a>  <span class="at">sigma2 =</span> sigma2,</span>
<span id="cb6-31"><a href="#cb6-31"></a>  <span class="at">Pooled_SE =</span> <span class="fu">round</span>(pooled_se, <span class="dv">3</span>),</span>
<span id="cb6-32"><a href="#cb6-32"></a>  <span class="at">Z_Statistic =</span> <span class="fu">round</span>(z_stat, <span class="dv">4</span>),</span>
<span id="cb6-33"><a href="#cb6-33"></a>  <span class="at">P_Value =</span> <span class="fu">round</span>(p_value_z, <span class="dv">4</span>),</span>
<span id="cb6-34"><a href="#cb6-34"></a>  <span class="at">Alpha =</span> alpha,</span>
<span id="cb6-35"><a href="#cb6-35"></a>  <span class="at">Z_Critical =</span> <span class="fu">round</span>(z_critical, <span class="dv">3</span>),</span>
<span id="cb6-36"><a href="#cb6-36"></a>  <span class="at">Decision =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(z_stat) <span class="sc">&gt;</span> z_critical, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb6-37"><a href="#cb6-37"></a>  <span class="at">Conclusion =</span> <span class="fu">ifelse</span>(p_value_z <span class="sc">&lt;</span> alpha, </span>
<span id="cb6-38"><a href="#cb6-38"></a>                     <span class="st">"Means are significantly different"</span>, </span>
<span id="cb6-39"><a href="#cb6-39"></a>                     <span class="st">"No significant difference in means"</span>)</span>
<span id="cb6-40"><a href="#cb6-40"></a>)</span>
<span id="cb6-41"><a href="#cb6-41"></a></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="fu">print</span>(<span class="st">"Two-Sample Z-Test Results:"</span>)</span>
<span id="cb6-43"><a href="#cb6-43"></a><span class="fu">print</span>(z_test_results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="type-ii-error-and-choice-of-sample-size" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="type-ii-error-and-choice-of-sample-size"><span class="header-section-number">1.2.3</span> Type II Error and Choice of Sample Size</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Power and Sample Size for Two-Sample Z-Test
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Type II Error:</strong> For a specific difference δ = |μ₁ - μ₂|:</p>
<p><span class="math display">\beta = P\left(-z_{\alpha/2} - \frac{\delta}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}} \leq Z \leq z_{\alpha/2} - \frac{\delta}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}\right)</span></p>
<p><strong>Sample Size:</strong> For equal sample sizes (n₁ = n₂ = n):</p>
<p><span class="math display">n = \frac{(z_{\alpha/2} + z_\beta)^2(\sigma_1^2 + \sigma_2^2)}{\delta^2}</span></p>
</div>
</div>
</section>
<section id="example-power-analysis" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="example-power-analysis"><span class="header-section-number">1.2.4</span> Example: Power Analysis</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch05Code01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch05Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch05_files/figure-html/fig-Ch05Code01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Power curves for two-sample Z-test"><img src="Ch05_files/figure-html/fig-Ch05Code01-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch05Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Power curves for two-sample Z-test
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Power curves for two-sample Z-test</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>delta_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>alpha_power <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>sigma1_power <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>sigma2_power <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co"># Function to calculate power for two-sample Z-test</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>calculate_power_two_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(delta, n1, n2, sigma1, sigma2, alpha) {</span>
<span id="cb7-10"><a href="#cb7-10"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1 <span class="sc">+</span> sigma2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2)</span>
<span id="cb7-11"><a href="#cb7-11"></a>  z_alpha2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>  </span>
<span id="cb7-13"><a href="#cb7-13"></a>  <span class="co"># Power for two-sided test</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>  power <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(z_alpha2 <span class="sc">-</span> delta<span class="sc">/</span>se) <span class="sc">+</span> <span class="fu">pnorm</span>(<span class="sc">-</span>z_alpha2 <span class="sc">-</span> delta<span class="sc">/</span>se)</span>
<span id="cb7-15"><a href="#cb7-15"></a>  <span class="fu">return</span>(power)</span>
<span id="cb7-16"><a href="#cb7-16"></a>}</span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># Generate power curve data</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>power_curve_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>()</span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="cf">for</span>(n_val <span class="cf">in</span> sample_sizes) {</span>
<span id="cb7-21"><a href="#cb7-21"></a>  <span class="cf">for</span>(delta <span class="cf">in</span> delta_values) {</span>
<span id="cb7-22"><a href="#cb7-22"></a>    power_val <span class="ot">&lt;-</span> <span class="fu">calculate_power_two_sample</span>(delta, n_val, n_val, sigma1_power, sigma2_power, alpha_power)</span>
<span id="cb7-23"><a href="#cb7-23"></a>    power_curve_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(power_curve_data, </span>
<span id="cb7-24"><a href="#cb7-24"></a>                             <span class="fu">data.table</span>(<span class="at">delta =</span> delta, <span class="at">n =</span> <span class="fu">factor</span>(n_val), <span class="at">power =</span> power_val))</span>
<span id="cb7-25"><a href="#cb7-25"></a>  }</span>
<span id="cb7-26"><a href="#cb7-26"></a>}</span>
<span id="cb7-27"><a href="#cb7-27"></a></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co"># Plot power curves</span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="fu">ggplot</span>(<span class="at">data =</span> power_curve_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> delta, <span class="at">y =</span> power, <span class="at">color =</span> n)) <span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb7-31"><a href="#cb7-31"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb7-32"><a href="#cb7-32"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">12</span>, <span class="at">y =</span> <span class="fl">0.82</span>, <span class="at">label =</span> <span class="st">"Power = 0.8"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb7-33"><a href="#cb7-33"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb7-34"><a href="#cb7-34"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">6</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb7-35"><a href="#cb7-35"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-36"><a href="#cb7-36"></a>    <span class="at">x =</span> <span class="st">"True Difference in Means (δ = |μ₁ - μ₂|)"</span>,</span>
<span id="cb7-37"><a href="#cb7-37"></a>    <span class="at">y =</span> <span class="st">"Power (1 - β)"</span>,</span>
<span id="cb7-38"><a href="#cb7-38"></a>    <span class="at">color =</span> <span class="st">"Sample Size</span><span class="sc">\n</span><span class="st">(each group)"</span>,</span>
<span id="cb7-39"><a href="#cb7-39"></a>    <span class="at">title =</span> <span class="st">"Power Curves for Two-Sample Z-Test"</span>,</span>
<span id="cb7-40"><a href="#cb7-40"></a>    <span class="at">subtitle =</span> <span class="st">"H₀: μ₁ = μ₂ vs H₁: μ₁ ≠ μ₂, α = 0.05, σ₁ = 12, σ₂ = 10"</span></span>
<span id="cb7-41"><a href="#cb7-41"></a>  ) <span class="sc">+</span></span>
<span id="cb7-42"><a href="#cb7-42"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb7-43"><a href="#cb7-43"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-44"><a href="#cb7-44"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb7-45"><a href="#cb7-45"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb7-46"><a href="#cb7-46"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb7-47"><a href="#cb7-47"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="confidence-interval-on-the-difference-in-means" class="level3" data-number="1.2.5">
<h3 data-number="1.2.5" class="anchored" data-anchor-id="confidence-interval-on-the-difference-in-means"><span class="header-section-number">1.2.5</span> Confidence Interval on the Difference in Means</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Confidence Interval for μ₁ - μ₂ (σ₁, σ₂ known)
</div>
</div>
<div class="callout-body-container callout-body">
<p>A 100(1-α)% confidence interval for μ₁ - μ₂:</p>
<p><span class="math display">(\overline{x_1} - \overline{x_2}) \pm z_{\alpha/2}\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}</span></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Difference in Means (σ known):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter Confidence_Level Difference Standard_Error Z_Critical Margin_Error
      &lt;char&gt;           &lt;char&gt;      &lt;num&gt;          &lt;num&gt;      &lt;num&gt;        &lt;num&gt;
1:   μ₁ - μ₂              95%       8.63          3.347       1.96        6.559
   Lower_Bound Upper_Bound Width
         &lt;num&gt;       &lt;num&gt; &lt;num&gt;
1:        2.07       15.19 13.12
                                         Interpretation
                                                 &lt;char&gt;
1: 95% confident that μ₁ - μ₂ is between 2.07 and 15.19</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Confidence interval for difference in means (sigma known)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>margin_error_z <span class="ot">&lt;-</span> z_critical <span class="sc">*</span> pooled_se</span>
<span id="cb10-3"><a href="#cb10-3"></a>ci_lower_z <span class="ot">&lt;-</span> (xbar1 <span class="sc">-</span> xbar2) <span class="sc">-</span> margin_error_z</span>
<span id="cb10-4"><a href="#cb10-4"></a>ci_upper_z <span class="ot">&lt;-</span> (xbar1 <span class="sc">-</span> xbar2) <span class="sc">+</span> margin_error_z</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a>z_ci_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="at">Parameter =</span> <span class="st">"μ₁ - μ₂"</span>,</span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="at">Confidence_Level =</span> <span class="st">"95%"</span>,</span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="at">Difference =</span> <span class="fu">round</span>(xbar1 <span class="sc">-</span> xbar2, <span class="dv">2</span>),</span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="at">Standard_Error =</span> <span class="fu">round</span>(pooled_se, <span class="dv">3</span>),</span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="at">Z_Critical =</span> <span class="fu">round</span>(z_critical, <span class="dv">3</span>),</span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="at">Margin_Error =</span> <span class="fu">round</span>(margin_error_z, <span class="dv">3</span>),</span>
<span id="cb10-13"><a href="#cb10-13"></a>  <span class="at">Lower_Bound =</span> <span class="fu">round</span>(ci_lower_z, <span class="dv">2</span>),</span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="at">Upper_Bound =</span> <span class="fu">round</span>(ci_upper_z, <span class="dv">2</span>),</span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="at">Width =</span> <span class="fu">round</span>(ci_upper_z <span class="sc">-</span> ci_lower_z, <span class="dv">2</span>),</span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="at">Interpretation =</span> <span class="fu">paste</span>(<span class="st">"95% confident that μ₁ - μ₂ is between"</span>, </span>
<span id="cb10-17"><a href="#cb10-17"></a>                        <span class="fu">round</span>(ci_lower_z, <span class="dv">2</span>), <span class="st">"and"</span>, <span class="fu">round</span>(ci_upper_z, <span class="dv">2</span>))</span>
<span id="cb10-18"><a href="#cb10-18"></a>)</span>
<span id="cb10-19"><a href="#cb10-19"></a></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Difference in Means (σ known):"</span>)</span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="fu">print</span>(z_ci_results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inference-on-the-means-of-two-populations-variances-unknown" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="inference-on-the-means-of-two-populations-variances-unknown"><span class="header-section-number">1.3</span> Inference on the Means of Two Populations, Variances Unknown</h2>
<section id="hypothesis-testing-on-the-difference-in-means-1" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="hypothesis-testing-on-the-difference-in-means-1"><span class="header-section-number">1.3.1</span> Hypothesis Testing on the Difference in Means</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Two-Sample t-Test (σ₁, σ₂ unknown)
</div>
</div>
<div class="callout-body-container callout-body">
<p>When population variances are unknown, we must consider two cases:</p>
<p><strong>Case 1: Equal Variances (σ₁² = σ₂²)</strong></p>
<ul>
<li>Use pooled variance:</li>
</ul>
<p><span class="math display">S_p^2 = \frac{(n_1-1)S_1^2 + (n_2-1)S_2^2}{n_1 + n_2 - 2}</span></p>
<ul>
<li>Test statistic:</li>
</ul>
<p><span class="math display">T_0 = \frac{\overline{X_1} - \overline{X_2}}{S_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}</span></p>
<ul>
<li>Degrees of freedom: ν = n₁ + n₂ - 2</li>
</ul>
<p><strong>Case 2: Unequal Variances (σ₁² ≠ σ₂²)</strong></p>
<ul>
<li><p><strong>Welch’s t-test</strong></p></li>
<li><p>Test statistic:</p></li>
</ul>
<p><span class="math display">T_0 = \frac{\overline{X_1} - \overline{X_2}}{\sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}}}</span></p>
<ul>
<li>Degrees of freedom:</li>
</ul>
<p><span class="math display">\nu = \frac{(\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2})^2}{\frac{S_1^4}{n_1^2(n_1-1)} + \frac{S_2^4}{n_2^2(n_2-1)}}</span></p>
</div>
</div>
</section>
<section id="example-comparing-material-strength" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="example-comparing-material-strength"><span class="header-section-number">1.3.2</span> Example: Comparing Material Strength</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compare the breaking strength of two types of plastic. Random samples give:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"></a><a href="data/plastic_strength.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Plastic Strength Data Summary by Type:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     type     n      Min       Q1   Median     Mean       Q3      Max        SD
   &lt;char&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;     &lt;num&gt;
1: Type_A    15 150.6854 155.8163 167.2005 163.4680 169.8374 176.0622  8.599716
2: Type_B    18 139.6099 152.5444 156.1428 158.8415 170.5125 178.5483 11.920081
         Var  SE_Mean
       &lt;num&gt;    &lt;num&gt;
1:  73.95511 2.220437
2: 142.08832 2.809590</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Plastic strength comparison (two-sample t-test, sigma unknown)</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>plastic_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Type_A"</span>, <span class="st">"Type_B"</span>), <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">18</span>)),</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="at">strength =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="at">mean =</span> <span class="fl">162.5</span>, <span class="at">sd =</span> <span class="fl">8.2</span>), <span class="fu">rnorm</span>(<span class="dv">18</span>, <span class="at">mean =</span> <span class="fl">157.8</span>, <span class="at">sd =</span> <span class="fl">9.1</span>))</span>
<span id="cb13-6"><a href="#cb13-6"></a>)</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co"># Summary statistics</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>plastic_summary <span class="ot">&lt;-</span> plastic_data <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="fu">fgroup_by</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(strength),</span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="at">Min =</span> <span class="fu">fmin</span>(strength),</span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="at">Q1 =</span> <span class="fu">fquantile</span>(strength, <span class="fl">0.25</span>),</span>
<span id="cb13-15"><a href="#cb13-15"></a>    <span class="at">Median =</span> <span class="fu">fmedian</span>(strength),</span>
<span id="cb13-16"><a href="#cb13-16"></a>    <span class="at">Mean =</span> <span class="fu">fmean</span>(strength),</span>
<span id="cb13-17"><a href="#cb13-17"></a>    <span class="at">Q3 =</span> <span class="fu">fquantile</span>(strength, <span class="fl">0.75</span>),</span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="at">Max =</span> <span class="fu">fmax</span>(strength),</span>
<span id="cb13-19"><a href="#cb13-19"></a>    <span class="at">SD =</span> <span class="fu">fsd</span>(strength),</span>
<span id="cb13-20"><a href="#cb13-20"></a>    <span class="at">Var =</span> <span class="fu">fvar</span>(strength),</span>
<span id="cb13-21"><a href="#cb13-21"></a>    <span class="at">SE_Mean =</span> <span class="fu">fsd</span>(strength) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">fnobs</span>(strength))</span>
<span id="cb13-22"><a href="#cb13-22"></a>  )</span>
<span id="cb13-23"><a href="#cb13-23"></a></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="fu">print</span>(<span class="st">"Plastic Strength Data Summary by Type:"</span>)</span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="fu">print</span>(plastic_summary)</span>
<span id="cb13-26"><a href="#cb13-26"></a></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="fu">fwrite</span>(plastic_data, <span class="st">"data/plastic_strength.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">

</div>
</div>
</div>
<p>First, test for equal variances, then perform appropriate t-test.</p>
<p><strong>Manual Calculation (assuming equal variances):</strong></p>
<p>Given: n₁ = 15, x̄₁ = 162.5, s₁ = 8.2, n₂ = 18, x̄₂ = 157.8, s₂ = 9.1</p>
<ol type="1">
<li><p><strong>Pooled Variance:</strong> <span class="math display">S_p^2 = \frac{(15-1)(8.2)^2 + (18-1)(9.1)^2}{15 + 18 - 2} = \frac{940.36 + 1408.57}{31} = 75.77</span></p></li>
<li><p><strong>Test Statistic:</strong> <span class="math display">T_0 = \frac{162.5 - 157.8}{8.71\sqrt{\frac{1}{15} + \frac{1}{18}}} = \frac{4.7}{3.01} = 1.56</span></p></li>
<li><p><strong>Critical Value:</strong> t₀.₀₂₅,₃₁ = 2.040</p></li>
<li><p><strong>Decision:</strong> |T₀| = 1.56 &lt; 2.040, so fail to reject H₀</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-test for equal variances: F = 0.52 , p-value = 0.2229"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-Sample t-Test Results (Equal Variances):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                             Test_Type    n1    n2  xbar1  xbar2    s1    s2
                                &lt;char&gt; &lt;int&gt; &lt;int&gt;  &lt;num&gt;  &lt;num&gt; &lt;num&gt; &lt;num&gt;
1: Two-sample t-test (equal variances)    15    18 163.47 158.84   8.6 11.92
   Pooled_SD SE_Difference t_Statistic    df P_Value Alpha t_Critical
       &lt;num&gt;         &lt;num&gt;       &lt;num&gt; &lt;num&gt;   &lt;num&gt; &lt;num&gt;      &lt;num&gt;
1:     10.55         3.689      1.2543    31  0.2191  0.05       2.04
            Decision                         Conclusion
              &lt;char&gt;                             &lt;char&gt;
1: Fail to reject H0 No significant difference in means</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's t.test verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  typeA_data$strength and typeB_data$strength
t = 1.2543, df = 31, p-value = 0.2191
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.896371 12.149429
sample estimates:
mean of x mean of y 
 163.4680  158.8415 </code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Two-sample t-test with equal variances (manual and R calculations)</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>typeA_data <span class="ot">&lt;-</span> plastic_data[type <span class="sc">==</span> <span class="st">"Type_A"</span>]</span>
<span id="cb19-3"><a href="#cb19-3"></a>typeB_data <span class="ot">&lt;-</span> plastic_data[type <span class="sc">==</span> <span class="st">"Type_B"</span>]</span>
<span id="cb19-4"><a href="#cb19-4"></a></span>
<span id="cb19-5"><a href="#cb19-5"></a>n1_t <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(typeA_data<span class="sc">$</span>strength)</span>
<span id="cb19-6"><a href="#cb19-6"></a>n2_t <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(typeB_data<span class="sc">$</span>strength)</span>
<span id="cb19-7"><a href="#cb19-7"></a>xbar1_t <span class="ot">&lt;-</span> <span class="fu">fmean</span>(typeA_data<span class="sc">$</span>strength)</span>
<span id="cb19-8"><a href="#cb19-8"></a>xbar2_t <span class="ot">&lt;-</span> <span class="fu">fmean</span>(typeB_data<span class="sc">$</span>strength)</span>
<span id="cb19-9"><a href="#cb19-9"></a>s1_t <span class="ot">&lt;-</span> <span class="fu">fsd</span>(typeA_data<span class="sc">$</span>strength)</span>
<span id="cb19-10"><a href="#cb19-10"></a>s2_t <span class="ot">&lt;-</span> <span class="fu">fsd</span>(typeB_data<span class="sc">$</span>strength)</span>
<span id="cb19-11"><a href="#cb19-11"></a></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co"># Test for equal variances first (F-test)</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>f_stat_equal <span class="ot">&lt;-</span> s1_t<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> s2_t<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>df1_f <span class="ot">&lt;-</span> n1_t <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>df2_f <span class="ot">&lt;-</span> n2_t <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>p_value_f <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">min</span>(<span class="fu">pf</span>(f_stat_equal, df1_f, df2_f), <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f_stat_equal, df1_f, df2_f))</span>
<span id="cb19-17"><a href="#cb19-17"></a></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F-test for equal variances: F ="</span>, <span class="fu">round</span>(f_stat_equal, <span class="dv">3</span>), <span class="st">", p-value ="</span>, <span class="fu">round</span>(p_value_f, <span class="dv">4</span>)))</span>
<span id="cb19-19"><a href="#cb19-19"></a></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co"># Assuming equal variances (pooled variance)</span></span>
<span id="cb19-21"><a href="#cb19-21"></a>sp_squared <span class="ot">&lt;-</span> ((n1_t <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s1_t<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (n2_t <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s2_t<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n1_t <span class="sc">+</span> n2_t <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb19-22"><a href="#cb19-22"></a>sp <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sp_squared)</span>
<span id="cb19-23"><a href="#cb19-23"></a>se_pooled <span class="ot">&lt;-</span> sp <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n1_t <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2_t)</span>
<span id="cb19-24"><a href="#cb19-24"></a></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co"># Manual t-test calculation</span></span>
<span id="cb19-26"><a href="#cb19-26"></a>t_stat <span class="ot">&lt;-</span> (xbar1_t <span class="sc">-</span> xbar2_t) <span class="sc">/</span> se_pooled</span>
<span id="cb19-27"><a href="#cb19-27"></a>df_t <span class="ot">&lt;-</span> n1_t <span class="sc">+</span> n2_t <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb19-28"><a href="#cb19-28"></a>p_value_t <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat), <span class="at">df =</span> df_t))</span>
<span id="cb19-29"><a href="#cb19-29"></a>t_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> df_t)</span>
<span id="cb19-30"><a href="#cb19-30"></a></span>
<span id="cb19-31"><a href="#cb19-31"></a><span class="co"># Test results</span></span>
<span id="cb19-32"><a href="#cb19-32"></a>t_test_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb19-33"><a href="#cb19-33"></a>  <span class="at">Test_Type =</span> <span class="st">"Two-sample t-test (equal variances)"</span>,</span>
<span id="cb19-34"><a href="#cb19-34"></a>  <span class="at">n1 =</span> n1_t,</span>
<span id="cb19-35"><a href="#cb19-35"></a>  <span class="at">n2 =</span> n2_t,</span>
<span id="cb19-36"><a href="#cb19-36"></a>  <span class="at">xbar1 =</span> <span class="fu">round</span>(xbar1_t, <span class="dv">2</span>),</span>
<span id="cb19-37"><a href="#cb19-37"></a>  <span class="at">xbar2 =</span> <span class="fu">round</span>(xbar2_t, <span class="dv">2</span>),</span>
<span id="cb19-38"><a href="#cb19-38"></a>  <span class="at">s1 =</span> <span class="fu">round</span>(s1_t, <span class="dv">2</span>),</span>
<span id="cb19-39"><a href="#cb19-39"></a>  <span class="at">s2 =</span> <span class="fu">round</span>(s2_t, <span class="dv">2</span>),</span>
<span id="cb19-40"><a href="#cb19-40"></a>  <span class="at">Pooled_SD =</span> <span class="fu">round</span>(sp, <span class="dv">2</span>),</span>
<span id="cb19-41"><a href="#cb19-41"></a>  <span class="at">SE_Difference =</span> <span class="fu">round</span>(se_pooled, <span class="dv">3</span>),</span>
<span id="cb19-42"><a href="#cb19-42"></a>  <span class="at">t_Statistic =</span> <span class="fu">round</span>(t_stat, <span class="dv">4</span>),</span>
<span id="cb19-43"><a href="#cb19-43"></a>  <span class="at">df =</span> df_t,</span>
<span id="cb19-44"><a href="#cb19-44"></a>  <span class="at">P_Value =</span> <span class="fu">round</span>(p_value_t, <span class="dv">4</span>),</span>
<span id="cb19-45"><a href="#cb19-45"></a>  <span class="at">Alpha =</span> alpha,</span>
<span id="cb19-46"><a href="#cb19-46"></a>  <span class="at">t_Critical =</span> <span class="fu">round</span>(t_critical, <span class="dv">3</span>),</span>
<span id="cb19-47"><a href="#cb19-47"></a>  <span class="at">Decision =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(t_stat) <span class="sc">&gt;</span> t_critical, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb19-48"><a href="#cb19-48"></a>  <span class="at">Conclusion =</span> <span class="fu">ifelse</span>(p_value_t <span class="sc">&lt;</span> alpha, </span>
<span id="cb19-49"><a href="#cb19-49"></a>                     <span class="st">"Means are significantly different"</span>, </span>
<span id="cb19-50"><a href="#cb19-50"></a>                     <span class="st">"No significant difference in means"</span>)</span>
<span id="cb19-51"><a href="#cb19-51"></a>)</span>
<span id="cb19-52"><a href="#cb19-52"></a></span>
<span id="cb19-53"><a href="#cb19-53"></a><span class="fu">print</span>(<span class="st">"Two-Sample t-Test Results (Equal Variances):"</span>)</span>
<span id="cb19-54"><a href="#cb19-54"></a><span class="fu">print</span>(t_test_results)</span>
<span id="cb19-55"><a href="#cb19-55"></a></span>
<span id="cb19-56"><a href="#cb19-56"></a><span class="co"># Using R's built-in t.test for verification</span></span>
<span id="cb19-57"><a href="#cb19-57"></a>t_test_r <span class="ot">&lt;-</span> <span class="fu">t.test</span>(typeA_data<span class="sc">$</span>strength, typeB_data<span class="sc">$</span>strength, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-58"><a href="#cb19-58"></a><span class="fu">print</span>(<span class="st">"R's t.test verification:"</span>)</span>
<span id="cb19-59"><a href="#cb19-59"></a><span class="fu">print</span>(t_test_r)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="type-ii-error-and-choice-of-sample-size-1" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="type-ii-error-and-choice-of-sample-size-1"><span class="header-section-number">1.3.3</span> Type II Error and Choice of Sample Size</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Sample Size for Two-Sample t-Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>For equal sample sizes and equal variances:</p>
<p><span class="math display">n \approx \frac{2(t_{\alpha/2,\nu} + t_{\beta,\nu})^2 s_p^2}{\delta^2}</span></p>
<p>where ν = 2n - 2 and s_p² is estimated from pilot data.</p>
</div>
</div>
</section>
<section id="confidence-interval-on-the-difference-in-means-1" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="confidence-interval-on-the-difference-in-means-1"><span class="header-section-number">1.3.4</span> Confidence Interval on the Difference in Means</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Confidence Interval for μ₁ - μ₂ (σ₁, σ₂ unknown)
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Equal Variances:</strong></p>
<p><span class="math display">(\overline{x_1} - \overline{x_2}) \pm t_{\alpha/2,n_1+n_2-2} \cdot S_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}</span></p>
<p><strong>Unequal Variances:</strong></p>
<p><span class="math display">(\overline{x_1} - \overline{x_2}) \pm t_{\alpha/2,\nu} \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}</span></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Difference in Means (σ unknown):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter Confidence_Level Difference Pooled_SD Standard_Error t_Critical
      &lt;char&gt;           &lt;char&gt;      &lt;num&gt;     &lt;num&gt;          &lt;num&gt;      &lt;num&gt;
1:   μ₁ - μ₂              95%       4.63     10.55          3.689       2.04
   Margin_Error Lower_Bound Upper_Bound Width
          &lt;num&gt;       &lt;num&gt;       &lt;num&gt; &lt;num&gt;
1:        7.523        -2.9       12.15 15.05
                                         Interpretation
                                                 &lt;char&gt;
1: 95% confident that μ₁ - μ₂ is between -2.9 and 12.15</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Welch's t-test (unequal variances):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  typeA_data$strength and typeB_data$strength
t = 1.2919, df = 30.446, p-value = 0.2061
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -2.682527 11.935585
sample estimates:
mean of x mean of y 
 163.4680  158.8415 </code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Confidence interval for difference in means (sigma unknown)</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>margin_error_t <span class="ot">&lt;-</span> t_critical <span class="sc">*</span> se_pooled</span>
<span id="cb24-3"><a href="#cb24-3"></a>ci_lower_t <span class="ot">&lt;-</span> (xbar1_t <span class="sc">-</span> xbar2_t) <span class="sc">-</span> margin_error_t</span>
<span id="cb24-4"><a href="#cb24-4"></a>ci_upper_t <span class="ot">&lt;-</span> (xbar1_t <span class="sc">-</span> xbar2_t) <span class="sc">+</span> margin_error_t</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a>t_ci_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb24-7"><a href="#cb24-7"></a>  <span class="at">Parameter =</span> <span class="st">"μ₁ - μ₂"</span>,</span>
<span id="cb24-8"><a href="#cb24-8"></a>  <span class="at">Confidence_Level =</span> <span class="st">"95%"</span>,</span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="at">Difference =</span> <span class="fu">round</span>(xbar1_t <span class="sc">-</span> xbar2_t, <span class="dv">2</span>),</span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="at">Pooled_SD =</span> <span class="fu">round</span>(sp, <span class="dv">2</span>),</span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="at">Standard_Error =</span> <span class="fu">round</span>(se_pooled, <span class="dv">3</span>),</span>
<span id="cb24-12"><a href="#cb24-12"></a>  <span class="at">t_Critical =</span> <span class="fu">round</span>(t_critical, <span class="dv">3</span>),</span>
<span id="cb24-13"><a href="#cb24-13"></a>  <span class="at">Margin_Error =</span> <span class="fu">round</span>(margin_error_t, <span class="dv">3</span>),</span>
<span id="cb24-14"><a href="#cb24-14"></a>  <span class="at">Lower_Bound =</span> <span class="fu">round</span>(ci_lower_t, <span class="dv">2</span>),</span>
<span id="cb24-15"><a href="#cb24-15"></a>  <span class="at">Upper_Bound =</span> <span class="fu">round</span>(ci_upper_t, <span class="dv">2</span>),</span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="at">Width =</span> <span class="fu">round</span>(ci_upper_t <span class="sc">-</span> ci_lower_t, <span class="dv">2</span>),</span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="at">Interpretation =</span> <span class="fu">paste</span>(<span class="st">"95% confident that μ₁ - μ₂ is between"</span>, </span>
<span id="cb24-18"><a href="#cb24-18"></a>                        <span class="fu">round</span>(ci_lower_t, <span class="dv">2</span>), <span class="st">"and"</span>, <span class="fu">round</span>(ci_upper_t, <span class="dv">2</span>))</span>
<span id="cb24-19"><a href="#cb24-19"></a>)</span>
<span id="cb24-20"><a href="#cb24-20"></a></span>
<span id="cb24-21"><a href="#cb24-21"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Difference in Means (σ unknown):"</span>)</span>
<span id="cb24-22"><a href="#cb24-22"></a><span class="fu">print</span>(t_ci_results)</span>
<span id="cb24-23"><a href="#cb24-23"></a></span>
<span id="cb24-24"><a href="#cb24-24"></a><span class="co"># Welch's t-test (unequal variances) for comparison</span></span>
<span id="cb24-25"><a href="#cb24-25"></a>welch_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(typeA_data<span class="sc">$</span>strength, typeB_data<span class="sc">$</span>strength, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-26"><a href="#cb24-26"></a><span class="fu">print</span>(<span class="st">"Welch's t-test (unequal variances):"</span>)</span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="fu">print</span>(welch_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="the-paired-t-test" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="the-paired-t-test"><span class="header-section-number">1.4</span> The Paired t-Test</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Paired t-Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>When observations come in natural pairs (before/after, matched subjects, etc.), use the paired t-test:</p>
<ol type="1">
<li><p><strong>Calculate differences:</strong> d_i = x₁ᵢ - x₂ᵢ</p></li>
<li><p><strong>Test statistic:</strong></p></li>
</ol>
<p><span class="math display">T_0 = \frac{\overline{d} - \mu_d}{S_d/\sqrt{n}}</span></p>
<ol start="3" type="1">
<li><strong>Degrees of freedom:</strong> ν = n - 1</li>
</ol>
<p>Where:</p>
<ul>
<li><p><span class="math inline">\overline{d} = \frac{1}{n}\sum_{i=1}^n d_i</span></p></li>
<li><p><span class="math inline">S_d^2 = \frac{1}{n-1}\sum_{i=1}^n (d_i - \overline{d})^2</span></p></li>
</ul>
<p><strong>Assumptions:</strong></p>
<ul>
<li><p>Differences are normally distributed</p></li>
<li><p>Pairs are independent</p></li>
</ul>
</div>
</div>
<section id="example-beforeafter-comparison" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="example-beforeafter-comparison"><span class="header-section-number">1.4.1</span> Example: Before/After Comparison</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A manufacturing process improvement is tested on 12 production lines. Measure output before and after the improvement:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false"></a><a href="data/process_improvement.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Process Improvement Paired Data Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       n Mean_Before Mean_After Mean_Difference SD_Before SD_After
   &lt;int&gt;       &lt;num&gt;      &lt;num&gt;           &lt;num&gt;     &lt;num&gt;    &lt;num&gt;
1:    12    81.70922   89.14206        7.432843   6.36605 4.794191
   SD_Difference SE_Difference Min_Difference Max_Difference
           &lt;num&gt;         &lt;num&gt;          &lt;num&gt;          &lt;num&gt;
1:      6.906354      1.993693      -2.023308        19.6769</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Individual Differences:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    line_id   before    after difference
      &lt;int&gt;    &lt;num&gt;    &lt;num&gt;      &lt;num&gt;
 1:       1 89.19277 88.91711 -0.2756677
 2:       2 66.91386 86.59075 19.6768963
 3:       3 84.84256 97.20931 12.3667432
 4:       4 86.46512 84.44181 -2.0233083
 5:       5 82.10919 93.42153 11.3123453
 6:       6 81.12413 85.69777  4.5736465
 7:       7 79.66950 91.82031 12.1508159
 8:       8 83.60425 84.41997  0.8157253
 9:       9 76.91232 84.98462  8.0723014
10:      10 90.91757 95.37602  4.4584503
11:      11 81.78163 83.81734  2.0357137
12:      12 76.97776 93.00821 16.0304489</code></pre>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Process improvement paired t-test example</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a>process_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="at">line_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb29-5"><a href="#cb29-5"></a>  <span class="at">before =</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="dv">85</span>, <span class="at">sd =</span> <span class="dv">8</span>),</span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="at">after =</span> <span class="fu">rnorm</span>(<span class="dv">12</span>, <span class="at">mean =</span> <span class="fl">90.25</span>, <span class="at">sd =</span> <span class="fl">7.5</span>)</span>
<span id="cb29-7"><a href="#cb29-7"></a>)</span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co"># Calculate differences</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>process_data[, difference <span class="sc">:</span><span class="er">=</span> after <span class="sc">-</span> before]</span>
<span id="cb29-11"><a href="#cb29-11"></a></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co"># Summary statistics for paired data</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>paired_summary <span class="ot">&lt;-</span> process_data <span class="sc">%&gt;%</span> </span>
<span id="cb29-14"><a href="#cb29-14"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb29-15"><a href="#cb29-15"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(difference),</span>
<span id="cb29-16"><a href="#cb29-16"></a>    <span class="at">Mean_Before =</span> <span class="fu">fmean</span>(before),</span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="at">Mean_After =</span> <span class="fu">fmean</span>(after),</span>
<span id="cb29-18"><a href="#cb29-18"></a>    <span class="at">Mean_Difference =</span> <span class="fu">fmean</span>(difference),</span>
<span id="cb29-19"><a href="#cb29-19"></a>    <span class="at">SD_Before =</span> <span class="fu">fsd</span>(before),</span>
<span id="cb29-20"><a href="#cb29-20"></a>    <span class="at">SD_After =</span> <span class="fu">fsd</span>(after),</span>
<span id="cb29-21"><a href="#cb29-21"></a>    <span class="at">SD_Difference =</span> <span class="fu">fsd</span>(difference),</span>
<span id="cb29-22"><a href="#cb29-22"></a>    <span class="at">SE_Difference =</span> <span class="fu">fsd</span>(difference) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">fnobs</span>(difference)),</span>
<span id="cb29-23"><a href="#cb29-23"></a>    <span class="at">Min_Difference =</span> <span class="fu">fmin</span>(difference),</span>
<span id="cb29-24"><a href="#cb29-24"></a>    <span class="at">Max_Difference =</span> <span class="fu">fmax</span>(difference)</span>
<span id="cb29-25"><a href="#cb29-25"></a>  )</span>
<span id="cb29-26"><a href="#cb29-26"></a></span>
<span id="cb29-27"><a href="#cb29-27"></a><span class="fu">print</span>(<span class="st">"Process Improvement Paired Data Summary:"</span>)</span>
<span id="cb29-28"><a href="#cb29-28"></a><span class="fu">print</span>(paired_summary)</span>
<span id="cb29-29"><a href="#cb29-29"></a></span>
<span id="cb29-30"><a href="#cb29-30"></a><span class="co"># Individual differences</span></span>
<span id="cb29-31"><a href="#cb29-31"></a>differences_table <span class="ot">&lt;-</span> process_data[, .(line_id, before, after, difference)]</span>
<span id="cb29-32"><a href="#cb29-32"></a><span class="fu">print</span>(<span class="st">"Individual Differences:"</span>)</span>
<span id="cb29-33"><a href="#cb29-33"></a><span class="fu">print</span>(differences_table)</span>
<span id="cb29-34"><a href="#cb29-34"></a></span>
<span id="cb29-35"><a href="#cb29-35"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb29-36"><a href="#cb29-36"></a><span class="fu">fwrite</span>(process_data, <span class="st">"data/process_improvement.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">

</div>
</div>
</div>
<p>Test H₀: μ_d = 0 vs H₁: μ_d &gt; 0 at α = 0.05.</p>
<p><strong>Manual Calculation:</strong></p>
<p>Calculate differences: d_i = After_i - Before_i</p>
<p>If d̄ = 5.25 and s_d = 3.2:</p>
<ol type="1">
<li><p><strong>Test Statistic:</strong> <span class="math display">T_0 = \frac{5.25 - 0}{3.2/\sqrt{12}} = \frac{5.25}{0.924} = 5.68</span></p></li>
<li><p><strong>Critical Value:</strong> t₀.₀₅,₁₁ = 1.796</p></li>
<li><p><strong>Decision:</strong> T₀ = 5.68 &gt; 1.796, so reject H₀</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Paired t-Test Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Test_Type n_pairs Mean_Difference SD_Difference SE_Difference
          &lt;char&gt;   &lt;int&gt;           &lt;num&gt;         &lt;num&gt;         &lt;num&gt;
1: Paired t-test      12           7.433         6.906         1.994
   Null_Difference t_Statistic    df P_Value Alpha t_Critical  Decision
             &lt;num&gt;       &lt;num&gt; &lt;num&gt;   &lt;num&gt; &lt;num&gt;      &lt;num&gt;    &lt;char&gt;
1:               0      3.7282    11  0.0017  0.05      1.796 Reject H0
                         Conclusion
                             &lt;char&gt;
1: Significant improvement detected</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's paired t.test verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  process_data$after and process_data$before
t = 3.7282, df = 11, p-value = 0.001667
alternative hypothesis: true mean difference is greater than 0
95 percent confidence interval:
 3.8524    Inf
sample estimates:
mean difference 
       7.432843 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% CI for mean difference: [ 3.045 ,  11.821 ]"</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Paired t-test (manual and R calculations)</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>n_paired <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(process_data<span class="sc">$</span>difference)</span>
<span id="cb35-3"><a href="#cb35-3"></a>d_bar <span class="ot">&lt;-</span> <span class="fu">fmean</span>(process_data<span class="sc">$</span>difference)</span>
<span id="cb35-4"><a href="#cb35-4"></a>s_d <span class="ot">&lt;-</span> <span class="fu">fsd</span>(process_data<span class="sc">$</span>difference)</span>
<span id="cb35-5"><a href="#cb35-5"></a>mu_d0 <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Null hypothesis: no difference</span></span>
<span id="cb35-6"><a href="#cb35-6"></a></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="co"># Manual calculation</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>t_stat_paired <span class="ot">&lt;-</span> (d_bar <span class="sc">-</span> mu_d0) <span class="sc">/</span> (s_d <span class="sc">/</span> <span class="fu">sqrt</span>(n_paired))</span>
<span id="cb35-9"><a href="#cb35-9"></a>df_paired <span class="ot">&lt;-</span> n_paired <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>p_value_paired <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(t_stat_paired, <span class="at">df =</span> df_paired)  <span class="co"># One-sided upper test</span></span>
<span id="cb35-11"><a href="#cb35-11"></a>t_critical_paired <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">df =</span> df_paired)</span>
<span id="cb35-12"><a href="#cb35-12"></a></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="co"># Test results</span></span>
<span id="cb35-14"><a href="#cb35-14"></a>paired_test_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb35-15"><a href="#cb35-15"></a>  <span class="at">Test_Type =</span> <span class="st">"Paired t-test"</span>,</span>
<span id="cb35-16"><a href="#cb35-16"></a>  <span class="at">n_pairs =</span> n_paired,</span>
<span id="cb35-17"><a href="#cb35-17"></a>  <span class="at">Mean_Difference =</span> <span class="fu">round</span>(d_bar, <span class="dv">3</span>),</span>
<span id="cb35-18"><a href="#cb35-18"></a>  <span class="at">SD_Difference =</span> <span class="fu">round</span>(s_d, <span class="dv">3</span>),</span>
<span id="cb35-19"><a href="#cb35-19"></a>  <span class="at">SE_Difference =</span> <span class="fu">round</span>(s_d <span class="sc">/</span> <span class="fu">sqrt</span>(n_paired), <span class="dv">3</span>),</span>
<span id="cb35-20"><a href="#cb35-20"></a>  <span class="at">Null_Difference =</span> mu_d0,</span>
<span id="cb35-21"><a href="#cb35-21"></a>  <span class="at">t_Statistic =</span> <span class="fu">round</span>(t_stat_paired, <span class="dv">4</span>),</span>
<span id="cb35-22"><a href="#cb35-22"></a>  <span class="at">df =</span> df_paired,</span>
<span id="cb35-23"><a href="#cb35-23"></a>  <span class="at">P_Value =</span> <span class="fu">round</span>(p_value_paired, <span class="dv">4</span>),</span>
<span id="cb35-24"><a href="#cb35-24"></a>  <span class="at">Alpha =</span> alpha,</span>
<span id="cb35-25"><a href="#cb35-25"></a>  <span class="at">t_Critical =</span> <span class="fu">round</span>(t_critical_paired, <span class="dv">3</span>),</span>
<span id="cb35-26"><a href="#cb35-26"></a>  <span class="at">Decision =</span> <span class="fu">ifelse</span>(t_stat_paired <span class="sc">&gt;</span> t_critical_paired, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb35-27"><a href="#cb35-27"></a>  <span class="at">Conclusion =</span> <span class="fu">ifelse</span>(p_value_paired <span class="sc">&lt;</span> alpha, </span>
<span id="cb35-28"><a href="#cb35-28"></a>                     <span class="st">"Significant improvement detected"</span>, </span>
<span id="cb35-29"><a href="#cb35-29"></a>                     <span class="st">"No significant improvement"</span>)</span>
<span id="cb35-30"><a href="#cb35-30"></a>)</span>
<span id="cb35-31"><a href="#cb35-31"></a></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="fu">print</span>(<span class="st">"Paired t-Test Results:"</span>)</span>
<span id="cb35-33"><a href="#cb35-33"></a><span class="fu">print</span>(paired_test_results)</span>
<span id="cb35-34"><a href="#cb35-34"></a></span>
<span id="cb35-35"><a href="#cb35-35"></a><span class="co"># Using R's paired t.test for verification</span></span>
<span id="cb35-36"><a href="#cb35-36"></a>paired_test_r <span class="ot">&lt;-</span> <span class="fu">t.test</span>(process_data<span class="sc">$</span>after, process_data<span class="sc">$</span>before, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span>
<span id="cb35-37"><a href="#cb35-37"></a><span class="fu">print</span>(<span class="st">"R's paired t.test verification:"</span>)</span>
<span id="cb35-38"><a href="#cb35-38"></a><span class="fu">print</span>(paired_test_r)</span>
<span id="cb35-39"><a href="#cb35-39"></a></span>
<span id="cb35-40"><a href="#cb35-40"></a><span class="co"># Confidence interval for mean difference</span></span>
<span id="cb35-41"><a href="#cb35-41"></a>t_critical_ci_paired <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> df_paired)</span>
<span id="cb35-42"><a href="#cb35-42"></a>margin_error_paired <span class="ot">&lt;-</span> t_critical_ci_paired <span class="sc">*</span> (s_d <span class="sc">/</span> <span class="fu">sqrt</span>(n_paired))</span>
<span id="cb35-43"><a href="#cb35-43"></a>ci_lower_paired <span class="ot">&lt;-</span> d_bar <span class="sc">-</span> margin_error_paired</span>
<span id="cb35-44"><a href="#cb35-44"></a>ci_upper_paired <span class="ot">&lt;-</span> d_bar <span class="sc">+</span> margin_error_paired</span>
<span id="cb35-45"><a href="#cb35-45"></a></span>
<span id="cb35-46"><a href="#cb35-46"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"95% CI for mean difference: ["</span>, <span class="fu">round</span>(ci_lower_paired, <span class="dv">3</span>), <span class="st">", "</span>, <span class="fu">round</span>(ci_upper_paired, <span class="dv">3</span>), <span class="st">"]"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch05Code02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch05Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch05_files/figure-html/fig-Ch05Code02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Paired t-test visualization"><img src="Ch05_files/figure-html/fig-Ch05Code02-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch05Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Paired t-test visualization
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Paired t-test visualization</span></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co"># Create long format for plotting</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>process_long <span class="ot">&lt;-</span> process_data <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(before, after), <span class="at">names_to =</span> <span class="st">"time"</span>, <span class="at">values_to =</span> <span class="st">"output"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="fu">data.table</span>()</span>
<span id="cb36-7"><a href="#cb36-7"></a></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="co"># Before/After comparison plot</span></span>
<span id="cb36-9"><a href="#cb36-9"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> process_long, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> output, <span class="at">group =</span> line_id)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> time), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"before"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"after"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-14"><a href="#cb36-14"></a>    <span class="at">x =</span> <span class="st">"Time Period"</span>,</span>
<span id="cb36-15"><a href="#cb36-15"></a>    <span class="at">y =</span> <span class="st">"Output"</span>,</span>
<span id="cb36-16"><a href="#cb36-16"></a>    <span class="at">title =</span> <span class="st">"Before/After Process Improvement"</span>,</span>
<span id="cb36-17"><a href="#cb36-17"></a>    <span class="at">color =</span> <span class="st">"Period"</span></span>
<span id="cb36-18"><a href="#cb36-18"></a>  ) <span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb36-21"><a href="#cb36-21"></a></span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="co"># Differences histogram</span></span>
<span id="cb36-23"><a href="#cb36-23"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> process_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> difference)) <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">8</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb36-25"><a href="#cb36-25"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> d_bar, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-26"><a href="#cb36-26"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-28"><a href="#cb36-28"></a>    <span class="at">x =</span> <span class="st">"Difference (After - Before)"</span>,</span>
<span id="cb36-29"><a href="#cb36-29"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb36-30"><a href="#cb36-30"></a>    <span class="at">title =</span> <span class="st">"Distribution of Differences"</span></span>
<span id="cb36-31"><a href="#cb36-31"></a>  ) <span class="sc">+</span></span>
<span id="cb36-32"><a href="#cb36-32"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb36-33"><a href="#cb36-33"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb36-34"><a href="#cb36-34"></a></span>
<span id="cb36-35"><a href="#cb36-35"></a><span class="co"># Combine plots</span></span>
<span id="cb36-36"><a href="#cb36-36"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inference-on-the-ratio-of-variances-of-two-normal-populations" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="inference-on-the-ratio-of-variances-of-two-normal-populations"><span class="header-section-number">1.5</span> Inference on the Ratio of Variances of Two Normal Populations</h2>
<section id="hypothesis-testing-on-the-ratio-of-two-variances" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="hypothesis-testing-on-the-ratio-of-two-variances"><span class="header-section-number">1.5.1</span> Hypothesis Testing on the Ratio of Two Variances</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>F-Test for Equality of Variances
</div>
</div>
<div class="callout-body-container callout-body">
<p>To test H₀: σ₁² = σ₂² vs H₁: σ₁² ≠ σ₂², use:</p>
<p><span class="math display">F_0 = \frac{S_1^2}{S_2^2}</span></p>
<p>Under H₀, F₀ ~ F_{n₁-1, n₂-1}</p>
<p><strong>Convention:</strong> Put the larger sample variance in the numerator so F₀ ≥ 1.</p>
<p><strong>Properties of F-distribution:</strong></p>
<ul>
<li><p>Always positive</p></li>
<li><p>Right-skewed</p></li>
<li><p>Approaches 1 as both df → ∞</p></li>
<li><p>F₁₋α,ν₁,ν₂ = 1/F_α,ν₂,ν₁</p></li>
</ul>
</div>
</div>
</section>
<section id="example-variance-comparison" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="example-variance-comparison"><span class="header-section-number">1.5.2</span> Example: Variance Comparison</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compare the variability in measurements from two instruments:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false"></a><a href="data/instrument_comparison.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Instrument Comparison Data Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     instrument     n      Min       Q1   Median     Mean       Q3      Max
         &lt;char&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
1: Instrument_1    16 23.17625 24.45219 25.33319 25.39453 25.69963 28.86313
2: Instrument_2    21 22.07273 24.18302 25.35367 25.00446 25.81188 26.85136
         SD      Var
      &lt;num&gt;    &lt;num&gt;
1: 1.522413 2.317741
2: 1.359890 1.849302</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Instrument comparison for F-test (variance comparison)</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb39-3"><a href="#cb39-3"></a>instrument_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="at">instrument =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Instrument_1"</span>, <span class="st">"Instrument_2"</span>), <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">21</span>)),</span>
<span id="cb39-5"><a href="#cb39-5"></a>  <span class="at">measurement =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="at">mean =</span> <span class="dv">25</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">2.5</span>)), <span class="fu">rnorm</span>(<span class="dv">21</span>, <span class="at">mean =</span> <span class="fl">25.2</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">1.8</span>)))</span>
<span id="cb39-6"><a href="#cb39-6"></a>)</span>
<span id="cb39-7"><a href="#cb39-7"></a></span>
<span id="cb39-8"><a href="#cb39-8"></a><span class="co"># Summary statistics</span></span>
<span id="cb39-9"><a href="#cb39-9"></a>instrument_summary <span class="ot">&lt;-</span> instrument_data <span class="sc">%&gt;%</span> </span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="fu">fgroup_by</span>(instrument) <span class="sc">%&gt;%</span> </span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb39-12"><a href="#cb39-12"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(measurement),</span>
<span id="cb39-13"><a href="#cb39-13"></a>    <span class="at">Min =</span> <span class="fu">fmin</span>(measurement),</span>
<span id="cb39-14"><a href="#cb39-14"></a>    <span class="at">Q1 =</span> <span class="fu">fquantile</span>(measurement, <span class="fl">0.25</span>),</span>
<span id="cb39-15"><a href="#cb39-15"></a>    <span class="at">Median =</span> <span class="fu">fmedian</span>(measurement),</span>
<span id="cb39-16"><a href="#cb39-16"></a>    <span class="at">Mean =</span> <span class="fu">fmean</span>(measurement),</span>
<span id="cb39-17"><a href="#cb39-17"></a>    <span class="at">Q3 =</span> <span class="fu">fquantile</span>(measurement, <span class="fl">0.75</span>),</span>
<span id="cb39-18"><a href="#cb39-18"></a>    <span class="at">Max =</span> <span class="fu">fmax</span>(measurement),</span>
<span id="cb39-19"><a href="#cb39-19"></a>    <span class="at">SD =</span> <span class="fu">fsd</span>(measurement),</span>
<span id="cb39-20"><a href="#cb39-20"></a>    <span class="at">Var =</span> <span class="fu">fvar</span>(measurement)</span>
<span id="cb39-21"><a href="#cb39-21"></a>  )</span>
<span id="cb39-22"><a href="#cb39-22"></a></span>
<span id="cb39-23"><a href="#cb39-23"></a><span class="fu">print</span>(<span class="st">"Instrument Comparison Data Summary:"</span>)</span>
<span id="cb39-24"><a href="#cb39-24"></a><span class="fu">print</span>(instrument_summary)</span>
<span id="cb39-25"><a href="#cb39-25"></a></span>
<span id="cb39-26"><a href="#cb39-26"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb39-27"><a href="#cb39-27"></a><span class="fu">fwrite</span>(instrument_data, <span class="st">"data/instrument_comparison.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">

</div>
</div>
</div>
<p>Test H₀: σ₁² = σ₂² vs H₁: σ₁² ≠ σ₂² at α = 0.05.</p>
<p><strong>Manual Calculation:</strong></p>
<p>Given: n₁ = 16, s₁² = 2.5, n₂ = 21, s₂² = 1.8</p>
<ol type="1">
<li><p><strong>Test Statistic:</strong> <span class="math display">F_0 = \frac{2.5}{1.8} = 1.39</span></p></li>
<li><p><strong>Critical Value:</strong> F₀.₀₂₅,₁₅,₂₀ = 2.57</p></li>
<li><p><strong>Decision:</strong> F₀ = 1.39 &lt; 2.57, so fail to reject H₀</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-Test Results for Equality of Variances:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                          Test_Type    n1    n2 s1_squared s2_squared
                             &lt;char&gt; &lt;int&gt; &lt;int&gt;      &lt;num&gt;      &lt;num&gt;
1: F-test for equality of variances    16    21     2.3177     1.8493
   Larger_Variance F_Statistic   df1   df2 P_Value Alpha F_Critical
            &lt;char&gt;       &lt;num&gt; &lt;num&gt; &lt;num&gt;   &lt;num&gt; &lt;num&gt;      &lt;num&gt;
1:    Instrument_1      1.2533    15    20   0.627  0.05      2.573
            Decision                             Conclusion
              &lt;char&gt;                                 &lt;char&gt;
1: Fail to reject H0 No significant difference in variances</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's var.test verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  inst1_data$measurement and inst2_data$measurement
F = 1.2533, num df = 15, denom df = 20, p-value = 0.627
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.4870809 3.4539881
sample estimates:
ratio of variances 
          1.253306 </code></pre>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># F-test for equality of variances</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>inst1_data <span class="ot">&lt;-</span> instrument_data[instrument <span class="sc">==</span> <span class="st">"Instrument_1"</span>]</span>
<span id="cb44-3"><a href="#cb44-3"></a>inst2_data <span class="ot">&lt;-</span> instrument_data[instrument <span class="sc">==</span> <span class="st">"Instrument_2"</span>]</span>
<span id="cb44-4"><a href="#cb44-4"></a></span>
<span id="cb44-5"><a href="#cb44-5"></a>n1_f <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(inst1_data<span class="sc">$</span>measurement)</span>
<span id="cb44-6"><a href="#cb44-6"></a>n2_f <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(inst2_data<span class="sc">$</span>measurement)</span>
<span id="cb44-7"><a href="#cb44-7"></a>s1_f_squared <span class="ot">&lt;-</span> <span class="fu">fvar</span>(inst1_data<span class="sc">$</span>measurement)</span>
<span id="cb44-8"><a href="#cb44-8"></a>s2_f_squared <span class="ot">&lt;-</span> <span class="fu">fvar</span>(inst2_data<span class="sc">$</span>measurement)</span>
<span id="cb44-9"><a href="#cb44-9"></a></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co"># F-test (put larger variance in numerator)</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="cf">if</span>(s1_f_squared <span class="sc">&gt;=</span> s2_f_squared) {</span>
<span id="cb44-12"><a href="#cb44-12"></a>  f_stat <span class="ot">&lt;-</span> s1_f_squared <span class="sc">/</span> s2_f_squared</span>
<span id="cb44-13"><a href="#cb44-13"></a>  df1_f_test <span class="ot">&lt;-</span> n1_f <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb44-14"><a href="#cb44-14"></a>  df2_f_test <span class="ot">&lt;-</span> n2_f <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb44-15"><a href="#cb44-15"></a>  larger_var <span class="ot">&lt;-</span> <span class="st">"Instrument_1"</span></span>
<span id="cb44-16"><a href="#cb44-16"></a>} <span class="cf">else</span> {</span>
<span id="cb44-17"><a href="#cb44-17"></a>  f_stat <span class="ot">&lt;-</span> s2_f_squared <span class="sc">/</span> s1_f_squared</span>
<span id="cb44-18"><a href="#cb44-18"></a>  df1_f_test <span class="ot">&lt;-</span> n2_f <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb44-19"><a href="#cb44-19"></a>  df2_f_test <span class="ot">&lt;-</span> n1_f <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb44-20"><a href="#cb44-20"></a>  larger_var <span class="ot">&lt;-</span> <span class="st">"Instrument_2"</span></span>
<span id="cb44-21"><a href="#cb44-21"></a>}</span>
<span id="cb44-22"><a href="#cb44-22"></a></span>
<span id="cb44-23"><a href="#cb44-23"></a><span class="co"># Calculate p-value for two-sided test</span></span>
<span id="cb44-24"><a href="#cb44-24"></a>p_value_f_test <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f_stat, df1_f_test, df2_f_test))</span>
<span id="cb44-25"><a href="#cb44-25"></a>f_critical <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, df1_f_test, df2_f_test)</span>
<span id="cb44-26"><a href="#cb44-26"></a></span>
<span id="cb44-27"><a href="#cb44-27"></a><span class="co"># Test results</span></span>
<span id="cb44-28"><a href="#cb44-28"></a>f_test_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb44-29"><a href="#cb44-29"></a>  <span class="at">Test_Type =</span> <span class="st">"F-test for equality of variances"</span>,</span>
<span id="cb44-30"><a href="#cb44-30"></a>  <span class="at">n1 =</span> n1_f,</span>
<span id="cb44-31"><a href="#cb44-31"></a>  <span class="at">n2 =</span> n2_f,</span>
<span id="cb44-32"><a href="#cb44-32"></a>  <span class="at">s1_squared =</span> <span class="fu">round</span>(s1_f_squared, <span class="dv">4</span>),</span>
<span id="cb44-33"><a href="#cb44-33"></a>  <span class="at">s2_squared =</span> <span class="fu">round</span>(s2_f_squared, <span class="dv">4</span>),</span>
<span id="cb44-34"><a href="#cb44-34"></a>  <span class="at">Larger_Variance =</span> larger_var,</span>
<span id="cb44-35"><a href="#cb44-35"></a>  <span class="at">F_Statistic =</span> <span class="fu">round</span>(f_stat, <span class="dv">4</span>),</span>
<span id="cb44-36"><a href="#cb44-36"></a>  <span class="at">df1 =</span> df1_f_test,</span>
<span id="cb44-37"><a href="#cb44-37"></a>  <span class="at">df2 =</span> df2_f_test,</span>
<span id="cb44-38"><a href="#cb44-38"></a>  <span class="at">P_Value =</span> <span class="fu">round</span>(p_value_f_test, <span class="dv">4</span>),</span>
<span id="cb44-39"><a href="#cb44-39"></a>  <span class="at">Alpha =</span> alpha,</span>
<span id="cb44-40"><a href="#cb44-40"></a>  <span class="at">F_Critical =</span> <span class="fu">round</span>(f_critical, <span class="dv">3</span>),</span>
<span id="cb44-41"><a href="#cb44-41"></a>  <span class="at">Decision =</span> <span class="fu">ifelse</span>(f_stat <span class="sc">&gt;</span> f_critical, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb44-42"><a href="#cb44-42"></a>  <span class="at">Conclusion =</span> <span class="fu">ifelse</span>(p_value_f_test <span class="sc">&lt;</span> alpha, </span>
<span id="cb44-43"><a href="#cb44-43"></a>                     <span class="st">"Variances are significantly different"</span>, </span>
<span id="cb44-44"><a href="#cb44-44"></a>                     <span class="st">"No significant difference in variances"</span>)</span>
<span id="cb44-45"><a href="#cb44-45"></a>)</span>
<span id="cb44-46"><a href="#cb44-46"></a></span>
<span id="cb44-47"><a href="#cb44-47"></a><span class="fu">print</span>(<span class="st">"F-Test Results for Equality of Variances:"</span>)</span>
<span id="cb44-48"><a href="#cb44-48"></a><span class="fu">print</span>(f_test_results)</span>
<span id="cb44-49"><a href="#cb44-49"></a></span>
<span id="cb44-50"><a href="#cb44-50"></a><span class="co"># Using R's var.test for verification</span></span>
<span id="cb44-51"><a href="#cb44-51"></a>var_test_r <span class="ot">&lt;-</span> <span class="fu">var.test</span>(inst1_data<span class="sc">$</span>measurement, inst2_data<span class="sc">$</span>measurement)</span>
<span id="cb44-52"><a href="#cb44-52"></a><span class="fu">print</span>(<span class="st">"R's var.test verification:"</span>)</span>
<span id="cb44-53"><a href="#cb44-53"></a><span class="fu">print</span>(var_test_r)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="confidence-interval-on-the-ratio-of-two-variances" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="confidence-interval-on-the-ratio-of-two-variances"><span class="header-section-number">1.5.3</span> Confidence Interval on the Ratio of Two Variances</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Confidence Interval for σ₁²/σ₂²
</div>
</div>
<div class="callout-body-container callout-body">
<p>A 100(1-α)% confidence interval for σ₁²/σ₂²:</p>
<p><span class="math display">\frac{s_1^2/s_2^2}{F_{\alpha/2,n_1-1,n_2-1}} \leq \frac{\sigma_1^2}{\sigma_2^2} \leq \frac{s_1^2/s_2^2}{F_{1-\alpha/2,n_1-1,n_2-1}}</span></p>
<p>Note: F₁₋α/₂,ν₁,ν₂ = 1/F_α/₂,ν₂,ν₁</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Ratio of Variances:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter Confidence_Level Sample_Ratio Lower_Bound Upper_Bound  Width
      &lt;char&gt;           &lt;char&gt;        &lt;num&gt;       &lt;num&gt;       &lt;num&gt;  &lt;num&gt;
1:   σ₁²/σ₂²              95%       1.2533      0.4871       3.454 2.9669
                                           Interpretation
                                                   &lt;char&gt;
1: 95% confident that σ₁²/σ₂² is between 0.4871 and 3.454</code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># Confidence interval for ratio of variances</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>f_alpha2_lower <span class="ot">&lt;-</span> <span class="fu">qf</span>(alpha<span class="sc">/</span><span class="dv">2</span>, df1_f_test, df2_f_test)</span>
<span id="cb47-3"><a href="#cb47-3"></a>f_alpha2_upper <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, df1_f_test, df2_f_test)</span>
<span id="cb47-4"><a href="#cb47-4"></a></span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="co"># Note: For CI, use original ratio without putting larger in numerator</span></span>
<span id="cb47-6"><a href="#cb47-6"></a>ratio_original <span class="ot">&lt;-</span> s1_f_squared <span class="sc">/</span> s2_f_squared</span>
<span id="cb47-7"><a href="#cb47-7"></a>ci_lower_f <span class="ot">&lt;-</span> ratio_original <span class="sc">/</span> f_alpha2_upper</span>
<span id="cb47-8"><a href="#cb47-8"></a>ci_upper_f <span class="ot">&lt;-</span> ratio_original <span class="sc">/</span> f_alpha2_lower</span>
<span id="cb47-9"><a href="#cb47-9"></a></span>
<span id="cb47-10"><a href="#cb47-10"></a>variance_ratio_ci <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb47-11"><a href="#cb47-11"></a>  <span class="at">Parameter =</span> <span class="st">"σ₁²/σ₂²"</span>,</span>
<span id="cb47-12"><a href="#cb47-12"></a>  <span class="at">Confidence_Level =</span> <span class="st">"95%"</span>,</span>
<span id="cb47-13"><a href="#cb47-13"></a>  <span class="at">Sample_Ratio =</span> <span class="fu">round</span>(ratio_original, <span class="dv">4</span>),</span>
<span id="cb47-14"><a href="#cb47-14"></a>  <span class="at">Lower_Bound =</span> <span class="fu">round</span>(ci_lower_f, <span class="dv">4</span>),</span>
<span id="cb47-15"><a href="#cb47-15"></a>  <span class="at">Upper_Bound =</span> <span class="fu">round</span>(ci_upper_f, <span class="dv">4</span>),</span>
<span id="cb47-16"><a href="#cb47-16"></a>  <span class="at">Width =</span> <span class="fu">round</span>(ci_upper_f <span class="sc">-</span> ci_lower_f, <span class="dv">4</span>),</span>
<span id="cb47-17"><a href="#cb47-17"></a>  <span class="at">Interpretation =</span> <span class="fu">paste</span>(<span class="st">"95% confident that σ₁²/σ₂² is between"</span>, </span>
<span id="cb47-18"><a href="#cb47-18"></a>                        <span class="fu">round</span>(ci_lower_f, <span class="dv">4</span>), <span class="st">"and"</span>, <span class="fu">round</span>(ci_upper_f, <span class="dv">4</span>))</span>
<span id="cb47-19"><a href="#cb47-19"></a>)</span>
<span id="cb47-20"><a href="#cb47-20"></a></span>
<span id="cb47-21"><a href="#cb47-21"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Ratio of Variances:"</span>)</span>
<span id="cb47-22"><a href="#cb47-22"></a><span class="fu">print</span>(variance_ratio_ci)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inference-on-two-population-proportions" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="inference-on-two-population-proportions"><span class="header-section-number">1.6</span> Inference on Two Population Proportions</h2>
<section id="hypothesis-testing-on-the-equality-of-two-proportions" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="hypothesis-testing-on-the-equality-of-two-proportions"><span class="header-section-number">1.6.1</span> Hypothesis Testing on the Equality of Two Proportions</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Two-Sample Z-Test for Proportions
</div>
</div>
<div class="callout-body-container callout-body">
<p>To test H₀: p₁ = p₂, use the pooled estimate:</p>
<p><span class="math display">\hat{p} = \frac{x_1 + x_2}{n_1 + n_2}</span></p>
<p><strong>Test Statistic:</strong></p>
<p><span class="math display">Z_0 = \frac{\hat{p_1} - \hat{p_2}}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{n_1} + \frac{1}{n_2})}}</span></p>
<p><strong>Conditions:</strong> n₁p̂ ≥ 5, n₁(1-p̂) ≥ 5, n₂p̂ ≥ 5, n₂(1-p̂) ≥ 5</p>
</div>
</div>
</section>
<section id="example-comparing-defect-rates" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="example-comparing-defect-rates"><span class="header-section-number">1.6.2</span> Example: Comparing Defect Rates</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compare defect rates between two production lines:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false"></a><a href="data/defect_comparison.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Defect Rate Comparison Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     line sample_size defects  prop
   &lt;char&gt;       &lt;num&gt;   &lt;num&gt; &lt;num&gt;
1: Line_1         200      16 0.080
2: Line_2         250      14 0.056</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Overall Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Total_Items Total_Defects Line1_Rate Line2_Rate Overall_Rate
         &lt;num&gt;         &lt;num&gt;      &lt;num&gt;      &lt;num&gt;        &lt;num&gt;
1:         450            30       0.08      0.056   0.06666667</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># Defect rate comparison (two-sample proportion test)</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>defect_comparison_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="at">line =</span> <span class="fu">c</span>(<span class="st">"Line_1"</span>, <span class="st">"Line_2"</span>),</span>
<span id="cb52-4"><a href="#cb52-4"></a>  <span class="at">sample_size =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">250</span>),</span>
<span id="cb52-5"><a href="#cb52-5"></a>  <span class="at">defects =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">14</span>),</span>
<span id="cb52-6"><a href="#cb52-6"></a>  <span class="at">prop =</span> <span class="fu">c</span>(<span class="dv">16</span><span class="sc">/</span><span class="dv">200</span>, <span class="dv">14</span><span class="sc">/</span><span class="dv">250</span>)</span>
<span id="cb52-7"><a href="#cb52-7"></a>)</span>
<span id="cb52-8"><a href="#cb52-8"></a></span>
<span id="cb52-9"><a href="#cb52-9"></a><span class="co"># Summary</span></span>
<span id="cb52-10"><a href="#cb52-10"></a>defect_summary <span class="ot">&lt;-</span> defect_comparison_data <span class="sc">%&gt;%</span> </span>
<span id="cb52-11"><a href="#cb52-11"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb52-12"><a href="#cb52-12"></a>    <span class="at">Total_Items =</span> <span class="fu">fsum</span>(sample_size),</span>
<span id="cb52-13"><a href="#cb52-13"></a>    <span class="at">Total_Defects =</span> <span class="fu">fsum</span>(defects),</span>
<span id="cb52-14"><a href="#cb52-14"></a>    <span class="at">Line1_Rate =</span> defects[<span class="dv">1</span>] <span class="sc">/</span> sample_size[<span class="dv">1</span>],</span>
<span id="cb52-15"><a href="#cb52-15"></a>    <span class="at">Line2_Rate =</span> defects[<span class="dv">2</span>] <span class="sc">/</span> sample_size[<span class="dv">2</span>],</span>
<span id="cb52-16"><a href="#cb52-16"></a>    <span class="at">Overall_Rate =</span> <span class="fu">fsum</span>(defects) <span class="sc">/</span> <span class="fu">fsum</span>(sample_size)</span>
<span id="cb52-17"><a href="#cb52-17"></a>  )</span>
<span id="cb52-18"><a href="#cb52-18"></a></span>
<span id="cb52-19"><a href="#cb52-19"></a><span class="fu">print</span>(<span class="st">"Defect Rate Comparison Summary:"</span>)</span>
<span id="cb52-20"><a href="#cb52-20"></a><span class="fu">print</span>(defect_comparison_data)</span>
<span id="cb52-21"><a href="#cb52-21"></a><span class="fu">print</span>(<span class="st">"Overall Summary:"</span>)</span>
<span id="cb52-22"><a href="#cb52-22"></a><span class="fu">print</span>(defect_summary)</span>
<span id="cb52-23"><a href="#cb52-23"></a></span>
<span id="cb52-24"><a href="#cb52-24"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb52-25"><a href="#cb52-25"></a><span class="fu">fwrite</span>(defect_comparison_data, <span class="st">"data/defect_comparison.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">

</div>
</div>
</div>
<p>Test H₀: p₁ = p₂ vs H₁: p₁ ≠ p₂ at α = 0.05.</p>
<p><strong>Manual Calculation:</strong></p>
<p>Given: n₁ = 200, x₁ = 16, n₂ = 250, x₂ = 14</p>
<ol type="1">
<li><p><strong>Sample Proportions:</strong></p>
<ul>
<li><p>p̂₁ = 16/200 = 0.08</p></li>
<li><p>p̂₂ = 14/250 = 0.056</p></li>
</ul></li>
<li><p><strong>Pooled Proportion:</strong> <span class="math display">\hat{p} = \frac{16 + 14}{200 + 250} = \frac{30}{450} = 0.067</span></p></li>
<li><p><strong>Test Statistic:</strong> <span class="math display">Z_0 = \frac{0.08 - 0.056}{\sqrt{0.067(0.933)(\frac{1}{200} + \frac{1}{250})}} = \frac{0.024}{0.024} = 1.00</span></p></li>
<li><p><strong>Decision:</strong> |Z₀| = 1.00 &lt; 1.96, so fail to reject H₀</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Large Sample Conditions:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Condition     Value    Met
        &lt;char&gt;     &lt;num&gt; &lt;lgcl&gt;
1:     n₁p̂ ≥ 5  13.33333   TRUE
2: n₁(1-p̂) ≥ 5 186.66667   TRUE
3:     n₂p̂ ≥ 5  16.66667   TRUE
4: n₂(1-p̂) ≥ 5 233.33333   TRUE</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Two-Sample Proportion Test Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Test_Type    n1    n2    x1    x2 p1_hat p2_hat p_pooled
                       &lt;char&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;  &lt;num&gt;  &lt;num&gt;    &lt;num&gt;
1: Two-sample proportion test   200   250    16    14   0.08  0.056   0.0667
   SE_Difference Z_Statistic P_Value Alpha Z_Critical          Decision
           &lt;num&gt;       &lt;num&gt;   &lt;num&gt; &lt;num&gt;      &lt;num&gt;            &lt;char&gt;
1:        0.0237      1.0142  0.3105  0.05       1.96 Fail to reject H0
                                 Conclusion
                                     &lt;char&gt;
1: No significant difference in proportions</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's prop.test verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  c(x1_prop, x2_prop) out of c(n1_prop, n2_prop)
X-squared = 0.67902, df = 1, p-value = 0.4099
alternative hypothesis: two.sided
95 percent confidence interval:
 -0.02768004  0.07568004
sample estimates:
prop 1 prop 2 
 0.080  0.056 </code></pre>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Two-sample proportion test</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>n1_prop <span class="ot">&lt;-</span> defect_comparison_data[line <span class="sc">==</span> <span class="st">"Line_1"</span>, sample_size]</span>
<span id="cb59-3"><a href="#cb59-3"></a>n2_prop <span class="ot">&lt;-</span> defect_comparison_data[line <span class="sc">==</span> <span class="st">"Line_2"</span>, sample_size]</span>
<span id="cb59-4"><a href="#cb59-4"></a>x1_prop <span class="ot">&lt;-</span> defect_comparison_data[line <span class="sc">==</span> <span class="st">"Line_1"</span>, defects]</span>
<span id="cb59-5"><a href="#cb59-5"></a>x2_prop <span class="ot">&lt;-</span> defect_comparison_data[line <span class="sc">==</span> <span class="st">"Line_2"</span>, defects]</span>
<span id="cb59-6"><a href="#cb59-6"></a>p1_hat <span class="ot">&lt;-</span> x1_prop <span class="sc">/</span> n1_prop</span>
<span id="cb59-7"><a href="#cb59-7"></a>p2_hat <span class="ot">&lt;-</span> x2_prop <span class="sc">/</span> n2_prop</span>
<span id="cb59-8"><a href="#cb59-8"></a></span>
<span id="cb59-9"><a href="#cb59-9"></a><span class="co"># Pooled proportion</span></span>
<span id="cb59-10"><a href="#cb59-10"></a>p_pooled <span class="ot">&lt;-</span> (x1_prop <span class="sc">+</span> x2_prop) <span class="sc">/</span> (n1_prop <span class="sc">+</span> n2_prop)</span>
<span id="cb59-11"><a href="#cb59-11"></a></span>
<span id="cb59-12"><a href="#cb59-12"></a><span class="co"># Check conditions</span></span>
<span id="cb59-13"><a href="#cb59-13"></a>conditions <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb59-14"><a href="#cb59-14"></a>  <span class="at">Condition =</span> <span class="fu">c</span>(<span class="st">"n₁p̂ ≥ 5"</span>, <span class="st">"n₁(1-p̂) ≥ 5"</span>, <span class="st">"n₂p̂ ≥ 5"</span>, <span class="st">"n₂(1-p̂) ≥ 5"</span>),</span>
<span id="cb59-15"><a href="#cb59-15"></a>  <span class="at">Value =</span> <span class="fu">c</span>(n1_prop <span class="sc">*</span> p_pooled, n1_prop <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_pooled), </span>
<span id="cb59-16"><a href="#cb59-16"></a>           n2_prop <span class="sc">*</span> p_pooled, n2_prop <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_pooled)),</span>
<span id="cb59-17"><a href="#cb59-17"></a>  <span class="at">Met =</span> <span class="fu">c</span>(n1_prop <span class="sc">*</span> p_pooled <span class="sc">&gt;=</span> <span class="dv">5</span>, n1_prop <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_pooled) <span class="sc">&gt;=</span> <span class="dv">5</span>,</span>
<span id="cb59-18"><a href="#cb59-18"></a>         n2_prop <span class="sc">*</span> p_pooled <span class="sc">&gt;=</span> <span class="dv">5</span>, n2_prop <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_pooled) <span class="sc">&gt;=</span> <span class="dv">5</span>)</span>
<span id="cb59-19"><a href="#cb59-19"></a>)</span>
<span id="cb59-20"><a href="#cb59-20"></a></span>
<span id="cb59-21"><a href="#cb59-21"></a><span class="fu">print</span>(<span class="st">"Large Sample Conditions:"</span>)</span>
<span id="cb59-22"><a href="#cb59-22"></a><span class="fu">print</span>(conditions)</span>
<span id="cb59-23"><a href="#cb59-23"></a></span>
<span id="cb59-24"><a href="#cb59-24"></a><span class="co"># Manual calculation</span></span>
<span id="cb59-25"><a href="#cb59-25"></a>se_prop <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_pooled <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_pooled) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n1_prop <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2_prop))</span>
<span id="cb59-26"><a href="#cb59-26"></a>z_stat_prop <span class="ot">&lt;-</span> (p1_hat <span class="sc">-</span> p2_hat) <span class="sc">/</span> se_prop</span>
<span id="cb59-27"><a href="#cb59-27"></a>p_value_prop <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stat_prop)))  <span class="co"># Two-sided test</span></span>
<span id="cb59-28"><a href="#cb59-28"></a>z_critical_prop <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb59-29"><a href="#cb59-29"></a></span>
<span id="cb59-30"><a href="#cb59-30"></a><span class="co"># Test results</span></span>
<span id="cb59-31"><a href="#cb59-31"></a>prop_test_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb59-32"><a href="#cb59-32"></a>  <span class="at">Test_Type =</span> <span class="st">"Two-sample proportion test"</span>,</span>
<span id="cb59-33"><a href="#cb59-33"></a>  <span class="at">n1 =</span> n1_prop,</span>
<span id="cb59-34"><a href="#cb59-34"></a>  <span class="at">n2 =</span> n2_prop,</span>
<span id="cb59-35"><a href="#cb59-35"></a>  <span class="at">x1 =</span> x1_prop,</span>
<span id="cb59-36"><a href="#cb59-36"></a>  <span class="at">x2 =</span> x2_prop,</span>
<span id="cb59-37"><a href="#cb59-37"></a>  <span class="at">p1_hat =</span> <span class="fu">round</span>(p1_hat, <span class="dv">4</span>),</span>
<span id="cb59-38"><a href="#cb59-38"></a>  <span class="at">p2_hat =</span> <span class="fu">round</span>(p2_hat, <span class="dv">4</span>),</span>
<span id="cb59-39"><a href="#cb59-39"></a>  <span class="at">p_pooled =</span> <span class="fu">round</span>(p_pooled, <span class="dv">4</span>),</span>
<span id="cb59-40"><a href="#cb59-40"></a>  <span class="at">SE_Difference =</span> <span class="fu">round</span>(se_prop, <span class="dv">4</span>),</span>
<span id="cb59-41"><a href="#cb59-41"></a>  <span class="at">Z_Statistic =</span> <span class="fu">round</span>(z_stat_prop, <span class="dv">4</span>),</span>
<span id="cb59-42"><a href="#cb59-42"></a>  <span class="at">P_Value =</span> <span class="fu">round</span>(p_value_prop, <span class="dv">4</span>),</span>
<span id="cb59-43"><a href="#cb59-43"></a>  <span class="at">Alpha =</span> alpha,</span>
<span id="cb59-44"><a href="#cb59-44"></a>  <span class="at">Z_Critical =</span> <span class="fu">round</span>(z_critical_prop, <span class="dv">3</span>),</span>
<span id="cb59-45"><a href="#cb59-45"></a>  <span class="at">Decision =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(z_stat_prop) <span class="sc">&gt;</span> z_critical_prop, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb59-46"><a href="#cb59-46"></a>  <span class="at">Conclusion =</span> <span class="fu">ifelse</span>(p_value_prop <span class="sc">&lt;</span> alpha, </span>
<span id="cb59-47"><a href="#cb59-47"></a>                     <span class="st">"Proportions are significantly different"</span>, </span>
<span id="cb59-48"><a href="#cb59-48"></a>                     <span class="st">"No significant difference in proportions"</span>)</span>
<span id="cb59-49"><a href="#cb59-49"></a>)</span>
<span id="cb59-50"><a href="#cb59-50"></a></span>
<span id="cb59-51"><a href="#cb59-51"></a><span class="fu">print</span>(<span class="st">"Two-Sample Proportion Test Results:"</span>)</span>
<span id="cb59-52"><a href="#cb59-52"></a><span class="fu">print</span>(prop_test_results)</span>
<span id="cb59-53"><a href="#cb59-53"></a></span>
<span id="cb59-54"><a href="#cb59-54"></a><span class="co"># Using R's prop.test for verification</span></span>
<span id="cb59-55"><a href="#cb59-55"></a>prop_test_r <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">c</span>(x1_prop, x2_prop), <span class="at">n =</span> <span class="fu">c</span>(n1_prop, n2_prop))</span>
<span id="cb59-56"><a href="#cb59-56"></a><span class="fu">print</span>(<span class="st">"R's prop.test verification:"</span>)</span>
<span id="cb59-57"><a href="#cb59-57"></a><span class="fu">print</span>(prop_test_r)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="type-ii-error-and-choice-of-sample-size-2" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="type-ii-error-and-choice-of-sample-size-2"><span class="header-section-number">1.6.3</span> Type II Error and Choice of Sample Size</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Sample Size for Two-Proportion Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>For equal sample sizes (n₁ = n₂ = n) and difference δ = |p₁ - p₂|:</p>
<p><span class="math display">n = \frac{[z_{\alpha/2}\sqrt{2\bar{p}(1-\bar{p})} + z_\beta\sqrt{p_1(1-p_1) + p_2(1-p_2)}]^2}{\delta^2}</span></p>
<p>where <span class="math inline">\bar{p} = \frac{p_1 + p_2}{2}</span></p>
</div>
</div>
</section>
<section id="confidence-interval-on-the-difference-in-proportions" class="level3" data-number="1.6.4">
<h3 data-number="1.6.4" class="anchored" data-anchor-id="confidence-interval-on-the-difference-in-proportions"><span class="header-section-number">1.6.4</span> Confidence Interval on the Difference in Proportions</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Confidence Interval for p₁ - p₂
</div>
</div>
<div class="callout-body-container callout-body">
<p>A 100(1-α)% confidence interval for p₁ - p₂:</p>
<p><span class="math display">(\hat{p_1} - \hat{p_2}) \pm z_{\alpha/2}\sqrt{\frac{\hat{p_1}(1-\hat{p_1})}{n_1} + \frac{\hat{p_2}(1-\hat{p_2})}{n_2}}</span></p>
<p><strong>Note:</strong> Use individual sample proportions, not the pooled estimate.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Interval for Difference in Proportions:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Parameter Confidence_Level Difference Standard_Error Z_Critical Margin_Error
      &lt;char&gt;           &lt;char&gt;      &lt;num&gt;          &lt;num&gt;      &lt;num&gt;        &lt;num&gt;
1:   p₁ - p₂              95%      0.024         0.0241       1.96       0.0472
   Lower_Bound Upper_Bound  Width
         &lt;num&gt;       &lt;num&gt;  &lt;num&gt;
1:     -0.0232      0.0712 0.0944
                                             Interpretation
                                                     &lt;char&gt;
1: 95% confident that p₁ - p₂ is between -0.0232 and 0.0712</code></pre>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># Confidence interval for difference in proportions</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>se_diff_ci <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p1_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1_hat) <span class="sc">/</span> n1_prop <span class="sc">+</span> p2_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2_hat) <span class="sc">/</span> n2_prop)</span>
<span id="cb62-3"><a href="#cb62-3"></a>margin_error_prop <span class="ot">&lt;-</span> z_critical_prop <span class="sc">*</span> se_diff_ci</span>
<span id="cb62-4"><a href="#cb62-4"></a>ci_lower_prop <span class="ot">&lt;-</span> (p1_hat <span class="sc">-</span> p2_hat) <span class="sc">-</span> margin_error_prop</span>
<span id="cb62-5"><a href="#cb62-5"></a>ci_upper_prop <span class="ot">&lt;-</span> (p1_hat <span class="sc">-</span> p2_hat) <span class="sc">+</span> margin_error_prop</span>
<span id="cb62-6"><a href="#cb62-6"></a></span>
<span id="cb62-7"><a href="#cb62-7"></a>prop_ci_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb62-8"><a href="#cb62-8"></a>  <span class="at">Parameter =</span> <span class="st">"p₁ - p₂"</span>,</span>
<span id="cb62-9"><a href="#cb62-9"></a>  <span class="at">Confidence_Level =</span> <span class="st">"95%"</span>,</span>
<span id="cb62-10"><a href="#cb62-10"></a>  <span class="at">Difference =</span> <span class="fu">round</span>(p1_hat <span class="sc">-</span> p2_hat, <span class="dv">4</span>),</span>
<span id="cb62-11"><a href="#cb62-11"></a>  <span class="at">Standard_Error =</span> <span class="fu">round</span>(se_diff_ci, <span class="dv">4</span>),</span>
<span id="cb62-12"><a href="#cb62-12"></a>  <span class="at">Z_Critical =</span> <span class="fu">round</span>(z_critical_prop, <span class="dv">3</span>),</span>
<span id="cb62-13"><a href="#cb62-13"></a>  <span class="at">Margin_Error =</span> <span class="fu">round</span>(margin_error_prop, <span class="dv">4</span>),</span>
<span id="cb62-14"><a href="#cb62-14"></a>  <span class="at">Lower_Bound =</span> <span class="fu">round</span>(ci_lower_prop, <span class="dv">4</span>),</span>
<span id="cb62-15"><a href="#cb62-15"></a>  <span class="at">Upper_Bound =</span> <span class="fu">round</span>(ci_upper_prop, <span class="dv">4</span>),</span>
<span id="cb62-16"><a href="#cb62-16"></a>  <span class="at">Width =</span> <span class="fu">round</span>(ci_upper_prop <span class="sc">-</span> ci_lower_prop, <span class="dv">4</span>),</span>
<span id="cb62-17"><a href="#cb62-17"></a>  <span class="at">Interpretation =</span> <span class="fu">paste</span>(<span class="st">"95% confident that p₁ - p₂ is between"</span>, </span>
<span id="cb62-18"><a href="#cb62-18"></a>                        <span class="fu">round</span>(ci_lower_prop, <span class="dv">4</span>), <span class="st">"and"</span>, <span class="fu">round</span>(ci_upper_prop, <span class="dv">4</span>))</span>
<span id="cb62-19"><a href="#cb62-19"></a>)</span>
<span id="cb62-20"><a href="#cb62-20"></a></span>
<span id="cb62-21"><a href="#cb62-21"></a><span class="fu">print</span>(<span class="st">"95% Confidence Interval for Difference in Proportions:"</span>)</span>
<span id="cb62-22"><a href="#cb62-22"></a><span class="fu">print</span>(prop_ci_results)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="summary-tables-for-inference-procedures-for-two-samples" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="summary-tables-for-inference-procedures-for-two-samples"><span class="header-section-number">1.7</span> Summary Tables for Inference Procedures for Two Samples</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div id="tbl-Ch05Code01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Ch05Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Summary of two-sample inference procedures
</figcaption>
<div aria-describedby="tbl-Ch05Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small">
<caption>Summary of Two-Sample Inference Procedures</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test_Statistic</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Distribution</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Confidence_Interval</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Assumptions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">μ₁ - μ₂ (σ known)</td>
<td style="text-align: left; width: 3.5cm;">Z = (x̄₁-x̄₂)/√(σ₁²/n₁+σ₂²/n₂)</td>
<td style="text-align: left; width: 2cm;">N(0,1)</td>
<td style="text-align: left; width: 3.5cm;">(x̄₁-x̄₂) ± z_{α/2}√(σ₁²/n₁+σ₂²/n₂)</td>
<td style="text-align: left; width: 2.5cm;">Normal populations, σ known</td>
</tr>
<tr class="even">
<td style="text-align: left;">μ₁ - μ₂ (σ unknown, equal)</td>
<td style="text-align: left; width: 3.5cm;">t = (x̄₁-x̄₂)/(sp√(1/n₁+1/n₂))</td>
<td style="text-align: left; width: 2cm;">t(n₁+n₂-2)</td>
<td style="text-align: left; width: 3.5cm;">(x̄₁-x̄₂) ± t_{α/2}sp√(1/n₁+1/n₂)</td>
<td style="text-align: left; width: 2.5cm;">Normal populations, σ₁²=σ₂²</td>
</tr>
<tr class="odd">
<td style="text-align: left;">μ₁ - μ₂ (σ unknown, unequal)</td>
<td style="text-align: left; width: 3.5cm;">t = (x̄₁-x̄₂)/√(s₁²/n₁+s₂²/n₂)</td>
<td style="text-align: left; width: 2cm;">t(ν)</td>
<td style="text-align: left; width: 3.5cm;">(x̄₁-x̄₂) ± t_{α/2}√(s₁²/n₁+s₂²/n₂)</td>
<td style="text-align: left; width: 2.5cm;">Normal populations, σ₁²≠σ₂²</td>
</tr>
<tr class="even">
<td style="text-align: left;">μ_d (paired)</td>
<td style="text-align: left; width: 3.5cm;">t = d̄/(sd/√n)</td>
<td style="text-align: left; width: 2cm;">t(n-1)</td>
<td style="text-align: left; width: 3.5cm;">d̄ ± t_{α/2}sd/√n</td>
<td style="text-align: left; width: 2.5cm;">Normal differences</td>
</tr>
<tr class="odd">
<td style="text-align: left;">σ₁²/σ₂²</td>
<td style="text-align: left; width: 3.5cm;">F = s₁²/s₂²</td>
<td style="text-align: left; width: 2cm;">F(n₁-1,n₂-1)</td>
<td style="text-align: left; width: 3.5cm;">(s₁²/s₂²)/F_{α/2} to (s₁²/s₂²)/F_{1-α/2}</td>
<td style="text-align: left; width: 2.5cm;">Normal populations</td>
</tr>
<tr class="even">
<td style="text-align: left;">p₁ - p₂</td>
<td style="text-align: left; width: 3.5cm;">Z = (p̂₁-p̂₂)/√(p̂(1-p̂)(1/n₁+1/n₂))</td>
<td style="text-align: left; width: 2cm;">N(0,1)</td>
<td style="text-align: left; width: 3.5cm;">(p̂₁-p̂₂) ± z_{α/2}√(p̂₁(1-p̂₁)/n₁+p̂₂(1-p̂₂)/n₂)</td>
<td style="text-align: left; width: 2.5cm;">Large samples, np≥5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div id="tbl-Ch05Code01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-Ch05Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2
</figcaption>
<div aria-describedby="tbl-Ch05Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># Summary table of two-sample inference procedures</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>inference_procedures <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"μ₁ - μ₂ (σ known)"</span>, <span class="st">"μ₁ - μ₂ (σ unknown, equal)"</span>, </span>
<span id="cb63-4"><a href="#cb63-4"></a>               <span class="st">"μ₁ - μ₂ (σ unknown, unequal)"</span>, <span class="st">"μ_d (paired)"</span>,</span>
<span id="cb63-5"><a href="#cb63-5"></a>               <span class="st">"σ₁²/σ₂²"</span>, <span class="st">"p₁ - p₂"</span>),</span>
<span id="cb63-6"><a href="#cb63-6"></a>  <span class="at">Test_Statistic =</span> <span class="fu">c</span>(<span class="st">"Z = (x̄₁-x̄₂)/√(σ₁²/n₁+σ₂²/n₂)"</span>, </span>
<span id="cb63-7"><a href="#cb63-7"></a>                    <span class="st">"t = (x̄₁-x̄₂)/(sp√(1/n₁+1/n₂))"</span>,</span>
<span id="cb63-8"><a href="#cb63-8"></a>                    <span class="st">"t = (x̄₁-x̄₂)/√(s₁²/n₁+s₂²/n₂)"</span>,</span>
<span id="cb63-9"><a href="#cb63-9"></a>                    <span class="st">"t = d̄/(sd/√n)"</span>,</span>
<span id="cb63-10"><a href="#cb63-10"></a>                    <span class="st">"F = s₁²/s₂²"</span>,</span>
<span id="cb63-11"><a href="#cb63-11"></a>                    <span class="st">"Z = (p̂₁-p̂₂)/√(p̂(1-p̂)(1/n₁+1/n₂))"</span>),</span>
<span id="cb63-12"><a href="#cb63-12"></a>  <span class="at">Distribution =</span> <span class="fu">c</span>(<span class="st">"N(0,1)"</span>, <span class="st">"t(n₁+n₂-2)"</span>, <span class="st">"t(ν)"</span>, <span class="st">"t(n-1)"</span>, <span class="st">"F(n₁-1,n₂-1)"</span>, <span class="st">"N(0,1)"</span>),</span>
<span id="cb63-13"><a href="#cb63-13"></a>  <span class="at">Confidence_Interval =</span> <span class="fu">c</span>(<span class="st">"(x̄₁-x̄₂) ± z_{α/2}√(σ₁²/n₁+σ₂²/n₂)"</span>,</span>
<span id="cb63-14"><a href="#cb63-14"></a>                         <span class="st">"(x̄₁-x̄₂) ± t_{α/2}sp√(1/n₁+1/n₂)"</span>,</span>
<span id="cb63-15"><a href="#cb63-15"></a>                         <span class="st">"(x̄₁-x̄₂) ± t_{α/2}√(s₁²/n₁+s₂²/n₂)"</span>,</span>
<span id="cb63-16"><a href="#cb63-16"></a>                         <span class="st">"d̄ ± t_{α/2}sd/√n"</span>,</span>
<span id="cb63-17"><a href="#cb63-17"></a>                         <span class="st">"(s₁²/s₂²)/F_{α/2} to (s₁²/s₂²)/F_{1-α/2}"</span>,</span>
<span id="cb63-18"><a href="#cb63-18"></a>                         <span class="st">"(p̂₁-p̂₂) ± z_{α/2}√(p̂₁(1-p̂₁)/n₁+p̂₂(1-p̂₂)/n₂)"</span>),</span>
<span id="cb63-19"><a href="#cb63-19"></a>  <span class="at">Assumptions =</span> <span class="fu">c</span>(<span class="st">"Normal populations, σ known"</span>, <span class="st">"Normal populations, σ₁²=σ₂²"</span>,</span>
<span id="cb63-20"><a href="#cb63-20"></a>                 <span class="st">"Normal populations, σ₁²≠σ₂²"</span>, <span class="st">"Normal differences"</span>,</span>
<span id="cb63-21"><a href="#cb63-21"></a>                 <span class="st">"Normal populations"</span>, <span class="st">"Large samples, np≥5"</span>)</span>
<span id="cb63-22"><a href="#cb63-22"></a>)</span>
<span id="cb63-23"><a href="#cb63-23"></a></span>
<span id="cb63-24"><a href="#cb63-24"></a><span class="fu">kbl</span>(inference_procedures, </span>
<span id="cb63-25"><a href="#cb63-25"></a>    <span class="at">caption =</span> <span class="st">"Summary of Two-Sample Inference Procedures"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-26"><a href="#cb63-26"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-27"><a href="#cb63-27"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"3.5cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-28"><a href="#cb63-28"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"2cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-29"><a href="#cb63-29"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">width =</span> <span class="st">"3.5cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-30"><a href="#cb63-30"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">width =</span> <span class="st">"2.5cm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="what-if-we-have-more-than-two-samples" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="what-if-we-have-more-than-two-samples"><span class="header-section-number">1.8</span> What if We Have More than Two Samples?</h2>
<section id="completely-randomized-experiment-and-analysis-of-variance" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="completely-randomized-experiment-and-analysis-of-variance"><span class="header-section-number">1.8.1</span> Completely Randomized Experiment and Analysis of Variance</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Introduction to ANOVA
</div>
</div>
<div class="callout-body-container callout-body">
<p>When comparing more than two groups, multiple t-tests lead to inflated Type I error rates. <strong>Analysis of Variance (ANOVA)</strong> provides a single test for:</p>
<p>H₀: μ₁ = μ₂ = … = μₐ</p>
<p>H₁: At least one mean differs</p>
<p><strong>One-Way ANOVA Model:</strong></p>
<p><span class="math display">y_{ij} = \mu + \tau_i + \epsilon_{ij}</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">y_{ij}</span> = j-th observation in i-th treatment</p></li>
<li><p><span class="math inline">μ</span> = overall mean</p></li>
<li><p><span class="math inline">τᵢ</span> = effect of i-th treatment</p></li>
<li><p><span class="math inline">εᵢⱼ \sim N(0, σ²)</span></p></li>
</ul>
<p><strong>F-Statistic:</strong></p>
<p><span class="math display">F_0 = \frac{MS_{Treatments}}{MS_{Error}} = \frac{SS_{Treatments}/(a-1)}{SS_{Error}/(N-a)}</span></p>
</div>
</div>
</section>
<section id="example-comparing-multiple-processes" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="example-comparing-multiple-processes"><span class="header-section-number">1.8.2</span> Example: Comparing Multiple Processes</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compare the yield from four different chemical processes:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false"></a><a href="data/process_yield.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Process Yield Data Summary by Process:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     process     n      Min       Q1   Median     Mean       Q3      Max
      &lt;char&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
1: Process_A     6 71.95873 73.73665 75.00213 75.90529 77.54712 81.75850
2: Process_B     6 74.64733 76.58680 79.26790 78.91072 81.56075 82.26307
3: Process_C     6 68.06958 68.56533 70.23732 70.18130 71.91936 72.05552
4: Process_D     6 76.94869 79.26128 81.26787 80.64549 82.49767 82.88851
         SD       Var
      &lt;num&gt;     &lt;num&gt;
1: 3.561280 12.682715
2: 3.180471 10.115399
3: 1.927890  3.716761
4: 2.362796  5.582806</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Overall Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Total_n Overall_Mean Overall_SD Overall_Var Between_Process_Range
     &lt;int&gt;        &lt;num&gt;      &lt;num&gt;       &lt;num&gt;                 &lt;num&gt;
1:      24      76.4107   4.845237    23.47632               10.4642</code></pre>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># One-way ANOVA example (comparing multiple processes)</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="fu">set.seed</span>(<span class="dv">654</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a>process_yield_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb68-4"><a href="#cb68-4"></a>  <span class="at">process =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Process_A"</span>, <span class="st">"Process_B"</span>, <span class="st">"Process_C"</span>, <span class="st">"Process_D"</span>), <span class="at">each =</span> <span class="dv">6</span>),</span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="at">yield =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">4</span>),   <span class="co"># Process A</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>           <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">78</span>, <span class="at">sd =</span> <span class="dv">4</span>),   <span class="co"># Process B  </span></span>
<span id="cb68-7"><a href="#cb68-7"></a>           <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">72</span>, <span class="at">sd =</span> <span class="dv">4</span>),   <span class="co"># Process C</span></span>
<span id="cb68-8"><a href="#cb68-8"></a>           <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean =</span> <span class="dv">80</span>, <span class="at">sd =</span> <span class="dv">4</span>))   <span class="co"># Process D</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>)</span>
<span id="cb68-10"><a href="#cb68-10"></a></span>
<span id="cb68-11"><a href="#cb68-11"></a><span class="co"># Summary statistics by process</span></span>
<span id="cb68-12"><a href="#cb68-12"></a>yield_summary <span class="ot">&lt;-</span> process_yield_data <span class="sc">%&gt;%</span> </span>
<span id="cb68-13"><a href="#cb68-13"></a>  <span class="fu">fgroup_by</span>(process) <span class="sc">%&gt;%</span> </span>
<span id="cb68-14"><a href="#cb68-14"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb68-15"><a href="#cb68-15"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(yield),</span>
<span id="cb68-16"><a href="#cb68-16"></a>    <span class="at">Min =</span> <span class="fu">fmin</span>(yield),</span>
<span id="cb68-17"><a href="#cb68-17"></a>    <span class="at">Q1 =</span> <span class="fu">fquantile</span>(yield, <span class="fl">0.25</span>),</span>
<span id="cb68-18"><a href="#cb68-18"></a>    <span class="at">Median =</span> <span class="fu">fmedian</span>(yield),</span>
<span id="cb68-19"><a href="#cb68-19"></a>    <span class="at">Mean =</span> <span class="fu">fmean</span>(yield),</span>
<span id="cb68-20"><a href="#cb68-20"></a>    <span class="at">Q3 =</span> <span class="fu">fquantile</span>(yield, <span class="fl">0.75</span>),</span>
<span id="cb68-21"><a href="#cb68-21"></a>    <span class="at">Max =</span> <span class="fu">fmax</span>(yield),</span>
<span id="cb68-22"><a href="#cb68-22"></a>    <span class="at">SD =</span> <span class="fu">fsd</span>(yield),</span>
<span id="cb68-23"><a href="#cb68-23"></a>    <span class="at">Var =</span> <span class="fu">fvar</span>(yield)</span>
<span id="cb68-24"><a href="#cb68-24"></a>  )</span>
<span id="cb68-25"><a href="#cb68-25"></a></span>
<span id="cb68-26"><a href="#cb68-26"></a><span class="fu">print</span>(<span class="st">"Process Yield Data Summary by Process:"</span>)</span>
<span id="cb68-27"><a href="#cb68-27"></a><span class="fu">print</span>(yield_summary)</span>
<span id="cb68-28"><a href="#cb68-28"></a></span>
<span id="cb68-29"><a href="#cb68-29"></a><span class="co"># Overall summary</span></span>
<span id="cb68-30"><a href="#cb68-30"></a>overall_summary <span class="ot">&lt;-</span> process_yield_data <span class="sc">%&gt;%</span> </span>
<span id="cb68-31"><a href="#cb68-31"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb68-32"><a href="#cb68-32"></a>    <span class="at">Total_n =</span> <span class="fu">fnobs</span>(yield),</span>
<span id="cb68-33"><a href="#cb68-33"></a>    <span class="at">Overall_Mean =</span> <span class="fu">fmean</span>(yield),</span>
<span id="cb68-34"><a href="#cb68-34"></a>    <span class="at">Overall_SD =</span> <span class="fu">fsd</span>(yield),</span>
<span id="cb68-35"><a href="#cb68-35"></a>    <span class="at">Overall_Var =</span> <span class="fu">fvar</span>(yield),</span>
<span id="cb68-36"><a href="#cb68-36"></a>    <span class="at">Between_Process_Range =</span> <span class="fu">fmax</span>(yield_summary<span class="sc">$</span>Mean) <span class="sc">-</span> <span class="fu">fmin</span>(yield_summary<span class="sc">$</span>Mean)</span>
<span id="cb68-37"><a href="#cb68-37"></a>  )</span>
<span id="cb68-38"><a href="#cb68-38"></a></span>
<span id="cb68-39"><a href="#cb68-39"></a><span class="fu">print</span>(<span class="st">"Overall Summary:"</span>)</span>
<span id="cb68-40"><a href="#cb68-40"></a><span class="fu">print</span>(overall_summary)</span>
<span id="cb68-41"><a href="#cb68-41"></a></span>
<span id="cb68-42"><a href="#cb68-42"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb68-43"><a href="#cb68-43"></a><span class="fu">fwrite</span>(process_yield_data, <span class="st">"data/process_yield.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">

</div>
</div>
</div>
<p><strong>ANOVA Table:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Source</th>
<th>SS</th>
<th>df</th>
<th>MS</th>
<th>F</th>
<th>P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Total</td>
<td>SSₜ</td>
<td>N-1</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Treatments</td>
<td>SSₜᵣ</td>
<td>a-1</td>
<td>MSₜᵣ</td>
<td>F₀</td>
<td>P</td>
</tr>
<tr class="odd">
<td>Error</td>
<td>SSₑ</td>
<td>N-a</td>
<td>MSₑ</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "One-Way ANOVA Table:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Source     SS    df     MS F_Statistic P_Value
       &lt;char&gt;  &lt;num&gt; &lt;num&gt;  &lt;num&gt;       &lt;num&gt;   &lt;num&gt;
1: Treatments 379.47     3 126.49      15.763       0
2:      Error 160.49    20   8.02          NA      NA
3:      Total 539.96    23     NA          NA      NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANOVA Test Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   F_Statistic F_Critical P_Value Alpha  Decision
         &lt;num&gt;      &lt;num&gt;   &lt;num&gt; &lt;num&gt;    &lt;char&gt;
1:      15.763      3.098       0  0.05 Reject H0
                          Conclusion
                              &lt;char&gt;
1: At least one process mean differs</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's ANOVA verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
process      3  379.5  126.49   15.76 1.7e-05 ***
Residuals   20  160.5    8.02                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># One-way ANOVA calculations (manual and R)</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co"># ANOVA calculations</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>a <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(process_yield_data<span class="sc">$</span>process))  <span class="co"># number of treatments</span></span>
<span id="cb75-4"><a href="#cb75-4"></a>N <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(process_yield_data<span class="sc">$</span>yield)  <span class="co"># total observations</span></span>
<span id="cb75-5"><a href="#cb75-5"></a>n_per_group <span class="ot">&lt;-</span> N <span class="sc">/</span> a  <span class="co"># observations per group (balanced design)</span></span>
<span id="cb75-6"><a href="#cb75-6"></a></span>
<span id="cb75-7"><a href="#cb75-7"></a><span class="co"># Calculate sum of squares</span></span>
<span id="cb75-8"><a href="#cb75-8"></a>grand_mean <span class="ot">&lt;-</span> <span class="fu">fmean</span>(process_yield_data<span class="sc">$</span>yield)</span>
<span id="cb75-9"><a href="#cb75-9"></a></span>
<span id="cb75-10"><a href="#cb75-10"></a><span class="co"># Treatment sum of squares (SST)</span></span>
<span id="cb75-11"><a href="#cb75-11"></a>group_means <span class="ot">&lt;-</span> yield_summary<span class="sc">$</span>Mean</span>
<span id="cb75-12"><a href="#cb75-12"></a>SST <span class="ot">&lt;-</span> n_per_group <span class="sc">*</span> <span class="fu">sum</span>((group_means <span class="sc">-</span> grand_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-13"><a href="#cb75-13"></a></span>
<span id="cb75-14"><a href="#cb75-14"></a><span class="co"># Error sum of squares (SSE) </span></span>
<span id="cb75-15"><a href="#cb75-15"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(yield_summary<span class="sc">$</span>Var <span class="sc">*</span> (yield_summary<span class="sc">$</span>n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb75-16"><a href="#cb75-16"></a></span>
<span id="cb75-17"><a href="#cb75-17"></a><span class="co"># Total sum of squares (SS_Total)</span></span>
<span id="cb75-18"><a href="#cb75-18"></a>SS_Total <span class="ot">&lt;-</span> <span class="fu">sum</span>((process_yield_data<span class="sc">$</span>yield <span class="sc">-</span> grand_mean)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb75-19"><a href="#cb75-19"></a></span>
<span id="cb75-20"><a href="#cb75-20"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb75-21"><a href="#cb75-21"></a>df_treatments <span class="ot">&lt;-</span> a <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb75-22"><a href="#cb75-22"></a>df_error <span class="ot">&lt;-</span> N <span class="sc">-</span> a</span>
<span id="cb75-23"><a href="#cb75-23"></a>df_total <span class="ot">&lt;-</span> N <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb75-24"><a href="#cb75-24"></a></span>
<span id="cb75-25"><a href="#cb75-25"></a><span class="co"># Mean squares</span></span>
<span id="cb75-26"><a href="#cb75-26"></a>MS_treatments <span class="ot">&lt;-</span> SST <span class="sc">/</span> df_treatments</span>
<span id="cb75-27"><a href="#cb75-27"></a>MS_error <span class="ot">&lt;-</span> SSE <span class="sc">/</span> df_error</span>
<span id="cb75-28"><a href="#cb75-28"></a></span>
<span id="cb75-29"><a href="#cb75-29"></a><span class="co"># F-statistic</span></span>
<span id="cb75-30"><a href="#cb75-30"></a>f_stat_anova <span class="ot">&lt;-</span> MS_treatments <span class="sc">/</span> MS_error</span>
<span id="cb75-31"><a href="#cb75-31"></a>p_value_anova <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f_stat_anova, df_treatments, df_error)</span>
<span id="cb75-32"><a href="#cb75-32"></a></span>
<span id="cb75-33"><a href="#cb75-33"></a><span class="co"># ANOVA table</span></span>
<span id="cb75-34"><a href="#cb75-34"></a>anova_table <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb75-35"><a href="#cb75-35"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">"Treatments"</span>, <span class="st">"Error"</span>, <span class="st">"Total"</span>),</span>
<span id="cb75-36"><a href="#cb75-36"></a>  <span class="at">SS =</span> <span class="fu">c</span>(<span class="fu">round</span>(SST, <span class="dv">2</span>), <span class="fu">round</span>(SSE, <span class="dv">2</span>), <span class="fu">round</span>(SS_Total, <span class="dv">2</span>)),</span>
<span id="cb75-37"><a href="#cb75-37"></a>  <span class="at">df =</span> <span class="fu">c</span>(df_treatments, df_error, df_total),</span>
<span id="cb75-38"><a href="#cb75-38"></a>  <span class="at">MS =</span> <span class="fu">c</span>(<span class="fu">round</span>(MS_treatments, <span class="dv">2</span>), <span class="fu">round</span>(MS_error, <span class="dv">2</span>), <span class="cn">NA</span>),</span>
<span id="cb75-39"><a href="#cb75-39"></a>  <span class="at">F_Statistic =</span> <span class="fu">c</span>(<span class="fu">round</span>(f_stat_anova, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb75-40"><a href="#cb75-40"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(p_value_anova, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb75-41"><a href="#cb75-41"></a>)</span>
<span id="cb75-42"><a href="#cb75-42"></a></span>
<span id="cb75-43"><a href="#cb75-43"></a><span class="fu">print</span>(<span class="st">"One-Way ANOVA Table:"</span>)</span>
<span id="cb75-44"><a href="#cb75-44"></a><span class="fu">print</span>(anova_table)</span>
<span id="cb75-45"><a href="#cb75-45"></a></span>
<span id="cb75-46"><a href="#cb75-46"></a><span class="co"># ANOVA conclusion</span></span>
<span id="cb75-47"><a href="#cb75-47"></a>alpha_anova <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb75-48"><a href="#cb75-48"></a>f_critical_anova <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha_anova, df_treatments, df_error)</span>
<span id="cb75-49"><a href="#cb75-49"></a>anova_conclusion <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb75-50"><a href="#cb75-50"></a>  <span class="at">F_Statistic =</span> <span class="fu">round</span>(f_stat_anova, <span class="dv">4</span>),</span>
<span id="cb75-51"><a href="#cb75-51"></a>  <span class="at">F_Critical =</span> <span class="fu">round</span>(f_critical_anova, <span class="dv">3</span>),</span>
<span id="cb75-52"><a href="#cb75-52"></a>  <span class="at">P_Value =</span> <span class="fu">round</span>(p_value_anova, <span class="dv">4</span>),</span>
<span id="cb75-53"><a href="#cb75-53"></a>  <span class="at">Alpha =</span> alpha_anova,</span>
<span id="cb75-54"><a href="#cb75-54"></a>  <span class="at">Decision =</span> <span class="fu">ifelse</span>(f_stat_anova <span class="sc">&gt;</span> f_critical_anova, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb75-55"><a href="#cb75-55"></a>  <span class="at">Conclusion =</span> <span class="fu">ifelse</span>(p_value_anova <span class="sc">&lt;</span> alpha_anova,</span>
<span id="cb75-56"><a href="#cb75-56"></a>                     <span class="st">"At least one process mean differs"</span>,</span>
<span id="cb75-57"><a href="#cb75-57"></a>                     <span class="st">"No significant difference between process means"</span>)</span>
<span id="cb75-58"><a href="#cb75-58"></a>)</span>
<span id="cb75-59"><a href="#cb75-59"></a></span>
<span id="cb75-60"><a href="#cb75-60"></a><span class="fu">print</span>(<span class="st">"ANOVA Test Results:"</span>)</span>
<span id="cb75-61"><a href="#cb75-61"></a><span class="fu">print</span>(anova_conclusion)</span>
<span id="cb75-62"><a href="#cb75-62"></a></span>
<span id="cb75-63"><a href="#cb75-63"></a><span class="co"># Using R's aov function for verification</span></span>
<span id="cb75-64"><a href="#cb75-64"></a>anova_r <span class="ot">&lt;-</span> <span class="fu">aov</span>(yield <span class="sc">~</span> process, <span class="at">data =</span> process_yield_data)</span>
<span id="cb75-65"><a href="#cb75-65"></a>anova_summary_r <span class="ot">&lt;-</span> <span class="fu">summary</span>(anova_r)</span>
<span id="cb75-66"><a href="#cb75-66"></a><span class="fu">print</span>(<span class="st">"R's ANOVA verification:"</span>)</span>
<span id="cb75-67"><a href="#cb75-67"></a><span class="fu">print</span>(anova_summary_r)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch05Code03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch05Code03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch05_files/figure-html/fig-Ch05Code03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: One-way ANOVA visualization"><img src="Ch05_files/figure-html/fig-Ch05Code03-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch05Code03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: One-way ANOVA visualization
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co"># One-way ANOVA visualization</span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="co"># Box plot by process</span></span>
<span id="cb76-3"><a href="#cb76-3"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> process_yield_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> process, <span class="at">y =</span> yield, <span class="at">fill =</span> process)) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> grand_mean, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8"></a>  <span class="fu">labs</span>(</span>
<span id="cb76-9"><a href="#cb76-9"></a>    <span class="at">x =</span> <span class="st">"Process"</span>,</span>
<span id="cb76-10"><a href="#cb76-10"></a>    <span class="at">y =</span> <span class="st">"Yield"</span>,</span>
<span id="cb76-11"><a href="#cb76-11"></a>    <span class="at">title =</span> <span class="st">"Yield by Process"</span>,</span>
<span id="cb76-12"><a href="#cb76-12"></a>    <span class="at">subtitle =</span> <span class="st">"Red diamonds = group means, blue line = grand mean"</span></span>
<span id="cb76-13"><a href="#cb76-13"></a>  ) <span class="sc">+</span></span>
<span id="cb76-14"><a href="#cb76-14"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb76-15"><a href="#cb76-15"></a>  <span class="fu">theme</span>(</span>
<span id="cb76-16"><a href="#cb76-16"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb76-17"><a href="#cb76-17"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb76-18"><a href="#cb76-18"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb76-19"><a href="#cb76-19"></a>  )</span>
<span id="cb76-20"><a href="#cb76-20"></a></span>
<span id="cb76-21"><a href="#cb76-21"></a><span class="co"># Residuals vs fitted plot</span></span>
<span id="cb76-22"><a href="#cb76-22"></a>fitted_values <span class="ot">&lt;-</span> <span class="fu">rep</span>(group_means, <span class="at">each =</span> <span class="dv">6</span>)</span>
<span id="cb76-23"><a href="#cb76-23"></a>residuals <span class="ot">&lt;-</span> process_yield_data<span class="sc">$</span>yield <span class="sc">-</span> fitted_values</span>
<span id="cb76-24"><a href="#cb76-24"></a>residual_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">fitted =</span> fitted_values, <span class="at">residuals =</span> residuals, <span class="at">process =</span> process_yield_data<span class="sc">$</span>process)</span>
<span id="cb76-25"><a href="#cb76-25"></a></span>
<span id="cb76-26"><a href="#cb76-26"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> residual_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb76-27"><a href="#cb76-27"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> process), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb76-28"><a href="#cb76-28"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb76-29"><a href="#cb76-29"></a>  <span class="fu">labs</span>(</span>
<span id="cb76-30"><a href="#cb76-30"></a>    <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb76-31"><a href="#cb76-31"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb76-32"><a href="#cb76-32"></a>    <span class="at">title =</span> <span class="st">"Residuals vs Fitted Values"</span>,</span>
<span id="cb76-33"><a href="#cb76-33"></a>    <span class="at">color =</span> <span class="st">"Process"</span></span>
<span id="cb76-34"><a href="#cb76-34"></a>  ) <span class="sc">+</span></span>
<span id="cb76-35"><a href="#cb76-35"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb76-36"><a href="#cb76-36"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb76-37"><a href="#cb76-37"></a></span>
<span id="cb76-38"><a href="#cb76-38"></a><span class="co"># Combine plots</span></span>
<span id="cb76-39"><a href="#cb76-39"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="randomized-complete-block-experiment" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="randomized-complete-block-experiment"><span class="header-section-number">1.8.3</span> Randomized Complete Block Experiment</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Randomized Complete Block Design
</div>
</div>
<div class="callout-body-container callout-body">
<p>When experimental units are heterogeneous, <strong>blocking</strong> reduces error variance:</p>
<p><strong>Model:</strong></p>
<p><span class="math display">y_{ij} = \mu + \tau_i + \beta_j + \epsilon_{ij}</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">τᵢ</span> = treatment effect</p></li>
<li><p><span class="math inline">βⱼ</span> = block effect</p></li>
<li><p>One observation per treatment-block combination</p></li>
</ul>
<p><strong>Advantages:</strong></p>
<ul>
<li><p>Controls for known sources of variation</p></li>
<li><p>Increases precision of treatment comparisons</p></li>
<li><p>Reduces experimental error</p></li>
</ul>
</div>
</div>
</section>
<section id="example-blocked-experiment" class="level3" data-number="1.8.4">
<h3 data-number="1.8.4" class="anchored" data-anchor-id="example-blocked-experiment"><span class="header-section-number">1.8.4</span> Example: Blocked Experiment</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Test four coating methods on different types of metal substrates (blocks):</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false"></a><a href="data/coating_experiment.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coating Experiment Data Summary by Coating:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     coating     n     Mean       SD      Min      Max
      &lt;char&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
1: Coating_A     5 85.34018 5.821115 78.63352 93.27538
2: Coating_B     5 85.93684 6.051341 79.31872 91.13382
3: Coating_C     5 81.46412 7.616026 72.13510 91.27308
4: Coating_D     5 90.18421 4.988870 82.43243 95.37133</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Summary by Substrate (Block):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   substrate     n     Mean       SD      Min      Max
      &lt;char&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
1:  Aluminum     4 78.79708 4.624031 72.13510 82.43243
2:    Copper     4 91.60979 2.779976 88.66094 95.37133
3:    Nickel     4 80.94072 6.287063 75.63415 90.04449
4:     Steel     4 86.92283 2.550402 84.62341 89.42896
5:  Titanium     4 90.38625 4.640854 83.65485 93.64384</code></pre>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="co"># Randomized complete block design example (coating experiment)</span></span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="fu">set.seed</span>(<span class="dv">987</span>)</span>
<span id="cb81-3"><a href="#cb81-3"></a>coating_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb81-4"><a href="#cb81-4"></a>  <span class="at">coating =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Coating_A"</span>, <span class="st">"Coating_B"</span>, <span class="st">"Coating_C"</span>, <span class="st">"Coating_D"</span>), <span class="dv">5</span>),</span>
<span id="cb81-5"><a href="#cb81-5"></a>  <span class="at">substrate =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Steel"</span>, <span class="st">"Aluminum"</span>, <span class="st">"Copper"</span>, <span class="st">"Titanium"</span>, <span class="st">"Nickel"</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb81-6"><a href="#cb81-6"></a>  <span class="at">adhesion =</span> <span class="fu">c</span>(</span>
<span id="cb81-7"><a href="#cb81-7"></a>    <span class="co"># Steel substrate</span></span>
<span id="cb81-8"><a href="#cb81-8"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">88</span>, <span class="dv">82</span>, <span class="dv">90</span>), <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb81-9"><a href="#cb81-9"></a>    <span class="co"># Aluminum substrate  </span></span>
<span id="cb81-10"><a href="#cb81-10"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">78</span>, <span class="dv">82</span>, <span class="dv">75</span>, <span class="dv">85</span>), <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb81-11"><a href="#cb81-11"></a>    <span class="co"># Copper substrate</span></span>
<span id="cb81-12"><a href="#cb81-12"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">95</span>, <span class="dv">89</span>, <span class="dv">98</span>), <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb81-13"><a href="#cb81-13"></a>    <span class="co"># Titanium substrate</span></span>
<span id="cb81-14"><a href="#cb81-14"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">91</span>, <span class="dv">85</span>, <span class="dv">94</span>), <span class="at">sd =</span> <span class="dv">3</span>),</span>
<span id="cb81-15"><a href="#cb81-15"></a>    <span class="co"># Nickel substrate</span></span>
<span id="cb81-16"><a href="#cb81-16"></a>    <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">83</span>, <span class="dv">77</span>, <span class="dv">87</span>), <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb81-17"><a href="#cb81-17"></a>  )</span>
<span id="cb81-18"><a href="#cb81-18"></a>)</span>
<span id="cb81-19"><a href="#cb81-19"></a></span>
<span id="cb81-20"><a href="#cb81-20"></a><span class="co"># Summary by coating</span></span>
<span id="cb81-21"><a href="#cb81-21"></a>coating_summary <span class="ot">&lt;-</span> coating_data <span class="sc">%&gt;%</span> </span>
<span id="cb81-22"><a href="#cb81-22"></a>  <span class="fu">fgroup_by</span>(coating) <span class="sc">%&gt;%</span> </span>
<span id="cb81-23"><a href="#cb81-23"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb81-24"><a href="#cb81-24"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(adhesion),</span>
<span id="cb81-25"><a href="#cb81-25"></a>    <span class="at">Mean =</span> <span class="fu">fmean</span>(adhesion),</span>
<span id="cb81-26"><a href="#cb81-26"></a>    <span class="at">SD =</span> <span class="fu">fsd</span>(adhesion),</span>
<span id="cb81-27"><a href="#cb81-27"></a>    <span class="at">Min =</span> <span class="fu">fmin</span>(adhesion),</span>
<span id="cb81-28"><a href="#cb81-28"></a>    <span class="at">Max =</span> <span class="fu">fmax</span>(adhesion)</span>
<span id="cb81-29"><a href="#cb81-29"></a>  )</span>
<span id="cb81-30"><a href="#cb81-30"></a></span>
<span id="cb81-31"><a href="#cb81-31"></a><span class="co"># Summary by substrate (block)</span></span>
<span id="cb81-32"><a href="#cb81-32"></a>substrate_summary <span class="ot">&lt;-</span> coating_data <span class="sc">%&gt;%</span> </span>
<span id="cb81-33"><a href="#cb81-33"></a>  <span class="fu">fgroup_by</span>(substrate) <span class="sc">%&gt;%</span> </span>
<span id="cb81-34"><a href="#cb81-34"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb81-35"><a href="#cb81-35"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(adhesion),</span>
<span id="cb81-36"><a href="#cb81-36"></a>    <span class="at">Mean =</span> <span class="fu">fmean</span>(adhesion),</span>
<span id="cb81-37"><a href="#cb81-37"></a>    <span class="at">SD =</span> <span class="fu">fsd</span>(adhesion),</span>
<span id="cb81-38"><a href="#cb81-38"></a>    <span class="at">Min =</span> <span class="fu">fmin</span>(adhesion),</span>
<span id="cb81-39"><a href="#cb81-39"></a>    <span class="at">Max =</span> <span class="fu">fmax</span>(adhesion)</span>
<span id="cb81-40"><a href="#cb81-40"></a>  )</span>
<span id="cb81-41"><a href="#cb81-41"></a></span>
<span id="cb81-42"><a href="#cb81-42"></a><span class="fu">print</span>(<span class="st">"Coating Experiment Data Summary by Coating:"</span>)</span>
<span id="cb81-43"><a href="#cb81-43"></a><span class="fu">print</span>(coating_summary)</span>
<span id="cb81-44"><a href="#cb81-44"></a><span class="fu">print</span>(<span class="st">"Summary by Substrate (Block):"</span>)</span>
<span id="cb81-45"><a href="#cb81-45"></a><span class="fu">print</span>(substrate_summary)</span>
<span id="cb81-46"><a href="#cb81-46"></a></span>
<span id="cb81-47"><a href="#cb81-47"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb81-48"><a href="#cb81-48"></a><span class="fu">fwrite</span>(coating_data, <span class="st">"data/coating_experiment.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">

</div>
</div>
</div>
<p><strong>ANOVA Table for RCBD:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Source</th>
<th>SS</th>
<th>df</th>
<th>MS</th>
<th>F</th>
<th>P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Total</td>
<td>SSₜ</td>
<td>ab-1</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Treatments</td>
<td>SSₜᵣ</td>
<td>a-1</td>
<td>MSₜᵣ</td>
<td>MSₜᵣ/MSₑ</td>
<td>P₁</td>
</tr>
<tr class="odd">
<td>Blocks</td>
<td>SSᵦₗ</td>
<td>b-1</td>
<td>MSᵦₗ</td>
<td>MSᵦₗ/MSₑ</td>
<td>P₂</td>
</tr>
<tr class="even">
<td>Error</td>
<td>SSₑ</td>
<td>(a-1)(b-1)</td>
<td>MSₑ</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RCBD ANOVA Table:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Source     SS    df     MS F_Statistic P_Value
       &lt;char&gt;  &lt;num&gt; &lt;num&gt;  &lt;num&gt;       &lt;num&gt;   &lt;num&gt;
1:   Coatings 191.16     3  63.72      7.7335  0.0039
2: Substrates 514.71     4 128.68     15.6170  0.0001
3:      Error  98.88    12   8.24          NA      NA
4:      Total 804.75    19     NA          NA      NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RCBD Test Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             Effect F_Statistic P_Value  Decision
             &lt;char&gt;       &lt;num&gt;   &lt;num&gt;    &lt;char&gt;
1:   Coating Effect      7.7335  0.0039 Reject H0
2: Substrate Effect     15.6170  0.0001 Reject H0
                             Conclusion
                                 &lt;char&gt;
1:   Coating means differ significantly
2: Substrate means differ significantly</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's RCBD ANOVA verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
coating      3  191.2   63.72   7.733 0.003871 ** 
substrate    4  514.7  128.68  15.617 0.000106 ***
Residuals   12   98.9    8.24                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="co"># RCBD ANOVA calculations</span></span>
<span id="cb88-2"><a href="#cb88-2"></a>a_rcbd <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(coating_data<span class="sc">$</span>coating))  <span class="co"># treatments</span></span>
<span id="cb88-3"><a href="#cb88-3"></a>b_rcbd <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(coating_data<span class="sc">$</span>substrate))  <span class="co"># blocks  </span></span>
<span id="cb88-4"><a href="#cb88-4"></a>N_rcbd <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(coating_data<span class="sc">$</span>adhesion)</span>
<span id="cb88-5"><a href="#cb88-5"></a></span>
<span id="cb88-6"><a href="#cb88-6"></a><span class="co"># Calculate sum of squares for RCBD</span></span>
<span id="cb88-7"><a href="#cb88-7"></a>grand_mean_rcbd <span class="ot">&lt;-</span> <span class="fu">fmean</span>(coating_data<span class="sc">$</span>adhesion)</span>
<span id="cb88-8"><a href="#cb88-8"></a></span>
<span id="cb88-9"><a href="#cb88-9"></a><span class="co"># Treatment sum of squares</span></span>
<span id="cb88-10"><a href="#cb88-10"></a>treatment_means <span class="ot">&lt;-</span> coating_summary<span class="sc">$</span>Mean</span>
<span id="cb88-11"><a href="#cb88-11"></a>SS_treatments_rcbd <span class="ot">&lt;-</span> b_rcbd <span class="sc">*</span> <span class="fu">sum</span>((treatment_means <span class="sc">-</span> grand_mean_rcbd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-12"><a href="#cb88-12"></a></span>
<span id="cb88-13"><a href="#cb88-13"></a><span class="co"># Block sum of squares  </span></span>
<span id="cb88-14"><a href="#cb88-14"></a>block_means <span class="ot">&lt;-</span> substrate_summary<span class="sc">$</span>Mean</span>
<span id="cb88-15"><a href="#cb88-15"></a>SS_blocks_rcbd <span class="ot">&lt;-</span> a_rcbd <span class="sc">*</span> <span class="fu">sum</span>((block_means <span class="sc">-</span> grand_mean_rcbd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-16"><a href="#cb88-16"></a></span>
<span id="cb88-17"><a href="#cb88-17"></a><span class="co"># Total sum of squares</span></span>
<span id="cb88-18"><a href="#cb88-18"></a>SS_total_rcbd <span class="ot">&lt;-</span> <span class="fu">sum</span>((coating_data<span class="sc">$</span>adhesion <span class="sc">-</span> grand_mean_rcbd)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-19"><a href="#cb88-19"></a></span>
<span id="cb88-20"><a href="#cb88-20"></a><span class="co"># Error sum of squares (by subtraction)</span></span>
<span id="cb88-21"><a href="#cb88-21"></a>SS_error_rcbd <span class="ot">&lt;-</span> SS_total_rcbd <span class="sc">-</span> SS_treatments_rcbd <span class="sc">-</span> SS_blocks_rcbd</span>
<span id="cb88-22"><a href="#cb88-22"></a></span>
<span id="cb88-23"><a href="#cb88-23"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb88-24"><a href="#cb88-24"></a>df_treatments_rcbd <span class="ot">&lt;-</span> a_rcbd <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb88-25"><a href="#cb88-25"></a>df_blocks_rcbd <span class="ot">&lt;-</span> b_rcbd <span class="sc">-</span> <span class="dv">1</span>  </span>
<span id="cb88-26"><a href="#cb88-26"></a>df_error_rcbd <span class="ot">&lt;-</span> (a_rcbd <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (b_rcbd <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb88-27"><a href="#cb88-27"></a>df_total_rcbd <span class="ot">&lt;-</span> N_rcbd <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb88-28"><a href="#cb88-28"></a></span>
<span id="cb88-29"><a href="#cb88-29"></a><span class="co"># Mean squares</span></span>
<span id="cb88-30"><a href="#cb88-30"></a>MS_treatments_rcbd <span class="ot">&lt;-</span> SS_treatments_rcbd <span class="sc">/</span> df_treatments_rcbd</span>
<span id="cb88-31"><a href="#cb88-31"></a>MS_blocks_rcbd <span class="ot">&lt;-</span> SS_blocks_rcbd <span class="sc">/</span> df_blocks_rcbd</span>
<span id="cb88-32"><a href="#cb88-32"></a>MS_error_rcbd <span class="ot">&lt;-</span> SS_error_rcbd <span class="sc">/</span> df_error_rcbd</span>
<span id="cb88-33"><a href="#cb88-33"></a></span>
<span id="cb88-34"><a href="#cb88-34"></a><span class="co"># F-statistics</span></span>
<span id="cb88-35"><a href="#cb88-35"></a>f_treatments_rcbd <span class="ot">&lt;-</span> MS_treatments_rcbd <span class="sc">/</span> MS_error_rcbd</span>
<span id="cb88-36"><a href="#cb88-36"></a>f_blocks_rcbd <span class="ot">&lt;-</span> MS_blocks_rcbd <span class="sc">/</span> MS_error_rcbd</span>
<span id="cb88-37"><a href="#cb88-37"></a></span>
<span id="cb88-38"><a href="#cb88-38"></a><span class="co"># P-values</span></span>
<span id="cb88-39"><a href="#cb88-39"></a>p_treatments_rcbd <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f_treatments_rcbd, df_treatments_rcbd, df_error_rcbd)</span>
<span id="cb88-40"><a href="#cb88-40"></a>p_blocks_rcbd <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(f_blocks_rcbd, df_blocks_rcbd, df_error_rcbd)</span>
<span id="cb88-41"><a href="#cb88-41"></a></span>
<span id="cb88-42"><a href="#cb88-42"></a><span class="co"># RCBD ANOVA table</span></span>
<span id="cb88-43"><a href="#cb88-43"></a>rcbd_anova_table <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb88-44"><a href="#cb88-44"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">"Coatings"</span>, <span class="st">"Substrates"</span>, <span class="st">"Error"</span>, <span class="st">"Total"</span>),</span>
<span id="cb88-45"><a href="#cb88-45"></a>  <span class="at">SS =</span> <span class="fu">c</span>(<span class="fu">round</span>(SS_treatments_rcbd, <span class="dv">2</span>), <span class="fu">round</span>(SS_blocks_rcbd, <span class="dv">2</span>), </span>
<span id="cb88-46"><a href="#cb88-46"></a>         <span class="fu">round</span>(SS_error_rcbd, <span class="dv">2</span>), <span class="fu">round</span>(SS_total_rcbd, <span class="dv">2</span>)),</span>
<span id="cb88-47"><a href="#cb88-47"></a>  <span class="at">df =</span> <span class="fu">c</span>(df_treatments_rcbd, df_blocks_rcbd, df_error_rcbd, df_total_rcbd),</span>
<span id="cb88-48"><a href="#cb88-48"></a>  <span class="at">MS =</span> <span class="fu">c</span>(<span class="fu">round</span>(MS_treatments_rcbd, <span class="dv">2</span>), <span class="fu">round</span>(MS_blocks_rcbd, <span class="dv">2</span>), </span>
<span id="cb88-49"><a href="#cb88-49"></a>         <span class="fu">round</span>(MS_error_rcbd, <span class="dv">2</span>), <span class="cn">NA</span>),</span>
<span id="cb88-50"><a href="#cb88-50"></a>  <span class="at">F_Statistic =</span> <span class="fu">c</span>(<span class="fu">round</span>(f_treatments_rcbd, <span class="dv">4</span>), <span class="fu">round</span>(f_blocks_rcbd, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb88-51"><a href="#cb88-51"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(p_treatments_rcbd, <span class="dv">4</span>), <span class="fu">round</span>(p_blocks_rcbd, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb88-52"><a href="#cb88-52"></a>)</span>
<span id="cb88-53"><a href="#cb88-53"></a></span>
<span id="cb88-54"><a href="#cb88-54"></a><span class="fu">print</span>(<span class="st">"RCBD ANOVA Table:"</span>)</span>
<span id="cb88-55"><a href="#cb88-55"></a><span class="fu">print</span>(rcbd_anova_table)</span>
<span id="cb88-56"><a href="#cb88-56"></a></span>
<span id="cb88-57"><a href="#cb88-57"></a><span class="co"># RCBD conclusions</span></span>
<span id="cb88-58"><a href="#cb88-58"></a>rcbd_conclusions <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb88-59"><a href="#cb88-59"></a>  <span class="at">Effect =</span> <span class="fu">c</span>(<span class="st">"Coating Effect"</span>, <span class="st">"Substrate Effect"</span>),</span>
<span id="cb88-60"><a href="#cb88-60"></a>  <span class="at">F_Statistic =</span> <span class="fu">c</span>(<span class="fu">round</span>(f_treatments_rcbd, <span class="dv">4</span>), <span class="fu">round</span>(f_blocks_rcbd, <span class="dv">4</span>)),</span>
<span id="cb88-61"><a href="#cb88-61"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(p_treatments_rcbd, <span class="dv">4</span>), <span class="fu">round</span>(p_blocks_rcbd, <span class="dv">4</span>)),</span>
<span id="cb88-62"><a href="#cb88-62"></a>  <span class="at">Decision =</span> <span class="fu">c</span>(</span>
<span id="cb88-63"><a href="#cb88-63"></a>    <span class="fu">ifelse</span>(p_treatments_rcbd <span class="sc">&lt;</span> alpha_anova, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>),</span>
<span id="cb88-64"><a href="#cb88-64"></a>    <span class="fu">ifelse</span>(p_blocks_rcbd <span class="sc">&lt;</span> alpha_anova, <span class="st">"Reject H0"</span>, <span class="st">"Fail to reject H0"</span>)</span>
<span id="cb88-65"><a href="#cb88-65"></a>  ),</span>
<span id="cb88-66"><a href="#cb88-66"></a>  <span class="at">Conclusion =</span> <span class="fu">c</span>(</span>
<span id="cb88-67"><a href="#cb88-67"></a>    <span class="fu">ifelse</span>(p_treatments_rcbd <span class="sc">&lt;</span> alpha_anova, <span class="st">"Coating means differ significantly"</span>, <span class="st">"No significant coating effect"</span>),</span>
<span id="cb88-68"><a href="#cb88-68"></a>    <span class="fu">ifelse</span>(p_blocks_rcbd <span class="sc">&lt;</span> alpha_anova, <span class="st">"Substrate means differ significantly"</span>, <span class="st">"No significant substrate effect"</span>)</span>
<span id="cb88-69"><a href="#cb88-69"></a>  )</span>
<span id="cb88-70"><a href="#cb88-70"></a>)</span>
<span id="cb88-71"><a href="#cb88-71"></a></span>
<span id="cb88-72"><a href="#cb88-72"></a><span class="fu">print</span>(<span class="st">"RCBD Test Results:"</span>)</span>
<span id="cb88-73"><a href="#cb88-73"></a><span class="fu">print</span>(rcbd_conclusions)</span>
<span id="cb88-74"><a href="#cb88-74"></a></span>
<span id="cb88-75"><a href="#cb88-75"></a><span class="co"># Using R's aov for verification</span></span>
<span id="cb88-76"><a href="#cb88-76"></a>rcbd_r <span class="ot">&lt;-</span> <span class="fu">aov</span>(adhesion <span class="sc">~</span> coating <span class="sc">+</span> substrate, <span class="at">data =</span> coating_data)</span>
<span id="cb88-77"><a href="#cb88-77"></a>rcbd_summary_r <span class="ot">&lt;-</span> <span class="fu">summary</span>(rcbd_r)</span>
<span id="cb88-78"><a href="#cb88-78"></a><span class="fu">print</span>(<span class="st">"R's RCBD ANOVA verification:"</span>)</span>
<span id="cb88-79"><a href="#cb88-79"></a><span class="fu">print</span>(rcbd_summary_r)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch05Code04" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch05Code04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch05_files/figure-html/fig-Ch05Code04-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Randomized complete block design visualization"><img src="Ch05_files/figure-html/fig-Ch05Code04-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch05Code04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Randomized complete block design visualization
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="co"># RCBD visualization</span></span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="co"># Interaction plot</span></span>
<span id="cb89-3"><a href="#cb89-3"></a>interaction_plot_data <span class="ot">&lt;-</span> coating_data <span class="sc">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4"></a>  <span class="fu">fgroup_by</span>(coating, substrate) <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5"></a>  <span class="fu">fsummarise</span>(<span class="at">mean_adhesion =</span> <span class="fu">fmean</span>(adhesion))</span>
<span id="cb89-6"><a href="#cb89-6"></a></span>
<span id="cb89-7"><a href="#cb89-7"></a>p1_rcbd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> interaction_plot_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> coating, <span class="at">y =</span> mean_adhesion, </span>
<span id="cb89-8"><a href="#cb89-8"></a>                                                             <span class="at">color =</span> substrate, <span class="at">group =</span> substrate)) <span class="sc">+</span></span>
<span id="cb89-9"><a href="#cb89-9"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb89-10"><a href="#cb89-10"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb89-11"><a href="#cb89-11"></a>  <span class="fu">labs</span>(</span>
<span id="cb89-12"><a href="#cb89-12"></a>    <span class="at">x =</span> <span class="st">"Coating Type"</span>,</span>
<span id="cb89-13"><a href="#cb89-13"></a>    <span class="at">y =</span> <span class="st">"Mean Adhesion"</span>,</span>
<span id="cb89-14"><a href="#cb89-14"></a>    <span class="at">color =</span> <span class="st">"Substrate"</span>,</span>
<span id="cb89-15"><a href="#cb89-15"></a>    <span class="at">title =</span> <span class="st">"Interaction Plot: Coating × Substrate"</span></span>
<span id="cb89-16"><a href="#cb89-16"></a>  ) <span class="sc">+</span></span>
<span id="cb89-17"><a href="#cb89-17"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb89-18"><a href="#cb89-18"></a>  <span class="fu">theme</span>(</span>
<span id="cb89-19"><a href="#cb89-19"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb89-20"><a href="#cb89-20"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb89-21"><a href="#cb89-21"></a>  )</span>
<span id="cb89-22"><a href="#cb89-22"></a></span>
<span id="cb89-23"><a href="#cb89-23"></a><span class="co"># Box plot by coating with substrate grouping</span></span>
<span id="cb89-24"><a href="#cb89-24"></a>p2_rcbd <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> coating_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> coating, <span class="at">y =</span> adhesion, <span class="at">fill =</span> substrate)) <span class="sc">+</span></span>
<span id="cb89-25"><a href="#cb89-25"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb89-26"><a href="#cb89-26"></a>  <span class="fu">labs</span>(</span>
<span id="cb89-27"><a href="#cb89-27"></a>    <span class="at">x =</span> <span class="st">"Coating Type"</span>,</span>
<span id="cb89-28"><a href="#cb89-28"></a>    <span class="at">y =</span> <span class="st">"Adhesion"</span>,</span>
<span id="cb89-29"><a href="#cb89-29"></a>    <span class="at">fill =</span> <span class="st">"Substrate"</span>,</span>
<span id="cb89-30"><a href="#cb89-30"></a>    <span class="at">title =</span> <span class="st">"Adhesion by Coating and Substrate"</span></span>
<span id="cb89-31"><a href="#cb89-31"></a>  ) <span class="sc">+</span></span>
<span id="cb89-32"><a href="#cb89-32"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb89-33"><a href="#cb89-33"></a>  <span class="fu">theme</span>(</span>
<span id="cb89-34"><a href="#cb89-34"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb89-35"><a href="#cb89-35"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb89-36"><a href="#cb89-36"></a>  )</span>
<span id="cb89-37"><a href="#cb89-37"></a></span>
<span id="cb89-38"><a href="#cb89-38"></a><span class="co"># Combine plots</span></span>
<span id="cb89-39"><a href="#cb89-39"></a><span class="fu">grid.arrange</span>(p1_rcbd, p2_rcbd, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="comprehensive-example-quality-improvement-study" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="comprehensive-example-quality-improvement-study"><span class="header-section-number">1.9</span> Comprehensive Example: Quality Improvement Study</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Comprehensive Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A manufacturing company conducts a comprehensive quality study comparing two suppliers, testing before/after process improvements, and evaluating multiple quality metrics:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false"></a><a href="data/comprehensive_quality.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Comprehensive Quality Study Summary by Supplier:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     supplier     n Mean_Before Mean_After Mean_Improvement SD_Before SD_After
       &lt;char&gt; &lt;int&gt;       &lt;num&gt;      &lt;num&gt;            &lt;num&gt;     &lt;num&gt;    &lt;num&gt;
1: Supplier_A    30    83.49488   92.93163         9.436750  8.242329 5.746158
2: Supplier_B    30    82.31349   87.60750         5.294008 11.587749 8.813704
   SD_Improvement Defect_Rate_Before Defect_Rate_After Var_Before Var_After
            &lt;num&gt;              &lt;num&gt;             &lt;num&gt;      &lt;num&gt;     &lt;num&gt;
1:       12.23185         0.16666667        0.00000000   67.93598  33.01834
2:       15.98305         0.06666667        0.03333333  134.27592  77.68137</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Overall Quality Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Total_n Overall_Mean_Before Overall_Mean_After Overall_Improvement
     &lt;int&gt;               &lt;num&gt;              &lt;num&gt;               &lt;num&gt;
1:      60            82.90418           90.26956            7.365379
   Overall_Defect_Before Overall_Defect_After
                   &lt;num&gt;                &lt;num&gt;
1:             0.1166667           0.01666667</code></pre>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co"># Comprehensive quality improvement study</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb94-3"><a href="#cb94-3"></a>comprehensive_quality_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb94-4"><a href="#cb94-4"></a>  <span class="at">part_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>,</span>
<span id="cb94-5"><a href="#cb94-5"></a>  <span class="at">supplier =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Supplier_A"</span>, <span class="st">"Supplier_B"</span>), <span class="at">each =</span> <span class="dv">30</span>),</span>
<span id="cb94-6"><a href="#cb94-6"></a>  <span class="at">before_improvement =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">85</span>, <span class="at">sd =</span> <span class="dv">8</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">82</span>, <span class="at">sd =</span> <span class="dv">9</span>)),</span>
<span id="cb94-7"><a href="#cb94-7"></a>  <span class="at">after_improvement =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">92</span>, <span class="at">sd =</span> <span class="dv">7</span>), <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">88</span>, <span class="at">sd =</span> <span class="dv">8</span>)),</span>
<span id="cb94-8"><a href="#cb94-8"></a>  <span class="at">defective_before =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">60</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.88</span>, <span class="fl">0.12</span>)),</span>
<span id="cb94-9"><a href="#cb94-9"></a>  <span class="at">defective_after =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">60</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.94</span>, <span class="fl">0.06</span>))</span>
<span id="cb94-10"><a href="#cb94-10"></a>)</span>
<span id="cb94-11"><a href="#cb94-11"></a></span>
<span id="cb94-12"><a href="#cb94-12"></a><span class="co"># Calculate improvements</span></span>
<span id="cb94-13"><a href="#cb94-13"></a>comprehensive_quality_data[, improvement <span class="sc">:</span><span class="er">=</span> after_improvement <span class="sc">-</span> before_improvement]</span>
<span id="cb94-14"><a href="#cb94-14"></a></span>
<span id="cb94-15"><a href="#cb94-15"></a><span class="co"># Comprehensive summary</span></span>
<span id="cb94-16"><a href="#cb94-16"></a>quality_comprehensive_summary <span class="ot">&lt;-</span> comprehensive_quality_data <span class="sc">%&gt;%</span> </span>
<span id="cb94-17"><a href="#cb94-17"></a>  <span class="fu">fgroup_by</span>(supplier) <span class="sc">%&gt;%</span> </span>
<span id="cb94-18"><a href="#cb94-18"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb94-19"><a href="#cb94-19"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(part_id),</span>
<span id="cb94-20"><a href="#cb94-20"></a>    <span class="co"># Before/After means</span></span>
<span id="cb94-21"><a href="#cb94-21"></a>    <span class="at">Mean_Before =</span> <span class="fu">fmean</span>(before_improvement),</span>
<span id="cb94-22"><a href="#cb94-22"></a>    <span class="at">Mean_After =</span> <span class="fu">fmean</span>(after_improvement),</span>
<span id="cb94-23"><a href="#cb94-23"></a>    <span class="at">Mean_Improvement =</span> <span class="fu">fmean</span>(improvement),</span>
<span id="cb94-24"><a href="#cb94-24"></a>    <span class="co"># Standard deviations</span></span>
<span id="cb94-25"><a href="#cb94-25"></a>    <span class="at">SD_Before =</span> <span class="fu">fsd</span>(before_improvement),</span>
<span id="cb94-26"><a href="#cb94-26"></a>    <span class="at">SD_After =</span> <span class="fu">fsd</span>(after_improvement),</span>
<span id="cb94-27"><a href="#cb94-27"></a>    <span class="at">SD_Improvement =</span> <span class="fu">fsd</span>(improvement),</span>
<span id="cb94-28"><a href="#cb94-28"></a>    <span class="co"># Defect rates</span></span>
<span id="cb94-29"><a href="#cb94-29"></a>    <span class="at">Defect_Rate_Before =</span> <span class="fu">fmean</span>(defective_before),</span>
<span id="cb94-30"><a href="#cb94-30"></a>    <span class="at">Defect_Rate_After =</span> <span class="fu">fmean</span>(defective_after),</span>
<span id="cb94-31"><a href="#cb94-31"></a>    <span class="co"># Variance comparison</span></span>
<span id="cb94-32"><a href="#cb94-32"></a>    <span class="at">Var_Before =</span> <span class="fu">fvar</span>(before_improvement),</span>
<span id="cb94-33"><a href="#cb94-33"></a>    <span class="at">Var_After =</span> <span class="fu">fvar</span>(after_improvement)</span>
<span id="cb94-34"><a href="#cb94-34"></a>  )</span>
<span id="cb94-35"><a href="#cb94-35"></a></span>
<span id="cb94-36"><a href="#cb94-36"></a><span class="fu">print</span>(<span class="st">"Comprehensive Quality Study Summary by Supplier:"</span>)</span>
<span id="cb94-37"><a href="#cb94-37"></a><span class="fu">print</span>(quality_comprehensive_summary)</span>
<span id="cb94-38"><a href="#cb94-38"></a></span>
<span id="cb94-39"><a href="#cb94-39"></a><span class="co"># Overall summary</span></span>
<span id="cb94-40"><a href="#cb94-40"></a>overall_quality_summary <span class="ot">&lt;-</span> comprehensive_quality_data <span class="sc">%&gt;%</span> </span>
<span id="cb94-41"><a href="#cb94-41"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb94-42"><a href="#cb94-42"></a>    <span class="at">Total_n =</span> <span class="fu">fnobs</span>(part_id),</span>
<span id="cb94-43"><a href="#cb94-43"></a>    <span class="at">Overall_Mean_Before =</span> <span class="fu">fmean</span>(before_improvement),</span>
<span id="cb94-44"><a href="#cb94-44"></a>    <span class="at">Overall_Mean_After =</span> <span class="fu">fmean</span>(after_improvement),</span>
<span id="cb94-45"><a href="#cb94-45"></a>    <span class="at">Overall_Improvement =</span> <span class="fu">fmean</span>(improvement),</span>
<span id="cb94-46"><a href="#cb94-46"></a>    <span class="at">Overall_Defect_Before =</span> <span class="fu">fmean</span>(defective_before),</span>
<span id="cb94-47"><a href="#cb94-47"></a>    <span class="at">Overall_Defect_After =</span> <span class="fu">fmean</span>(defective_after)</span>
<span id="cb94-48"><a href="#cb94-48"></a>  )</span>
<span id="cb94-49"><a href="#cb94-49"></a></span>
<span id="cb94-50"><a href="#cb94-50"></a><span class="fu">print</span>(<span class="st">"Overall Quality Summary:"</span>)</span>
<span id="cb94-51"><a href="#cb94-51"></a><span class="fu">print</span>(overall_quality_summary)</span>
<span id="cb94-52"><a href="#cb94-52"></a></span>
<span id="cb94-53"><a href="#cb94-53"></a><span class="co"># Write data to CSV for download</span></span>
<span id="cb94-54"><a href="#cb94-54"></a><span class="fu">fwrite</span>(comprehensive_quality_data, <span class="st">"data/comprehensive_quality.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">

</div>
</div>
</div>
<p><strong>Complete Analysis:</strong></p>
<ol type="1">
<li><p>Compare supplier means (independent samples)</p></li>
<li><p>Test variance equality between suppliers</p></li>
<li><p>Before/after comparison (paired test)</p></li>
<li><p>Compare defect proportions</p></li>
<li><p>Multi-factor ANOVA</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<div class="cell-output cell-output-error">
<pre><code>Error in select(., part_id, supplier, before_improvement, after_improvement): could not find function "select"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'before_after_long' not found</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in select(., supplier, before_improvement, after_improvement): could not find function "select"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'variance_data' not found</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in select(., supplier, Rate_Before, Rate_After): could not find function "select"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'defect_summary_comp' not found</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error: object 'p2_comp' not found</code></pre>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># Comprehensive quality analysis dashboard</span></span>
<span id="cb102-2"><a href="#cb102-2"></a></span>
<span id="cb102-3"><a href="#cb102-3"></a><span class="co"># 1. Supplier comparison (before improvement)</span></span>
<span id="cb102-4"><a href="#cb102-4"></a>p1_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> comprehensive_quality_data, </span>
<span id="cb102-5"><a href="#cb102-5"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> supplier, <span class="at">y =</span> before_improvement, <span class="at">fill =</span> supplier)) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb102-7"><a href="#cb102-7"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb102-8"><a href="#cb102-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Supplier"</span>, <span class="at">y =</span> <span class="st">"Quality Score"</span>, <span class="at">title =</span> <span class="st">"Quality Before Improvement"</span>) <span class="sc">+</span></span>
<span id="cb102-9"><a href="#cb102-9"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb102-10"><a href="#cb102-10"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb102-11"><a href="#cb102-11"></a></span>
<span id="cb102-12"><a href="#cb102-12"></a><span class="co"># 2. Before/After comparison (paired)</span></span>
<span id="cb102-13"><a href="#cb102-13"></a>before_after_long <span class="ot">&lt;-</span> comprehensive_quality_data <span class="sc">%&gt;%</span></span>
<span id="cb102-14"><a href="#cb102-14"></a>  <span class="fu">select</span>(part_id, supplier, before_improvement, after_improvement) <span class="sc">%&gt;%</span></span>
<span id="cb102-15"><a href="#cb102-15"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(before_improvement, after_improvement), </span>
<span id="cb102-16"><a href="#cb102-16"></a>               <span class="at">names_to =</span> <span class="st">"period"</span>, <span class="at">values_to =</span> <span class="st">"quality"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-17"><a href="#cb102-17"></a>  <span class="fu">data.table</span>()</span>
<span id="cb102-18"><a href="#cb102-18"></a></span>
<span id="cb102-19"><a href="#cb102-19"></a>p2_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> before_after_long, </span>
<span id="cb102-20"><a href="#cb102-20"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> period, <span class="at">y =</span> quality, <span class="at">group =</span> part_id)) <span class="sc">+</span></span>
<span id="cb102-21"><a href="#cb102-21"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb102-22"><a href="#cb102-22"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> period), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb102-23"><a href="#cb102-23"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>supplier) <span class="sc">+</span></span>
<span id="cb102-24"><a href="#cb102-24"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Period"</span>, <span class="at">y =</span> <span class="st">"Quality Score"</span>, <span class="at">title =</span> <span class="st">"Before/After Comparison by Supplier"</span>) <span class="sc">+</span></span>
<span id="cb102-25"><a href="#cb102-25"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb102-26"><a href="#cb102-26"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb102-27"><a href="#cb102-27"></a></span>
<span id="cb102-28"><a href="#cb102-28"></a><span class="co"># 3. Variance comparison</span></span>
<span id="cb102-29"><a href="#cb102-29"></a>variance_data <span class="ot">&lt;-</span> comprehensive_quality_data <span class="sc">%&gt;%</span></span>
<span id="cb102-30"><a href="#cb102-30"></a>  <span class="fu">select</span>(supplier, before_improvement, after_improvement) <span class="sc">%&gt;%</span></span>
<span id="cb102-31"><a href="#cb102-31"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(before_improvement, after_improvement),</span>
<span id="cb102-32"><a href="#cb102-32"></a>               <span class="at">names_to =</span> <span class="st">"period"</span>, <span class="at">values_to =</span> <span class="st">"quality"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-33"><a href="#cb102-33"></a>  <span class="fu">data.table</span>()</span>
<span id="cb102-34"><a href="#cb102-34"></a></span>
<span id="cb102-35"><a href="#cb102-35"></a>p3_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> variance_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> quality, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb102-36"><a href="#cb102-36"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb102-37"><a href="#cb102-37"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>supplier) <span class="sc">+</span></span>
<span id="cb102-38"><a href="#cb102-38"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Quality Score"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">title =</span> <span class="st">"Distribution Comparison"</span>, <span class="at">fill =</span> <span class="st">"Period"</span>) <span class="sc">+</span></span>
<span id="cb102-39"><a href="#cb102-39"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb102-40"><a href="#cb102-40"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb102-41"><a href="#cb102-41"></a></span>
<span id="cb102-42"><a href="#cb102-42"></a><span class="co"># 4. Defect rate comparison</span></span>
<span id="cb102-43"><a href="#cb102-43"></a>defect_summary_comp <span class="ot">&lt;-</span> comprehensive_quality_data <span class="sc">%&gt;%</span></span>
<span id="cb102-44"><a href="#cb102-44"></a>  <span class="fu">fgroup_by</span>(supplier) <span class="sc">%&gt;%</span></span>
<span id="cb102-45"><a href="#cb102-45"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb102-46"><a href="#cb102-46"></a>    <span class="at">Before =</span> <span class="fu">fsum</span>(defective_before),</span>
<span id="cb102-47"><a href="#cb102-47"></a>    <span class="at">After =</span> <span class="fu">fsum</span>(defective_after),</span>
<span id="cb102-48"><a href="#cb102-48"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(part_id)</span>
<span id="cb102-49"><a href="#cb102-49"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb102-50"><a href="#cb102-50"></a>  <span class="fu">mutate</span>(</span>
<span id="cb102-51"><a href="#cb102-51"></a>    <span class="at">Rate_Before =</span> Before <span class="sc">/</span> n,</span>
<span id="cb102-52"><a href="#cb102-52"></a>    <span class="at">Rate_After =</span> After <span class="sc">/</span> n</span>
<span id="cb102-53"><a href="#cb102-53"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb102-54"><a href="#cb102-54"></a>  <span class="fu">select</span>(supplier, Rate_Before, Rate_After) <span class="sc">%&gt;%</span></span>
<span id="cb102-55"><a href="#cb102-55"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Rate_Before, Rate_After), <span class="at">names_to =</span> <span class="st">"period"</span>, <span class="at">values_to =</span> <span class="st">"rate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb102-56"><a href="#cb102-56"></a>  <span class="fu">data.table</span>()</span>
<span id="cb102-57"><a href="#cb102-57"></a></span>
<span id="cb102-58"><a href="#cb102-58"></a>p4_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> defect_summary_comp, </span>
<span id="cb102-59"><a href="#cb102-59"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> supplier, <span class="at">y =</span> rate, <span class="at">fill =</span> period)) <span class="sc">+</span></span>
<span id="cb102-60"><a href="#cb102-60"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb102-61"><a href="#cb102-61"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Supplier"</span>, <span class="at">y =</span> <span class="st">"Defect Rate"</span>, <span class="at">title =</span> <span class="st">"Defect Rate Comparison"</span>, <span class="at">fill =</span> <span class="st">"Period"</span>) <span class="sc">+</span></span>
<span id="cb102-62"><a href="#cb102-62"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb102-63"><a href="#cb102-63"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb102-64"><a href="#cb102-64"></a></span>
<span id="cb102-65"><a href="#cb102-65"></a><span class="co"># Combine all plots</span></span>
<span id="cb102-66"><a href="#cb102-66"></a><span class="fu">grid.arrange</span>(p1_comp, p2_comp, p3_comp, p4_comp, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="key-formulas-and-decision-framework" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="key-formulas-and-decision-framework"><span class="header-section-number">1.10</span> Key Formulas and Decision Framework</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Essential Formulas Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Two-Sample Z-Test (σ known):</strong></p>
<p><span class="math display">Z_0 = \frac{(\overline{X_1} - \overline{X_2}) - (\mu_1 - \mu_2)}{\sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}}</span></p>
<p><strong>Two-Sample t-Test (σ unknown, equal variances):</strong></p>
<p><span class="math display">T_0 = \frac{\overline{X_1} - \overline{X_2}}{S_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}</span></p>
<p><strong>Paired t-Test:</strong></p>
<p><span class="math display">T_0 = \frac{\overline{d} - \mu_d}{S_d/\sqrt{n}}</span></p>
<p><strong>F-Test for Variances:</strong></p>
<p><span class="math display">F_0 = \frac{S_1^2}{S_2^2}</span></p>
<p><strong>Two-Proportion Z-Test:</strong></p>
<p><span class="math display">Z_0 = \frac{\hat{p_1} - \hat{p_2}}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{n_1} + \frac{1}{n_2})}}</span></p>
<p><strong>One-Way ANOVA:</strong></p>
<p><span class="math display">F_0 = \frac{MS_{Treatments}}{MS_{Error}}</span></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell">
<div id="tbl-Ch05Code02" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Ch05Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Decision framework for choosing appropriate test
</figcaption>
<div aria-describedby="tbl-Ch05Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small">
<caption>Decision Framework for Choosing Appropriate Two-Sample Test</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Situation</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Test_Method</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Key_Assumptions</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">When_to_Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Two independent groups, σ known</td>
<td style="text-align: left; width: 2.5cm;">Two-sample Z-test</td>
<td style="text-align: left; width: 3cm;">Normal populations, σ₁, σ₂ known</td>
<td style="text-align: left; width: 3cm;">Population SDs known from historical data</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3cm;">Two independent groups, σ unknown, equal variances</td>
<td style="text-align: left; width: 2.5cm;">Two-sample t-test (pooled)</td>
<td style="text-align: left; width: 3cm;">Normal populations, σ₁² = σ₂²</td>
<td style="text-align: left; width: 3cm;">Most common two-sample situation</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Two independent groups, σ unknown, unequal variances</td>
<td style="text-align: left; width: 2.5cm;">Welch's t-test</td>
<td style="text-align: left; width: 3cm;">Normal populations</td>
<td style="text-align: left; width: 3cm;">When variances clearly unequal</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3cm;">Paired/matched observations</td>
<td style="text-align: left; width: 2.5cm;">Paired t-test</td>
<td style="text-align: left; width: 3cm;">Normal differences</td>
<td style="text-align: left; width: 3cm;">Before/after, matched pairs</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Compare two variances</td>
<td style="text-align: left; width: 2.5cm;">F-test</td>
<td style="text-align: left; width: 3cm;">Normal populations</td>
<td style="text-align: left; width: 3cm;">Check equal variance assumption</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3cm;">Compare two proportions</td>
<td style="text-align: left; width: 2.5cm;">Two-proportion Z-test</td>
<td style="text-align: left; width: 3cm;">Large samples</td>
<td style="text-align: left; width: 3cm;">Compare success rates</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 3cm;">Compare more than two groups</td>
<td style="text-align: left; width: 2.5cm;">One-way ANOVA</td>
<td style="text-align: left; width: 3cm;">Normal populations, equal variances</td>
<td style="text-align: left; width: 3cm;">Multiple groups to compare</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 3cm;">Compare groups with blocking</td>
<td style="text-align: left; width: 2.5cm;">RCBD ANOVA</td>
<td style="text-align: left; width: 3cm;">Normal populations, additive model</td>
<td style="text-align: left; width: 3cm;">Control for known nuisance factors</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div id="tbl-Ch05Code02" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-Ch05Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4
</figcaption>
<div aria-describedby="tbl-Ch05Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co"># Decision framework for choosing appropriate test</span></span>
<span id="cb103-2"><a href="#cb103-2"></a>decision_framework <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="at">Situation =</span> <span class="fu">c</span>(<span class="st">"Two independent groups, σ known"</span>, <span class="st">"Two independent groups, σ unknown, equal variances"</span>,</span>
<span id="cb103-4"><a href="#cb103-4"></a>               <span class="st">"Two independent groups, σ unknown, unequal variances"</span>, <span class="st">"Paired/matched observations"</span>,</span>
<span id="cb103-5"><a href="#cb103-5"></a>               <span class="st">"Compare two variances"</span>, <span class="st">"Compare two proportions"</span>,</span>
<span id="cb103-6"><a href="#cb103-6"></a>               <span class="st">"Compare more than two groups"</span>, <span class="st">"Compare groups with blocking"</span>),</span>
<span id="cb103-7"><a href="#cb103-7"></a>  <span class="at">Test_Method =</span> <span class="fu">c</span>(<span class="st">"Two-sample Z-test"</span>, <span class="st">"Two-sample t-test (pooled)"</span>, </span>
<span id="cb103-8"><a href="#cb103-8"></a>                 <span class="st">"Welch's t-test"</span>, <span class="st">"Paired t-test"</span>,</span>
<span id="cb103-9"><a href="#cb103-9"></a>                 <span class="st">"F-test"</span>, <span class="st">"Two-proportion Z-test"</span>,</span>
<span id="cb103-10"><a href="#cb103-10"></a>                 <span class="st">"One-way ANOVA"</span>, <span class="st">"RCBD ANOVA"</span>),</span>
<span id="cb103-11"><a href="#cb103-11"></a>  <span class="at">Key_Assumptions =</span> <span class="fu">c</span>(<span class="st">"Normal populations, σ₁, σ₂ known"</span>, <span class="st">"Normal populations, σ₁² = σ₂²"</span>,</span>
<span id="cb103-12"><a href="#cb103-12"></a>                     <span class="st">"Normal populations"</span>, <span class="st">"Normal differences"</span>,</span>
<span id="cb103-13"><a href="#cb103-13"></a>                     <span class="st">"Normal populations"</span>, <span class="st">"Large samples"</span>,</span>
<span id="cb103-14"><a href="#cb103-14"></a>                     <span class="st">"Normal populations, equal variances"</span>, <span class="st">"Normal populations, additive model"</span>),</span>
<span id="cb103-15"><a href="#cb103-15"></a>  <span class="at">When_to_Use =</span> <span class="fu">c</span>(<span class="st">"Population SDs known from historical data"</span>, <span class="st">"Most common two-sample situation"</span>,</span>
<span id="cb103-16"><a href="#cb103-16"></a>                 <span class="st">"When variances clearly unequal"</span>, <span class="st">"Before/after, matched pairs"</span>,</span>
<span id="cb103-17"><a href="#cb103-17"></a>                 <span class="st">"Check equal variance assumption"</span>, <span class="st">"Compare success rates"</span>,</span>
<span id="cb103-18"><a href="#cb103-18"></a>                 <span class="st">"Multiple groups to compare"</span>, <span class="st">"Control for known nuisance factors"</span>)</span>
<span id="cb103-19"><a href="#cb103-19"></a>)</span>
<span id="cb103-20"><a href="#cb103-20"></a></span>
<span id="cb103-21"><a href="#cb103-21"></a><span class="fu">kbl</span>(decision_framework, </span>
<span id="cb103-22"><a href="#cb103-22"></a>    <span class="at">caption =</span> <span class="st">"Decision Framework for Choosing Appropriate Two-Sample Test"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-23"><a href="#cb103-23"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-24"><a href="#cb103-24"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"3cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-25"><a href="#cb103-25"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"2.5cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-26"><a href="#cb103-26"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"3cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-27"><a href="#cb103-27"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">width =</span> <span class="st">"3cm"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="sample-size-and-power-analysis" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="sample-size-and-power-analysis"><span class="header-section-number">1.11</span> Sample Size and Power Analysis</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sample Size Requirements for Two-Sample Tests:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>             Test_Type Alpha Power      Effect_Size Required_n_per_group
                &lt;char&gt; &lt;num&gt; &lt;num&gt;           &lt;char&gt;                &lt;num&gt;
1:   Two-sample t-test  0.05   0.8        δ=5, σ=10                   63
2:   Two-sample t-test  0.05   0.8        δ=3, σ=10                  175
3:   Two-sample t-test  0.05   0.8        δ=1, σ=10                 1570
4: Two-proportion test  0.05   0.8   p₁=0.2, p₂=0.3                  294
5: Two-proportion test  0.05   0.8  p₁=0.1, p₂=0.15                  686
6: Two-proportion test  0.05   0.8 p₁=0.05, p₂=0.10                  435</code></pre>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="co"># Sample size determination for various two-sample tests</span></span>
<span id="cb106-2"><a href="#cb106-2"></a></span>
<span id="cb106-3"><a href="#cb106-3"></a><span class="co"># Function for two-sample t-test sample size</span></span>
<span id="cb106-4"><a href="#cb106-4"></a>sample_size_two_sample_t <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, beta, delta, sigma_pooled) {</span>
<span id="cb106-5"><a href="#cb106-5"></a>  t_alpha2 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="cn">Inf</span>)  <span class="co"># Use normal approximation for large samples</span></span>
<span id="cb106-6"><a href="#cb106-6"></a>  t_beta <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> beta, <span class="at">df =</span> <span class="cn">Inf</span>)</span>
<span id="cb106-7"><a href="#cb106-7"></a>  n <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> ((t_alpha2 <span class="sc">+</span> t_beta) <span class="sc">*</span> sigma_pooled <span class="sc">/</span> delta)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb106-8"><a href="#cb106-8"></a>  <span class="fu">return</span>(<span class="fu">ceiling</span>(n))</span>
<span id="cb106-9"><a href="#cb106-9"></a>}</span>
<span id="cb106-10"><a href="#cb106-10"></a></span>
<span id="cb106-11"><a href="#cb106-11"></a><span class="co"># Function for two-proportion test sample size</span></span>
<span id="cb106-12"><a href="#cb106-12"></a>sample_size_two_prop <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha, beta, p1, p2) {</span>
<span id="cb106-13"><a href="#cb106-13"></a>  z_alpha2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb106-14"><a href="#cb106-14"></a>  z_beta <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> beta)</span>
<span id="cb106-15"><a href="#cb106-15"></a>  p_bar <span class="ot">&lt;-</span> (p1 <span class="sc">+</span> p2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb106-16"><a href="#cb106-16"></a>  delta <span class="ot">&lt;-</span> <span class="fu">abs</span>(p1 <span class="sc">-</span> p2)</span>
<span id="cb106-17"><a href="#cb106-17"></a>  </span>
<span id="cb106-18"><a href="#cb106-18"></a>  n <span class="ot">&lt;-</span> (z_alpha2 <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> p_bar <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_bar)) <span class="sc">+</span> z_beta <span class="sc">*</span> <span class="fu">sqrt</span>(p1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">+</span> p2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2)))<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> delta<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb106-19"><a href="#cb106-19"></a>  <span class="fu">return</span>(<span class="fu">ceiling</span>(n))</span>
<span id="cb106-20"><a href="#cb106-20"></a>}</span>
<span id="cb106-21"><a href="#cb106-21"></a></span>
<span id="cb106-22"><a href="#cb106-22"></a><span class="co"># Sample size examples</span></span>
<span id="cb106-23"><a href="#cb106-23"></a>sample_size_examples <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb106-24"><a href="#cb106-24"></a>  <span class="at">Test_Type =</span> <span class="fu">c</span>(<span class="st">"Two-sample t-test"</span>, <span class="st">"Two-sample t-test"</span>, <span class="st">"Two-sample t-test"</span>,</span>
<span id="cb106-25"><a href="#cb106-25"></a>               <span class="st">"Two-proportion test"</span>, <span class="st">"Two-proportion test"</span>, <span class="st">"Two-proportion test"</span>),</span>
<span id="cb106-26"><a href="#cb106-26"></a>  <span class="at">Alpha =</span> <span class="fu">rep</span>(<span class="fl">0.05</span>, <span class="dv">6</span>),</span>
<span id="cb106-27"><a href="#cb106-27"></a>  <span class="at">Power =</span> <span class="fu">rep</span>(<span class="fl">0.80</span>, <span class="dv">6</span>),</span>
<span id="cb106-28"><a href="#cb106-28"></a>  <span class="at">Effect_Size =</span> <span class="fu">c</span>(<span class="st">"δ=5, σ=10"</span>, <span class="st">"δ=3, σ=10"</span>, <span class="st">"δ=1, σ=10"</span>,</span>
<span id="cb106-29"><a href="#cb106-29"></a>                 <span class="st">"p₁=0.2, p₂=0.3"</span>, <span class="st">"p₁=0.1, p₂=0.15"</span>, <span class="st">"p₁=0.05, p₂=0.10"</span>),</span>
<span id="cb106-30"><a href="#cb106-30"></a>  <span class="at">Required_n_per_group =</span> <span class="fu">c</span>(</span>
<span id="cb106-31"><a href="#cb106-31"></a>    <span class="fu">sample_size_two_sample_t</span>(<span class="fl">0.05</span>, <span class="fl">0.20</span>, <span class="dv">5</span>, <span class="dv">10</span>),</span>
<span id="cb106-32"><a href="#cb106-32"></a>    <span class="fu">sample_size_two_sample_t</span>(<span class="fl">0.05</span>, <span class="fl">0.20</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb106-33"><a href="#cb106-33"></a>    <span class="fu">sample_size_two_sample_t</span>(<span class="fl">0.05</span>, <span class="fl">0.20</span>, <span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb106-34"><a href="#cb106-34"></a>    <span class="fu">sample_size_two_prop</span>(<span class="fl">0.05</span>, <span class="fl">0.20</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>),</span>
<span id="cb106-35"><a href="#cb106-35"></a>    <span class="fu">sample_size_two_prop</span>(<span class="fl">0.05</span>, <span class="fl">0.20</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>),</span>
<span id="cb106-36"><a href="#cb106-36"></a>    <span class="fu">sample_size_two_prop</span>(<span class="fl">0.05</span>, <span class="fl">0.20</span>, <span class="fl">0.05</span>, <span class="fl">0.10</span>)</span>
<span id="cb106-37"><a href="#cb106-37"></a>  )</span>
<span id="cb106-38"><a href="#cb106-38"></a>)</span>
<span id="cb106-39"><a href="#cb106-39"></a></span>
<span id="cb106-40"><a href="#cb106-40"></a><span class="fu">print</span>(<span class="st">"Sample Size Requirements for Two-Sample Tests:"</span>)</span>
<span id="cb106-41"><a href="#cb106-41"></a><span class="fu">print</span>(sample_size_examples)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="effect-size-analysis" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="effect-size-analysis"><span class="header-section-number">1.12</span> Effect Size Analysis</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell">
<div class="cell-output cell-output-error">
<pre><code>Error in parse(text = input): &lt;text&gt;:17:3: unexpected symbol
16:   ),
17: F value
      ^</code></pre>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a><span class="co"># Calculate effect sizes for all examples in the chapter</span></span>
<span id="cb108-2"><a href="#cb108-2"></a></span>
<span id="cb108-3"><a href="#cb108-3"></a>effect_size_summary <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb108-4"><a href="#cb108-4"></a>  <span class="at">Example =</span> <span class="fu">c</span>(<span class="st">"Cable Strength (Z-test)"</span>, <span class="st">"Plastic Strength (t-test)"</span>, </span>
<span id="cb108-5"><a href="#cb108-5"></a>             <span class="st">"Process Improvement (Paired)"</span>, <span class="st">"Defect Rate Comparison"</span>, </span>
<span id="cb108-6"><a href="#cb108-6"></a>             <span class="st">"Instrument Variance"</span>, <span class="st">"Process Yield (ANOVA)"</span>),</span>
<span id="cb108-7"><a href="#cb108-7"></a>  <span class="at">Effect_Type =</span> <span class="fu">c</span>(<span class="st">"Cohen's d"</span>, <span class="st">"Cohen's d"</span>, <span class="st">"Cohen's d"</span>, </span>
<span id="cb108-8"><a href="#cb108-8"></a>                 <span class="st">"Difference in proportions"</span>, <span class="st">"Variance ratio"</span>, <span class="st">"Eta-squared"</span>),</span>
<span id="cb108-9"><a href="#cb108-9"></a>  <span class="at">Calculated_Effect =</span> <span class="fu">c</span>(</span>
<span id="cb108-10"><a href="#cb108-10"></a>    <span class="fu">abs</span>(xbar1 <span class="sc">-</span> xbar2) <span class="sc">/</span> <span class="fu">sqrt</span>((sigma1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma2<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>),  <span class="co"># Cable strength</span></span>
<span id="cb108-11"><a href="#cb108-11"></a>    <span class="fu">abs</span>(xbar1_t <span class="sc">-</span> xbar2_t) <span class="sc">/</span> sp,                         <span class="co"># Plastic strength</span></span>
<span id="cb108-12"><a href="#cb108-12"></a>    <span class="fu">abs</span>(d_bar) <span class="sc">/</span> s_d,                                    <span class="co"># Process improvement</span></span>
<span id="cb108-13"><a href="#cb108-13"></a>    <span class="fu">abs</span>(p1_hat <span class="sc">-</span> p2_hat),                                <span class="co"># Defect rates</span></span>
<span id="cb108-14"><a href="#cb108-14"></a>    <span class="fu">max</span>(s1_f_squared, s2_f_squared) <span class="sc">/</span> <span class="fu">min</span>(s1_f_squared, s2_f_squared), <span class="co"># Variance ratio</span></span>
<span id="cb108-15"><a href="#cb108-15"></a>    SST <span class="sc">/</span> SS_Total                                       <span class="co"># ANOVA eta-squared</span></span>
<span id="cb108-16"><a href="#cb108-16"></a>  ),</span>
<span id="cb108-17"><a href="#cb108-17"></a>F value<span class="st">`</span><span class="at">[1]) &lt; 0.001</span></span>
<span id="cb108-18"><a href="#cb108-18"></a><span class="at">  )</span></span>
<span id="cb108-19"><a href="#cb108-19"></a><span class="at">)</span></span>
<span id="cb108-20"><a href="#cb108-20"></a></span>
<span id="cb108-21"><a href="#cb108-21"></a><span class="at">print("Validation of Manual vs R Calculations:")</span></span>
<span id="cb108-22"><a href="#cb108-22"></a><span class="at">print(validation_checks)</span></span>
<span id="cb108-23"><a href="#cb108-23"></a></span>
<span id="cb108-24"><a href="#cb108-24"></a><span class="at"># Check if all validations passed</span></span>
<span id="cb108-25"><a href="#cb108-25"></a><span class="at">all_passed &lt;- all(validation_checks$Match)</span></span>
<span id="cb108-26"><a href="#cb108-26"></a><span class="at">print(paste("All validation checks passed:", all_passed))</span></span>
<span id="cb108-27"><a href="#cb108-27"></a></span>
<span id="cb108-28"><a href="#cb108-28"></a><span class="at">if (!all_passed) {</span></span>
<span id="cb108-29"><a href="#cb108-29"></a><span class="at">  print("WARNING: Some manual calculations do not match R functions")</span></span>
<span id="cb108-30"><a href="#cb108-30"></a><span class="at">  print("Please review the calculations above")</span></span>
<span id="cb108-31"><a href="#cb108-31"></a><span class="at">} else {</span></span>
<span id="cb108-32"><a href="#cb108-32"></a><span class="at">  print("SUCCESS: All manual calculations match R function results")</span></span>
<span id="cb108-33"><a href="#cb108-33"></a><span class="at">}</span></span>
<span id="cb108-34"><a href="#cb108-34"></a></span>
<span id="cb108-35"><a href="#cb108-35"></a><span class="at">print(paste0("</span><span class="sc">\n</span><span class="at">", strrep("=", 80)))</span></span>
<span id="cb108-36"><a href="#cb108-36"></a><span class="at">print("CHAPTER 5 COMPLETE - ALL EXAMPLES VERIFIED")</span></span>
<span id="cb108-37"><a href="#cb108-37"></a><span class="at">print(strrep("=", 80))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="chapter-summary" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="chapter-summary"><span class="header-section-number">1.13</span> Chapter Summary</h2>
<p>This chapter covered the fundamental concepts of two-sample comparisons in engineering statistics:</p>
<ol type="1">
<li><p><strong>Two-sample Z-tests</strong> when population variances are known</p></li>
<li><p><strong>Two-sample t-tests</strong> for unknown variances (equal and unequal)</p></li>
<li><p><strong>Paired t-tests</strong> for dependent observations</p></li>
<li><p><strong>F-tests</strong> for comparing variances</p></li>
<li><p><strong>Two-proportion tests</strong> for comparing success rates</p></li>
<li><p><strong>ANOVA</strong> for comparing multiple groups</p></li>
<li><p><strong>Experimental design</strong> concepts (CRD and RCBD)</p></li>
</ol>
<p>The key is choosing the appropriate method based on:</p>
<ul>
<li><p>Data structure (independent vs.&nbsp;paired)</p></li>
<li><p>Knowledge of population parameters</p></li>
<li><p>Assumptions about variance equality</p></li>
<li><p>Type of data (continuous vs.&nbsp;categorical)</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 Muhammad Yaseen. Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></p>
</div>   
    <div class="nav-footer-center">
<p><strong>Math-3020: Statistics for Science &amp; Engineering</strong></p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MYaseen208">
      <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/MYaseen208">
      <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/muhammad-yaseen-247800b4/">
      <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"fade","descPosition":"bottom","loop":false,"openEffect":"fade","selector":".lightbox","skin":"lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>