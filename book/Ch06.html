<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.20">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ch06 – Math-3020: Statistics for Science &amp; Engineering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/LogoSMSS.webp" rel="icon">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-bd0f20613ab34a035844aaae9062fb4e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-b26e8146b40141c674d57af9b78800f5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #522D80;
      }

      .quarto-title-block .quarto-title-banner {
        color: #522D80;
      }
</style>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles/custom1.css">
<link rel="stylesheet" href="styles/slides.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/LogoSMSS.webp" alt="SMSS Logo" class="navbar-logo light-content">
    <img src="../images/LogoSMSS.webp" alt="SMSS Logo" class="navbar-logo dark-content">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Math-3020</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../book/index.html"> 
<span class="menu-text">Lecture Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/index.html"> 
<span class="menu-text">Lecture Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../introR/index.html"> 
<span class="menu-text">Intro to R</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li class="dropdown-header">Data Sets</li>
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/MYaseen208"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://twitter.com/MYaseen208"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text">Twitter</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/muhammad-yaseen-247800b4/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text">LinkedIn</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/index.html">Table of Contents</a></li><li class="breadcrumb-item"><a href="../book/Ch06.html">Building Empirical Models</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../book/index.html">Table of Contents</a></li><li class="breadcrumb-item"><a href="../book/Ch06.html">Building Empirical Models</a></li></ol></nav></header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Table of Contents</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Role of Statistics in Engineering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Summary and Presentation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Random Variables and Probability Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Decision Making for a Single Sample</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Decision Making for Two Samples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/Ch06.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Building Empirical Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../book/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#building-empirical-models" id="toc-building-empirical-models" class="nav-link active" data-scroll-target="#building-empirical-models"><span class="header-section-number">1</span> Building Empirical Models</a>
  <ul class="collapse">
  <li><a href="#introduction-to-empirical-models" id="toc-introduction-to-empirical-models" class="nav-link" data-scroll-target="#introduction-to-empirical-models"><span class="header-section-number">1.1</span> Introduction to Empirical Models</a></li>
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression"><span class="header-section-number">1.2</span> Simple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#least-squares-estimation" id="toc-least-squares-estimation" class="nav-link" data-scroll-target="#least-squares-estimation"><span class="header-section-number">1.2.1</span> Least Squares Estimation</a></li>
  <li><a href="#example-tensile-strength-vs.-hardness" id="toc-example-tensile-strength-vs.-hardness" class="nav-link" data-scroll-target="#example-tensile-strength-vs.-hardness"><span class="header-section-number">1.2.2</span> Example: Tensile Strength vs.&nbsp;Hardness</a></li>
  <li><a href="#testing-hypotheses-in-simple-linear-regression" id="toc-testing-hypotheses-in-simple-linear-regression" class="nav-link" data-scroll-target="#testing-hypotheses-in-simple-linear-regression"><span class="header-section-number">1.2.3</span> Testing Hypotheses in Simple Linear Regression</a></li>
  <li><a href="#example-hypothesis-testing" id="toc-example-hypothesis-testing" class="nav-link" data-scroll-target="#example-hypothesis-testing"><span class="header-section-number">1.2.4</span> Example: Hypothesis Testing</a></li>
  <li><a href="#confidence-intervals-in-simple-linear-regression" id="toc-confidence-intervals-in-simple-linear-regression" class="nav-link" data-scroll-target="#confidence-intervals-in-simple-linear-regression"><span class="header-section-number">1.2.5</span> Confidence Intervals in Simple Linear Regression</a></li>
  <li><a href="#prediction-of-a-future-observation" id="toc-prediction-of-a-future-observation" class="nav-link" data-scroll-target="#prediction-of-a-future-observation"><span class="header-section-number">1.2.6</span> Prediction of a Future Observation</a></li>
  <li><a href="#example-confidence-and-prediction-intervals" id="toc-example-confidence-and-prediction-intervals" class="nav-link" data-scroll-target="#example-confidence-and-prediction-intervals"><span class="header-section-number">1.2.7</span> Example: Confidence and Prediction Intervals</a></li>
  <li><a href="#checking-model-adequacy" id="toc-checking-model-adequacy" class="nav-link" data-scroll-target="#checking-model-adequacy"><span class="header-section-number">1.2.8</span> Checking Model Adequacy</a></li>
  <li><a href="#example-model-diagnostics" id="toc-example-model-diagnostics" class="nav-link" data-scroll-target="#example-model-diagnostics"><span class="header-section-number">1.2.9</span> Example: Model Diagnostics</a></li>
  <li><a href="#correlation-and-regression" id="toc-correlation-and-regression" class="nav-link" data-scroll-target="#correlation-and-regression"><span class="header-section-number">1.2.10</span> Correlation and Regression</a></li>
  <li><a href="#example-correlation-analysis" id="toc-example-correlation-analysis" class="nav-link" data-scroll-target="#example-correlation-analysis"><span class="header-section-number">1.2.11</span> Example: Correlation Analysis</a></li>
  </ul></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression"><span class="header-section-number">1.3</span> Multiple Regression</a>
  <ul class="collapse">
  <li><a href="#estimation-of-parameters-in-multiple-regression" id="toc-estimation-of-parameters-in-multiple-regression" class="nav-link" data-scroll-target="#estimation-of-parameters-in-multiple-regression"><span class="header-section-number">1.3.1</span> Estimation of Parameters in Multiple Regression</a></li>
  <li><a href="#example-chemical-process-yield" id="toc-example-chemical-process-yield" class="nav-link" data-scroll-target="#example-chemical-process-yield"><span class="header-section-number">1.3.2</span> Example: Chemical Process Yield</a></li>
  <li><a href="#inferences-in-multiple-regression" id="toc-inferences-in-multiple-regression" class="nav-link" data-scroll-target="#inferences-in-multiple-regression"><span class="header-section-number">1.3.3</span> Inferences in Multiple Regression</a></li>
  <li><a href="#example-multiple-regression-inference" id="toc-example-multiple-regression-inference" class="nav-link" data-scroll-target="#example-multiple-regression-inference"><span class="header-section-number">1.3.4</span> Example: Multiple Regression Inference</a></li>
  <li><a href="#checking-model-adequacy-1" id="toc-checking-model-adequacy-1" class="nav-link" data-scroll-target="#checking-model-adequacy-1"><span class="header-section-number">1.3.5</span> Checking Model Adequacy</a></li>
  <li><a href="#example-model-diagnostics-for-multiple-regression" id="toc-example-model-diagnostics-for-multiple-regression" class="nav-link" data-scroll-target="#example-model-diagnostics-for-multiple-regression"><span class="header-section-number">1.3.6</span> Example: Model Diagnostics for Multiple Regression</a></li>
  </ul></li>
  <li><a href="#other-aspects-of-regression" id="toc-other-aspects-of-regression" class="nav-link" data-scroll-target="#other-aspects-of-regression"><span class="header-section-number">1.4</span> Other Aspects of Regression</a>
  <ul class="collapse">
  <li><a href="#polynomial-models" id="toc-polynomial-models" class="nav-link" data-scroll-target="#polynomial-models"><span class="header-section-number">1.4.1</span> Polynomial Models</a></li>
  <li><a href="#example-polynomial-regression" id="toc-example-polynomial-regression" class="nav-link" data-scroll-target="#example-polynomial-regression"><span class="header-section-number">1.4.2</span> Example: Polynomial Regression</a></li>
  <li><a href="#categorical-regressors" id="toc-categorical-regressors" class="nav-link" data-scroll-target="#categorical-regressors"><span class="header-section-number">1.4.3</span> Categorical Regressors</a></li>
  <li><a href="#example-categorical-variables" id="toc-example-categorical-variables" class="nav-link" data-scroll-target="#example-categorical-variables"><span class="header-section-number">1.4.4</span> Example: Categorical Variables</a></li>
  <li><a href="#variable-selection-techniques" id="toc-variable-selection-techniques" class="nav-link" data-scroll-target="#variable-selection-techniques"><span class="header-section-number">1.4.5</span> Variable Selection Techniques</a></li>
  <li><a href="#example-variable-selection" id="toc-example-variable-selection" class="nav-link" data-scroll-target="#example-variable-selection"><span class="header-section-number">1.4.6</span> Example: Variable Selection</a></li>
  </ul></li>
  <li><a href="#comprehensive-example-complete-regression-analysis" id="toc-comprehensive-example-complete-regression-analysis" class="nav-link" data-scroll-target="#comprehensive-example-complete-regression-analysis"><span class="header-section-number">1.5</span> Comprehensive Example: Complete Regression Analysis</a></li>
  <li><a href="#key-formulas-and-decision-framework" id="toc-key-formulas-and-decision-framework" class="nav-link" data-scroll-target="#key-formulas-and-decision-framework"><span class="header-section-number">1.6</span> Key Formulas and Decision Framework</a></li>
  <li><a href="#chapter-summary" id="toc-chapter-summary" class="nav-link" data-scroll-target="#chapter-summary"><span class="header-section-number">1.7</span> Chapter Summary</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="building-empirical-models" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Building Empirical Models</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Major Themes of Chapter 6
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Empirical Models:</strong> Building mathematical relationships from data</p></li>
<li><p><strong>Simple Linear Regression:</strong> Modeling relationships between two variables</p></li>
<li><p><strong>Multiple Regression:</strong> Extending to multiple predictor variables</p></li>
<li><p><strong>Model Adequacy:</strong> Checking assumptions and validating models</p></li>
<li><p><strong>Advanced Topics:</strong> Polynomial models, categorical variables, and variable selection</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>After careful study of this chapter, you should be able to do the following:</p>
<ol type="1">
<li><p>Understand the <span style="color:green">fundamental concepts</span> of empirical modeling and regression.</p></li>
<li><p>Apply <span style="color:green">least squares estimation</span> to fit simple linear regression models.</p></li>
<li><p>Conduct <span style="color:green">hypothesis tests</span> and construct <span style="color:green">confidence intervals</span> for regression parameters.</p></li>
<li><p>Make <span style="color:green">predictions</span> with appropriate uncertainty quantification.</p></li>
<li><p>Check <span style="color:green">model adequacy</span> using residual analysis and diagnostic plots.</p></li>
<li><p>Understand the relationship between <span style="color:green">correlation and regression</span>.</p></li>
<li><p>Fit and interpret <span style="color:green">multiple regression models</span>.</p></li>
<li><p>Work with <span style="color:green">polynomial models</span> and <span style="color:green">categorical variables</span>.</p></li>
<li><p>Apply <span style="color:green">variable selection techniques</span> for model building.</p></li>
</ol>
</div>
</div>
<section id="introduction-to-empirical-models" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="introduction-to-empirical-models"><span class="header-section-number">1.1</span> Introduction to Empirical Models</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>What are Empirical Models?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Empirical models are mathematical relationships derived from observed data rather than theoretical principles. They are essential in engineering for:</p>
<ul>
<li><p><strong>Process Optimization:</strong> Understanding how input variables affect outputs</p></li>
<li><p><strong>Quality Control:</strong> Relating product characteristics to process conditions</p></li>
<li><p><strong>Design:</strong> Predicting performance based on design parameters</p></li>
<li><p><strong>Troubleshooting:</strong> Identifying factors that influence system behavior</p></li>
</ul>
<p><strong>Types of Empirical Models:</strong></p>
<ul>
<li><p><strong>Linear Models:</strong> <span class="math inline">y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \ldots + \epsilon</span></p></li>
<li><p><strong>Polynomial Models:</strong> <span class="math inline">y = \beta_0 + \beta_1 x + \beta_2 x^2 + \ldots + \epsilon</span></p></li>
<li><p><strong>Interaction Models:</strong> <span class="math inline">y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{12} x_1 x_2 + \epsilon</span></p></li>
</ul>
<p><strong>Key Assumptions:</strong></p>
<ul>
<li><p>Linear relationship between predictors and response</p></li>
<li><p>Independent observations</p></li>
<li><p>Constant variance (homoscedasticity)</p></li>
<li><p>Normally distributed errors</p></li>
</ul>
</div>
</div>
</section>
<section id="simple-linear-regression" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="simple-linear-regression"><span class="header-section-number">1.2</span> Simple Linear Regression</h2>
<section id="least-squares-estimation" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="least-squares-estimation"><span class="header-section-number">1.2.1</span> Least Squares Estimation</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Simple Linear Regression Model
</div>
</div>
<div class="callout-body-container callout-body">
<p>The simple linear regression model relates a response variable <span class="math inline">y</span> to a single predictor variable <span class="math inline">x</span>:</p>
<p><span class="math display">y_i = \beta_0 + \beta_1 x_i + \epsilon_i</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">y_i</span> = response variable for observation <span class="math inline">i</span></p></li>
<li><p><span class="math inline">x_i</span> = predictor variable for observation <span class="math inline">i</span></p></li>
<li><p><span class="math inline">\beta_0</span> = intercept parameter</p></li>
<li><p><span class="math inline">\beta_1</span> = slope parameter</p></li>
<li><p><span class="math inline">\epsilon_i</span> = random error term, <span class="math inline">\epsilon_i \sim N(0, \sigma^2)</span></p></li>
</ul>
<p><strong>Least Squares Estimators:</strong></p>
<p><span class="math display">\hat{\beta}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2} = \frac{S_{xy}}{S_{xx}}</span></p>
<p><span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">S_{xy} = \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})</span></p></li>
<li><p><span class="math inline">S_{xx} = \sum_{i=1}^n (x_i - \bar{x})^2</span></p></li>
<li><p><span class="math inline">S_{yy} = \sum_{i=1}^n (y_i - \bar{y})^2</span></p></li>
</ul>
</div>
</div>
</section>
<section id="example-tensile-strength-vs.-hardness" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="example-tensile-strength-vs.-hardness"><span class="header-section-number">1.2.2</span> Example: Tensile Strength vs.&nbsp;Hardness</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A materials engineer wants to relate the tensile strength of steel specimens to their hardness. Data from 20 specimens:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"></a><a href="data/steel_strength.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Steel Strength vs Hardness Data Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       n Hardness_Mean Hardness_SD Hardness_Min Hardness_Max Strength_Mean
   &lt;int&gt;         &lt;num&gt;       &lt;num&gt;        &lt;num&gt;        &lt;num&gt;         &lt;num&gt;
1:    20      62.03234    12.53884     41.68238     78.27333      169.2171
   Strength_SD Strength_Min Strength_Max
         &lt;num&gt;        &lt;num&gt;        &lt;num&gt;
1:     29.0103     120.2922     220.4809</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "First 10 observations:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    specimen hardness strength
       &lt;int&gt;    &lt;num&gt;    &lt;num&gt;
 1:        1 51.50310 153.5504
 2:        2 71.53221 196.7090
 3:        3 56.35908 159.1039
 4:        4 75.32070 204.1872
 5:        5 77.61869 204.6000
 6:        6 41.82226 133.8510
 7:        7 61.12422 171.7934
 8:        8 75.69676 188.5090
 9:        9 62.05740 175.7543
10:       10 58.26459 156.8791</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(collapse)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">library</span>(data.table)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="fu">library</span>(scales)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co"># Steel strength vs hardness data (simple linear regression)</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a>steel_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="at">specimen =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="at">hardness =</span> <span class="fu">runif</span>(<span class="dv">20</span>, <span class="at">min =</span> <span class="dv">40</span>, <span class="at">max =</span> <span class="dv">80</span>),</span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="at">strength =</span> <span class="cn">NULL</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>)</span>
<span id="cb5-17"><a href="#cb5-17"></a></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co"># Create realistic relationship with some noise</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>steel_data[, strength <span class="sc">:</span><span class="er">=</span> <span class="dv">15</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> hardness <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">8</span>)]</span>
<span id="cb5-20"><a href="#cb5-20"></a></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co"># Summary statistics</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>steel_summary <span class="ot">&lt;-</span> steel_data <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb5-24"><a href="#cb5-24"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(hardness),</span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="at">Hardness_Mean =</span> <span class="fu">fmean</span>(hardness),</span>
<span id="cb5-26"><a href="#cb5-26"></a>    <span class="at">Hardness_SD =</span> <span class="fu">fsd</span>(hardness),</span>
<span id="cb5-27"><a href="#cb5-27"></a>    <span class="at">Hardness_Min =</span> <span class="fu">fmin</span>(hardness),</span>
<span id="cb5-28"><a href="#cb5-28"></a>    <span class="at">Hardness_Max =</span> <span class="fu">fmax</span>(hardness),</span>
<span id="cb5-29"><a href="#cb5-29"></a>    <span class="at">Strength_Mean =</span> <span class="fu">fmean</span>(strength),</span>
<span id="cb5-30"><a href="#cb5-30"></a>    <span class="at">Strength_SD =</span> <span class="fu">fsd</span>(strength),</span>
<span id="cb5-31"><a href="#cb5-31"></a>    <span class="at">Strength_Min =</span> <span class="fu">fmin</span>(strength),</span>
<span id="cb5-32"><a href="#cb5-32"></a>    <span class="at">Strength_Max =</span> <span class="fu">fmax</span>(strength)</span>
<span id="cb5-33"><a href="#cb5-33"></a>  )</span>
<span id="cb5-34"><a href="#cb5-34"></a></span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="fu">print</span>(<span class="st">"Steel Strength vs Hardness Data Summary:"</span>)</span>
<span id="cb5-36"><a href="#cb5-36"></a><span class="fu">print</span>(steel_summary)</span>
<span id="cb5-37"><a href="#cb5-37"></a></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="co"># Detailed data view</span></span>
<span id="cb5-39"><a href="#cb5-39"></a><span class="fu">print</span>(<span class="st">"First 10 observations:"</span>)</span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="fu">print</span>(<span class="fu">head</span>(steel_data, <span class="dv">10</span>))</span>
<span id="cb5-41"><a href="#cb5-41"></a></span>
<span id="cb5-42"><a href="#cb5-42"></a><span class="co"># Create data directory if needed</span></span>
<span id="cb5-43"><a href="#cb5-43"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(<span class="st">"data"</span>)) <span class="fu">dir.create</span>(<span class="st">"data"</span>)</span>
<span id="cb5-44"><a href="#cb5-44"></a></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="co"># Write data to CSV</span></span>
<span id="cb5-46"><a href="#cb5-46"></a><span class="fu">fwrite</span>(steel_data, <span class="st">"data/steel_strength.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">

</div>
</div>
</div>
<p><strong>Manual Calculation:</strong></p>
<p>Given: n = 20, <span class="math inline">\bar{x}</span> = hardness mean, <span class="math inline">\bar{y}</span> = strength mean</p>
<ol type="1">
<li><p><strong>Calculate Sums:</strong></p>
<ul>
<li><span class="math inline">S_{xx} = \sum(x_i - \bar{x})^2</span></li>
<li><span class="math inline">S_{xy} = \sum(x_i - \bar{x})(y_i - \bar{y})</span></li>
<li><span class="math inline">S_{yy} = \sum(y_i - \bar{y})^2</span></li>
</ul></li>
<li><p><strong>Estimate Parameters:</strong> <span class="math display">\hat{\beta}_1 = \frac{S_{xy}}{S_{xx}}</span> <span class="math display">\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}</span></p></li>
<li><p><strong>Fitted Model:</strong> <span class="math display">\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x</span></p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Manual Simple Linear Regression Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>        Parameter Manual_Estimate                               Interpretation
           &lt;char&gt;           &lt;num&gt;                                       &lt;char&gt;
1: β₀ (Intercept)         30.4493            Strength when hardness = 0: 30.45
2:     β₁ (Slope)          2.2370 Strength increases by 2.24 per unit hardness
3:             σ²         57.8584                        Error variance: 57.86
4:             R²          0.9349                93.5 % of variation explained</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's lm() verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = strength ~ hardness, data = steel_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.2758  -5.0561  -0.6948   5.4929  15.1408 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  30.4493     8.7991   3.461  0.00279 ** 
hardness      2.2370     0.1392  16.074 4.03e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.606 on 18 degrees of freedom
Multiple R-squared:  0.9349,    Adjusted R-squared:  0.9313 
F-statistic: 258.4 on 1 and 18 DF,  p-value: 4.031e-12</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Manual vs R Function Comparison:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Parameter    Manual R_Function   Difference
        &lt;char&gt;     &lt;num&gt;      &lt;num&gt;        &lt;num&gt;
1:   Intercept 30.449343  30.449343 7.815970e-14
2:       Slope  2.237023   2.237023 8.881784e-16
3:   R-squared  0.934870   0.934870 0.000000e+00
4: Residual SE  7.606471   7.606471 2.664535e-15</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Simple linear regression - manual calculations</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>n <span class="ot">&lt;-</span> <span class="fu">fnobs</span>(steel_data<span class="sc">$</span>hardness)</span>
<span id="cb12-3"><a href="#cb12-3"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">fmean</span>(steel_data<span class="sc">$</span>hardness)</span>
<span id="cb12-4"><a href="#cb12-4"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">fmean</span>(steel_data<span class="sc">$</span>strength)</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co"># Calculate sums of squares and cross-products</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>x <span class="ot">&lt;-</span> steel_data<span class="sc">$</span>hardness</span>
<span id="cb12-8"><a href="#cb12-8"></a>y <span class="ot">&lt;-</span> steel_data<span class="sc">$</span>strength</span>
<span id="cb12-9"><a href="#cb12-9"></a></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co"># Manual calculation of sums</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>Sxx <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a>Syy <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a>Sxy <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> x_bar) <span class="sc">*</span> (y <span class="sc">-</span> y_bar))</span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co"># Parameter estimates</span></span>
<span id="cb12-16"><a href="#cb12-16"></a>beta1_hat <span class="ot">&lt;-</span> Sxy <span class="sc">/</span> Sxx</span>
<span id="cb12-17"><a href="#cb12-17"></a>beta0_hat <span class="ot">&lt;-</span> y_bar <span class="sc">-</span> beta1_hat <span class="sc">*</span> x_bar</span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co"># Sum of squares</span></span>
<span id="cb12-20"><a href="#cb12-20"></a>SSR <span class="ot">&lt;-</span> beta1_hat <span class="sc">*</span> Sxy <span class="co"># Regression sum of squares</span></span>
<span id="cb12-21"><a href="#cb12-21"></a>SSE <span class="ot">&lt;-</span> Syy <span class="sc">-</span> beta1_hat <span class="sc">*</span> Sxy <span class="co"># Error sum of squares</span></span>
<span id="cb12-22"><a href="#cb12-22"></a>SST <span class="ot">&lt;-</span> Syy <span class="co"># Total sum of squares</span></span>
<span id="cb12-23"><a href="#cb12-23"></a></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co"># Mean squares</span></span>
<span id="cb12-25"><a href="#cb12-25"></a>MSR <span class="ot">&lt;-</span> SSR <span class="sc">/</span> <span class="dv">1</span> <span class="co"># df = 1 for simple regression</span></span>
<span id="cb12-26"><a href="#cb12-26"></a>MSE <span class="ot">&lt;-</span> SSE <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">2</span>) <span class="co"># df = n - 2</span></span>
<span id="cb12-27"><a href="#cb12-27"></a>s_squared <span class="ot">&lt;-</span> MSE</span>
<span id="cb12-28"><a href="#cb12-28"></a></span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="co"># R-squared</span></span>
<span id="cb12-30"><a href="#cb12-30"></a>R_squared <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb12-31"><a href="#cb12-31"></a></span>
<span id="cb12-32"><a href="#cb12-32"></a><span class="co"># Manual calculations summary</span></span>
<span id="cb12-33"><a href="#cb12-33"></a>manual_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb12-34"><a href="#cb12-34"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"β₀ (Intercept)"</span>, <span class="st">"β₁ (Slope)"</span>, <span class="st">"σ²"</span>, <span class="st">"R²"</span>),</span>
<span id="cb12-35"><a href="#cb12-35"></a>  <span class="at">Manual_Estimate =</span> <span class="fu">c</span>(</span>
<span id="cb12-36"><a href="#cb12-36"></a>    <span class="fu">round</span>(beta0_hat, <span class="dv">4</span>),</span>
<span id="cb12-37"><a href="#cb12-37"></a>    <span class="fu">round</span>(beta1_hat, <span class="dv">4</span>),</span>
<span id="cb12-38"><a href="#cb12-38"></a>    <span class="fu">round</span>(s_squared, <span class="dv">4</span>),</span>
<span id="cb12-39"><a href="#cb12-39"></a>    <span class="fu">round</span>(R_squared, <span class="dv">4</span>)</span>
<span id="cb12-40"><a href="#cb12-40"></a>  ),</span>
<span id="cb12-41"><a href="#cb12-41"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb12-42"><a href="#cb12-42"></a>    <span class="fu">paste</span>(<span class="st">"Strength when hardness = 0:"</span>, <span class="fu">round</span>(beta0_hat, <span class="dv">2</span>)),</span>
<span id="cb12-43"><a href="#cb12-43"></a>    <span class="fu">paste</span>(<span class="st">"Strength increases by"</span>, <span class="fu">round</span>(beta1_hat, <span class="dv">2</span>), <span class="st">"per unit hardness"</span>),</span>
<span id="cb12-44"><a href="#cb12-44"></a>    <span class="fu">paste</span>(<span class="st">"Error variance:"</span>, <span class="fu">round</span>(s_squared, <span class="dv">2</span>)),</span>
<span id="cb12-45"><a href="#cb12-45"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(R_squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% of variation explained"</span>)</span>
<span id="cb12-46"><a href="#cb12-46"></a>  )</span>
<span id="cb12-47"><a href="#cb12-47"></a>)</span>
<span id="cb12-48"><a href="#cb12-48"></a></span>
<span id="cb12-49"><a href="#cb12-49"></a><span class="fu">print</span>(<span class="st">"Manual Simple Linear Regression Results:"</span>)</span>
<span id="cb12-50"><a href="#cb12-50"></a><span class="fu">print</span>(manual_results)</span>
<span id="cb12-51"><a href="#cb12-51"></a></span>
<span id="cb12-52"><a href="#cb12-52"></a><span class="co"># Verification with R's lm function</span></span>
<span id="cb12-53"><a href="#cb12-53"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(strength <span class="sc">~</span> hardness, <span class="at">data =</span> steel_data)</span>
<span id="cb12-54"><a href="#cb12-54"></a>lm_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(lm_model)</span>
<span id="cb12-55"><a href="#cb12-55"></a></span>
<span id="cb12-56"><a href="#cb12-56"></a><span class="fu">print</span>(<span class="st">"R's lm() verification:"</span>)</span>
<span id="cb12-57"><a href="#cb12-57"></a><span class="fu">print</span>(lm_summary)</span>
<span id="cb12-58"><a href="#cb12-58"></a></span>
<span id="cb12-59"><a href="#cb12-59"></a><span class="co"># Compare manual vs R calculations</span></span>
<span id="cb12-60"><a href="#cb12-60"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb12-61"><a href="#cb12-61"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Slope"</span>, <span class="st">"R-squared"</span>, <span class="st">"Residual SE"</span>),</span>
<span id="cb12-62"><a href="#cb12-62"></a>  <span class="at">Manual =</span> <span class="fu">c</span>(beta0_hat, beta1_hat, R_squared, <span class="fu">sqrt</span>(MSE)),</span>
<span id="cb12-63"><a href="#cb12-63"></a>  <span class="at">R_Function =</span> <span class="fu">c</span>(</span>
<span id="cb12-64"><a href="#cb12-64"></a>    <span class="fu">coef</span>(lm_model)[<span class="dv">1</span>], <span class="fu">coef</span>(lm_model)[<span class="dv">2</span>],</span>
<span id="cb12-65"><a href="#cb12-65"></a>    <span class="fu">summary</span>(lm_model)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(lm_model)<span class="sc">$</span>sigma</span>
<span id="cb12-66"><a href="#cb12-66"></a>  ),</span>
<span id="cb12-67"><a href="#cb12-67"></a>  <span class="at">Difference =</span> <span class="fu">c</span>(</span>
<span id="cb12-68"><a href="#cb12-68"></a>    <span class="fu">abs</span>(beta0_hat <span class="sc">-</span> <span class="fu">coef</span>(lm_model)[<span class="dv">1</span>]),</span>
<span id="cb12-69"><a href="#cb12-69"></a>    <span class="fu">abs</span>(beta1_hat <span class="sc">-</span> <span class="fu">coef</span>(lm_model)[<span class="dv">2</span>]),</span>
<span id="cb12-70"><a href="#cb12-70"></a>    <span class="fu">abs</span>(R_squared <span class="sc">-</span> <span class="fu">summary</span>(lm_model)<span class="sc">$</span>r.squared),</span>
<span id="cb12-71"><a href="#cb12-71"></a>    <span class="fu">abs</span>(<span class="fu">sqrt</span>(MSE) <span class="sc">-</span> <span class="fu">summary</span>(lm_model)<span class="sc">$</span>sigma)</span>
<span id="cb12-72"><a href="#cb12-72"></a>  )</span>
<span id="cb12-73"><a href="#cb12-73"></a>)</span>
<span id="cb12-74"><a href="#cb12-74"></a></span>
<span id="cb12-75"><a href="#cb12-75"></a><span class="fu">print</span>(<span class="st">"Manual vs R Function Comparison:"</span>)</span>
<span id="cb12-76"><a href="#cb12-76"></a><span class="fu">print</span>(comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Simple linear regression: Tensile strength vs.&nbsp;hardness"><img src="Ch06_files/figure-html/fig-Ch06Code01-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Simple linear regression: Tensile strength vs.&nbsp;hardness
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Simple linear regression visualization</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> steel_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hardness, <span class="at">y =</span> strength)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="at">x =</span> <span class="st">"Hardness"</span>,</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="at">y =</span> <span class="st">"Tensile Strength"</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="at">title =</span> <span class="st">"Simple Linear Regression: Tensile Strength vs Hardness"</span>,</span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"ŷ ="</span>, <span class="fu">round</span>(beta0_hat, <span class="dv">2</span>), <span class="st">"+"</span>, <span class="fu">round</span>(beta1_hat, <span class="dv">2</span>), <span class="st">"x, R² ="</span>, <span class="fu">round</span>(R_squared, <span class="dv">3</span>))</span>
<span id="cb13-10"><a href="#cb13-10"></a>  ) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a>  )</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co"># Residuals vs fitted</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>fitted_values <span class="ot">&lt;-</span> beta0_hat <span class="sc">+</span> beta1_hat <span class="sc">*</span> steel_data<span class="sc">$</span>hardness</span>
<span id="cb13-19"><a href="#cb13-19"></a>residuals <span class="ot">&lt;-</span> steel_data<span class="sc">$</span>strength <span class="sc">-</span> fitted_values</span>
<span id="cb13-20"><a href="#cb13-20"></a></span>
<span id="cb13-21"><a href="#cb13-21"></a>residual_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb13-22"><a href="#cb13-22"></a>  <span class="at">fitted =</span> fitted_values,</span>
<span id="cb13-23"><a href="#cb13-23"></a>  <span class="at">residuals =</span> residuals,</span>
<span id="cb13-24"><a href="#cb13-24"></a>  <span class="at">hardness =</span> steel_data<span class="sc">$</span>hardness</span>
<span id="cb13-25"><a href="#cb13-25"></a>)</span>
<span id="cb13-26"><a href="#cb13-26"></a></span>
<span id="cb13-27"><a href="#cb13-27"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> residual_data, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb13-28"><a href="#cb13-28"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb13-29"><a href="#cb13-29"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb13-30"><a href="#cb13-30"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb13-31"><a href="#cb13-31"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-32"><a href="#cb13-32"></a>    <span class="at">x =</span> <span class="st">"Fitted Values"</span>,</span>
<span id="cb13-33"><a href="#cb13-33"></a>    <span class="at">y =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb13-34"><a href="#cb13-34"></a>    <span class="at">title =</span> <span class="st">"Residuals vs Fitted Values"</span></span>
<span id="cb13-35"><a href="#cb13-35"></a>  ) <span class="sc">+</span></span>
<span id="cb13-36"><a href="#cb13-36"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb13-37"><a href="#cb13-37"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb13-38"><a href="#cb13-38"></a></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="co"># Combine plots</span></span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="testing-hypotheses-in-simple-linear-regression" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="testing-hypotheses-in-simple-linear-regression"><span class="header-section-number">1.2.3</span> Testing Hypotheses in Simple Linear Regression</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hypothesis Tests for Regression Parameters
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Test for Slope (Significance of Regression):</strong></p>
<p>H₀: β₁ = 0 vs H₁: β₁ ≠ 0</p>
<p><strong>Test Statistic:</strong></p>
<p><span class="math display">t_0 = \frac{\hat{\beta}_1}{SE(\hat{\beta}_1)} = \frac{\hat{\beta}_1}{\sqrt{MS_E/S_{xx}}}</span></p>
<p>where <span class="math inline">MS_E = \frac{SS_E}{n-2}</span> and <span class="math inline">SS_E = S_{yy} - \hat{\beta}_1 S_{xy}</span></p>
<p><strong>Test for Intercept:</strong></p>
<p>H₀: β₀ = 0 vs H₁: β₀ ≠ 0</p>
<p><strong>Test Statistic:</strong></p>
<p><span class="math display">t_0 = \frac{\hat{\beta}_0}{SE(\hat{\beta}_0)} = \frac{\hat{\beta}_0}{\sqrt{MS_E(\frac{1}{n} + \frac{\bar{x}^2}{S_{xx}})}}</span></p>
<p><strong>ANOVA Table for Regression:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Source</th>
<th>SS</th>
<th>df</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td><span class="math inline">SS_R = \hat{\beta}_1 S_{xy}</span></td>
<td>1</td>
<td><span class="math inline">MS_R</span></td>
<td><span class="math inline">MS_R/MS_E</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">SS_E = S_{yy} - \hat{\beta}_1 S_{xy}</span></td>
<td>n-2</td>
<td><span class="math inline">MS_E</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">SS_T = S_{yy}</span></td>
<td>n-1</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="example-hypothesis-testing" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="example-hypothesis-testing"><span class="header-section-number">1.2.4</span> Example: Hypothesis Testing</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hypothesis Test Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Test Null_Hypothesis Test_Statistic P_Value Critical_Value
                 &lt;char&gt;          &lt;char&gt;          &lt;num&gt;   &lt;num&gt;          &lt;num&gt;
1:         Slope β₁ = 0          β₁ = 0        16.0739  0.0000          2.101
2:     Intercept β₀ = 0          β₀ = 0         3.4605  0.0028          2.101
3: Overall Model F-test          β₁ = 0       258.3704  0.0000          4.414
    Decision                               Conclusion
      &lt;char&gt;                                   &lt;char&gt;
1: Reject H₀          Significant linear relationship
2: Reject H₀ Intercept significantly different from 0
3: Reject H₀                     Model is significant</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ANOVA Table:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Source       SS    df       MS F_Statistic P_Value
       &lt;char&gt;    &lt;num&gt; &lt;num&gt;    &lt;num&gt;       &lt;num&gt;   &lt;num&gt;
1: Regression 14948.90     1 14948.90    258.3704       0
2:      Error  1041.45    18    57.86          NA      NA
3:      Total 15990.35    19       NA          NA      NA</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Hypothesis testing for regression parameters</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>df_error <span class="ot">&lt;-</span> n <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>t_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, df_error)</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co"># Standard errors</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>SE_beta1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE <span class="sc">/</span> Sxx)</span>
<span id="cb18-8"><a href="#cb18-8"></a>SE_beta0 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> n <span class="sc">+</span> x_bar<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Sxx))</span>
<span id="cb18-9"><a href="#cb18-9"></a></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co"># Test for slope (β₁ = 0)</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>t_stat_beta1 <span class="ot">&lt;-</span> beta1_hat <span class="sc">/</span> SE_beta1</span>
<span id="cb18-12"><a href="#cb18-12"></a>p_value_beta1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat_beta1), df_error))</span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co"># Test for intercept (β₀ = 0)</span></span>
<span id="cb18-15"><a href="#cb18-15"></a>t_stat_beta0 <span class="ot">&lt;-</span> beta0_hat <span class="sc">/</span> SE_beta0</span>
<span id="cb18-16"><a href="#cb18-16"></a>p_value_beta0 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat_beta0), df_error))</span>
<span id="cb18-17"><a href="#cb18-17"></a></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co"># F-test for overall significance</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>F_stat <span class="ot">&lt;-</span> MSR <span class="sc">/</span> MSE</span>
<span id="cb18-20"><a href="#cb18-20"></a>p_value_F <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(F_stat, <span class="dv">1</span>, df_error)</span>
<span id="cb18-21"><a href="#cb18-21"></a></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="co"># Hypothesis test results</span></span>
<span id="cb18-23"><a href="#cb18-23"></a>hypothesis_tests <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb18-24"><a href="#cb18-24"></a>  <span class="at">Test =</span> <span class="fu">c</span>(<span class="st">"Slope β₁ = 0"</span>, <span class="st">"Intercept β₀ = 0"</span>, <span class="st">"Overall Model F-test"</span>),</span>
<span id="cb18-25"><a href="#cb18-25"></a>  <span class="at">Null_Hypothesis =</span> <span class="fu">c</span>(<span class="st">"β₁ = 0"</span>, <span class="st">"β₀ = 0"</span>, <span class="st">"β₁ = 0"</span>),</span>
<span id="cb18-26"><a href="#cb18-26"></a>  <span class="at">Test_Statistic =</span> <span class="fu">c</span>(<span class="fu">round</span>(t_stat_beta1, <span class="dv">4</span>), <span class="fu">round</span>(t_stat_beta0, <span class="dv">4</span>), <span class="fu">round</span>(F_stat, <span class="dv">4</span>)),</span>
<span id="cb18-27"><a href="#cb18-27"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(p_value_beta1, <span class="dv">4</span>), <span class="fu">round</span>(p_value_beta0, <span class="dv">4</span>), <span class="fu">round</span>(p_value_F, <span class="dv">4</span>)),</span>
<span id="cb18-28"><a href="#cb18-28"></a>  <span class="at">Critical_Value =</span> <span class="fu">c</span>(</span>
<span id="cb18-29"><a href="#cb18-29"></a>    <span class="fu">round</span>(t_critical, <span class="dv">3</span>), <span class="fu">round</span>(t_critical, <span class="dv">3</span>),</span>
<span id="cb18-30"><a href="#cb18-30"></a>    <span class="fu">round</span>(<span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="dv">1</span>, df_error), <span class="dv">3</span>)</span>
<span id="cb18-31"><a href="#cb18-31"></a>  ),</span>
<span id="cb18-32"><a href="#cb18-32"></a>  <span class="at">Decision =</span> <span class="fu">c</span>(</span>
<span id="cb18-33"><a href="#cb18-33"></a>    <span class="fu">ifelse</span>(p_value_beta1 <span class="sc">&lt;</span> alpha, <span class="st">"Reject H₀"</span>, <span class="st">"Fail to reject H₀"</span>),</span>
<span id="cb18-34"><a href="#cb18-34"></a>    <span class="fu">ifelse</span>(p_value_beta0 <span class="sc">&lt;</span> alpha, <span class="st">"Reject H₀"</span>, <span class="st">"Fail to reject H₀"</span>),</span>
<span id="cb18-35"><a href="#cb18-35"></a>    <span class="fu">ifelse</span>(p_value_F <span class="sc">&lt;</span> alpha, <span class="st">"Reject H₀"</span>, <span class="st">"Fail to reject H₀"</span>)</span>
<span id="cb18-36"><a href="#cb18-36"></a>  ),</span>
<span id="cb18-37"><a href="#cb18-37"></a>  <span class="at">Conclusion =</span> <span class="fu">c</span>(</span>
<span id="cb18-38"><a href="#cb18-38"></a>    <span class="fu">ifelse</span>(p_value_beta1 <span class="sc">&lt;</span> alpha, <span class="st">"Significant linear relationship"</span>, <span class="st">"No significant relationship"</span>),</span>
<span id="cb18-39"><a href="#cb18-39"></a>    <span class="fu">ifelse</span>(p_value_beta0 <span class="sc">&lt;</span> alpha, <span class="st">"Intercept significantly different from 0"</span>, <span class="st">"Intercept not significant"</span>),</span>
<span id="cb18-40"><a href="#cb18-40"></a>    <span class="fu">ifelse</span>(p_value_F <span class="sc">&lt;</span> alpha, <span class="st">"Model is significant"</span>, <span class="st">"Model is not significant"</span>)</span>
<span id="cb18-41"><a href="#cb18-41"></a>  )</span>
<span id="cb18-42"><a href="#cb18-42"></a>)</span>
<span id="cb18-43"><a href="#cb18-43"></a></span>
<span id="cb18-44"><a href="#cb18-44"></a><span class="fu">print</span>(<span class="st">"Hypothesis Test Results:"</span>)</span>
<span id="cb18-45"><a href="#cb18-45"></a><span class="fu">print</span>(hypothesis_tests)</span>
<span id="cb18-46"><a href="#cb18-46"></a></span>
<span id="cb18-47"><a href="#cb18-47"></a><span class="co"># ANOVA table</span></span>
<span id="cb18-48"><a href="#cb18-48"></a>anova_table <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb18-49"><a href="#cb18-49"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">"Regression"</span>, <span class="st">"Error"</span>, <span class="st">"Total"</span>),</span>
<span id="cb18-50"><a href="#cb18-50"></a>  <span class="at">SS =</span> <span class="fu">c</span>(<span class="fu">round</span>(SSR, <span class="dv">2</span>), <span class="fu">round</span>(SSE, <span class="dv">2</span>), <span class="fu">round</span>(SST, <span class="dv">2</span>)),</span>
<span id="cb18-51"><a href="#cb18-51"></a>  <span class="at">df =</span> <span class="fu">c</span>(<span class="dv">1</span>, df_error, n <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb18-52"><a href="#cb18-52"></a>  <span class="at">MS =</span> <span class="fu">c</span>(<span class="fu">round</span>(MSR, <span class="dv">2</span>), <span class="fu">round</span>(MSE, <span class="dv">2</span>), <span class="cn">NA</span>),</span>
<span id="cb18-53"><a href="#cb18-53"></a>  <span class="at">F_Statistic =</span> <span class="fu">c</span>(<span class="fu">round</span>(F_stat, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb18-54"><a href="#cb18-54"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(p_value_F, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb18-55"><a href="#cb18-55"></a>)</span>
<span id="cb18-56"><a href="#cb18-56"></a></span>
<span id="cb18-57"><a href="#cb18-57"></a><span class="fu">print</span>(<span class="st">"ANOVA Table:"</span>)</span>
<span id="cb18-58"><a href="#cb18-58"></a><span class="fu">print</span>(anova_table)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="confidence-intervals-in-simple-linear-regression" class="level3" data-number="1.2.5">
<h3 data-number="1.2.5" class="anchored" data-anchor-id="confidence-intervals-in-simple-linear-regression"><span class="header-section-number">1.2.5</span> Confidence Intervals in Simple Linear Regression</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Confidence Intervals
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>For Slope β₁:</strong></p>
<p><span class="math display">\hat{\beta}_1 \pm t_{\alpha/2, n-2} \sqrt{\frac{MS_E}{S_{xx}}}</span></p>
<p><strong>For Intercept β₀:</strong></p>
<p><span class="math display">\hat{\beta}_0 \pm t_{\alpha/2, n-2} \sqrt{MS_E\left(\frac{1}{n} + \frac{\bar{x}^2}{S_{xx}}\right)}</span></p>
<p><strong>For Mean Response at x₀:</strong></p>
<p><span class="math display">\hat{y}_0 \pm t_{\alpha/2, n-2} \sqrt{MS_E\left(\frac{1}{n} + \frac{(x_0 - \bar{x})^2}{S_{xx}}\right)}</span></p>
<p><strong>Coefficient of Determination:</strong></p>
<p><span class="math display">R^2 = \frac{SS_R}{SS_T} = \frac{\hat{\beta}_1 S_{xy}}{S_{yy}} = 1 - \frac{SS_E}{SS_T}</span></p>
<p><span class="math inline">R^2</span> represents the proportion of total variation explained by the regression.</p>
</div>
</div>
</section>
<section id="prediction-of-a-future-observation" class="level3" data-number="1.2.6">
<h3 data-number="1.2.6" class="anchored" data-anchor-id="prediction-of-a-future-observation"><span class="header-section-number">1.2.6</span> Prediction of a Future Observation</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Prediction Intervals
</div>
</div>
<div class="callout-body-container callout-body">
<p>For predicting a <strong>single future observation</strong> at x₀:</p>
<p><span class="math display">\hat{y}_0 \pm t_{\alpha/2, n-2} \sqrt{MS_E\left(1 + \frac{1}{n} + \frac{(x_0 - \bar{x})^2}{S_{xx}}\right)}</span></p>
<p><strong>Key Differences:</strong></p>
<ul>
<li><p><strong>Confidence Interval:</strong> For the mean response (narrower)</p></li>
<li><p><strong>Prediction Interval:</strong> For individual observation (wider due to additional uncertainty)</p></li>
</ul>
<p>The extra “1” in the prediction interval accounts for the variability of individual observations around the mean response.</p>
</div>
</div>
</section>
<section id="example-confidence-and-prediction-intervals" class="level3" data-number="1.2.7">
<h3 data-number="1.2.7" class="anchored" data-anchor-id="example-confidence-and-prediction-intervals"><span class="header-section-number">1.2.7</span> Example: Confidence and Prediction Intervals</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Intervals for Mean Response:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Hardness Predicted CI_Lower CI_Upper CI_Width
      &lt;num&gt;     &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
1: 41.68238    123.69   116.75   130.63    13.88
2: 50.83012    144.16   139.31   149.00     9.69
3: 59.97786    164.62   161.00   168.24     7.25
4: 69.12560    185.08   180.95   189.22     8.26
5: 78.27333    205.55   199.61   211.49    11.89</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Prediction Intervals for Individual Observations:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Hardness Predicted PI_Lower PI_Upper PI_Width
      &lt;num&gt;     &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;
1: 41.68238    123.69   106.27   141.12    34.85
2: 50.83012    144.16   127.46   160.86    33.40
3: 59.97786    164.62   148.23   181.01    32.77
4: 69.12560    185.08   168.58   201.59    33.01
5: 78.27333    205.55   188.50   222.60    34.10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Interval Width Comparison:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Hardness CI_Width PI_Width PI_vs_CI_Ratio
      &lt;num&gt;    &lt;num&gt;    &lt;num&gt;          &lt;num&gt;
1: 41.68238    13.88    34.85           2.51
2: 50.83012     9.69    33.40           3.45
3: 59.97786     7.25    32.77           4.52
4: 69.12560     8.26    33.01           4.00
5: 78.27333    11.89    34.10           2.87</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Confidence and prediction intervals</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co"># Choose some specific x values for demonstration</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>x_new <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">fmin</span>(steel_data<span class="sc">$</span>hardness), <span class="fu">fmax</span>(steel_data<span class="sc">$</span>hardness), <span class="at">length.out =</span> <span class="dv">5</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co"># Confidence intervals for mean response</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>CI_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>()</span>
<span id="cb25-7"><a href="#cb25-7"></a>PI_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>()</span>
<span id="cb25-8"><a href="#cb25-8"></a></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="cf">for</span> (x0 <span class="cf">in</span> x_new) {</span>
<span id="cb25-10"><a href="#cb25-10"></a>  <span class="co"># Predicted value</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  y_hat <span class="ot">&lt;-</span> beta0_hat <span class="sc">+</span> beta1_hat <span class="sc">*</span> x0</span>
<span id="cb25-12"><a href="#cb25-12"></a></span>
<span id="cb25-13"><a href="#cb25-13"></a>  <span class="co"># Confidence interval for mean response</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>  SE_mean <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> n <span class="sc">+</span> (x0 <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Sxx))</span>
<span id="cb25-15"><a href="#cb25-15"></a>  margin_CI <span class="ot">&lt;-</span> t_critical <span class="sc">*</span> SE_mean</span>
<span id="cb25-16"><a href="#cb25-16"></a>  CI_lower <span class="ot">&lt;-</span> y_hat <span class="sc">-</span> margin_CI</span>
<span id="cb25-17"><a href="#cb25-17"></a>  CI_upper <span class="ot">&lt;-</span> y_hat <span class="sc">+</span> margin_CI</span>
<span id="cb25-18"><a href="#cb25-18"></a></span>
<span id="cb25-19"><a href="#cb25-19"></a>  <span class="co"># Prediction interval for individual observation</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>  SE_pred <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n <span class="sc">+</span> (x0 <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Sxx))</span>
<span id="cb25-21"><a href="#cb25-21"></a>  margin_PI <span class="ot">&lt;-</span> t_critical <span class="sc">*</span> SE_pred</span>
<span id="cb25-22"><a href="#cb25-22"></a>  PI_lower <span class="ot">&lt;-</span> y_hat <span class="sc">-</span> margin_PI</span>
<span id="cb25-23"><a href="#cb25-23"></a>  PI_upper <span class="ot">&lt;-</span> y_hat <span class="sc">+</span> margin_PI</span>
<span id="cb25-24"><a href="#cb25-24"></a></span>
<span id="cb25-25"><a href="#cb25-25"></a>  CI_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(CI_results, <span class="fu">data.table</span>(</span>
<span id="cb25-26"><a href="#cb25-26"></a>    <span class="at">Hardness =</span> x0,</span>
<span id="cb25-27"><a href="#cb25-27"></a>    <span class="at">Predicted =</span> <span class="fu">round</span>(y_hat, <span class="dv">2</span>),</span>
<span id="cb25-28"><a href="#cb25-28"></a>    <span class="at">CI_Lower =</span> <span class="fu">round</span>(CI_lower, <span class="dv">2</span>),</span>
<span id="cb25-29"><a href="#cb25-29"></a>    <span class="at">CI_Upper =</span> <span class="fu">round</span>(CI_upper, <span class="dv">2</span>),</span>
<span id="cb25-30"><a href="#cb25-30"></a>    <span class="at">CI_Width =</span> <span class="fu">round</span>(CI_upper <span class="sc">-</span> CI_lower, <span class="dv">2</span>)</span>
<span id="cb25-31"><a href="#cb25-31"></a>  ))</span>
<span id="cb25-32"><a href="#cb25-32"></a></span>
<span id="cb25-33"><a href="#cb25-33"></a>  PI_results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(PI_results, <span class="fu">data.table</span>(</span>
<span id="cb25-34"><a href="#cb25-34"></a>    <span class="at">Hardness =</span> x0,</span>
<span id="cb25-35"><a href="#cb25-35"></a>    <span class="at">Predicted =</span> <span class="fu">round</span>(y_hat, <span class="dv">2</span>),</span>
<span id="cb25-36"><a href="#cb25-36"></a>    <span class="at">PI_Lower =</span> <span class="fu">round</span>(PI_lower, <span class="dv">2</span>),</span>
<span id="cb25-37"><a href="#cb25-37"></a>    <span class="at">PI_Upper =</span> <span class="fu">round</span>(PI_upper, <span class="dv">2</span>),</span>
<span id="cb25-38"><a href="#cb25-38"></a>    <span class="at">PI_Width =</span> <span class="fu">round</span>(PI_upper <span class="sc">-</span> PI_lower, <span class="dv">2</span>)</span>
<span id="cb25-39"><a href="#cb25-39"></a>  ))</span>
<span id="cb25-40"><a href="#cb25-40"></a>}</span>
<span id="cb25-41"><a href="#cb25-41"></a></span>
<span id="cb25-42"><a href="#cb25-42"></a><span class="fu">print</span>(<span class="st">"95% Confidence Intervals for Mean Response:"</span>)</span>
<span id="cb25-43"><a href="#cb25-43"></a><span class="fu">print</span>(CI_results)</span>
<span id="cb25-44"><a href="#cb25-44"></a></span>
<span id="cb25-45"><a href="#cb25-45"></a><span class="fu">print</span>(<span class="st">"95% Prediction Intervals for Individual Observations:"</span>)</span>
<span id="cb25-46"><a href="#cb25-46"></a><span class="fu">print</span>(PI_results)</span>
<span id="cb25-47"><a href="#cb25-47"></a></span>
<span id="cb25-48"><a href="#cb25-48"></a><span class="co"># Compare CI and PI widths</span></span>
<span id="cb25-49"><a href="#cb25-49"></a>interval_comparison <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb25-50"><a href="#cb25-50"></a>  <span class="at">Hardness =</span> x_new,</span>
<span id="cb25-51"><a href="#cb25-51"></a>  <span class="at">CI_Width =</span> CI_results<span class="sc">$</span>CI_Width,</span>
<span id="cb25-52"><a href="#cb25-52"></a>  <span class="at">PI_Width =</span> PI_results<span class="sc">$</span>PI_Width,</span>
<span id="cb25-53"><a href="#cb25-53"></a>  <span class="at">PI_vs_CI_Ratio =</span> <span class="fu">round</span>(PI_results<span class="sc">$</span>PI_Width <span class="sc">/</span> CI_results<span class="sc">$</span>CI_Width, <span class="dv">2</span>)</span>
<span id="cb25-54"><a href="#cb25-54"></a>)</span>
<span id="cb25-55"><a href="#cb25-55"></a></span>
<span id="cb25-56"><a href="#cb25-56"></a><span class="fu">print</span>(<span class="st">"Interval Width Comparison:"</span>)</span>
<span id="cb25-57"><a href="#cb25-57"></a><span class="fu">print</span>(interval_comparison)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Confidence and prediction intervals"><img src="Ch06_files/figure-html/fig-Ch06Code02-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Confidence and prediction intervals
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Confidence and prediction intervals visualization</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co"># Create fine grid for smooth curves</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>x_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">fmin</span>(steel_data<span class="sc">$</span>hardness), <span class="fu">fmax</span>(steel_data<span class="sc">$</span>hardness), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a>interval_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>()</span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="cf">for</span> (x0 <span class="cf">in</span> x_grid) {</span>
<span id="cb26-7"><a href="#cb26-7"></a>  y_hat <span class="ot">&lt;-</span> beta0_hat <span class="sc">+</span> beta1_hat <span class="sc">*</span> x0</span>
<span id="cb26-8"><a href="#cb26-8"></a></span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="co"># Confidence interval</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  SE_mean <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> n <span class="sc">+</span> (x0 <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Sxx))</span>
<span id="cb26-11"><a href="#cb26-11"></a>  CI_lower <span class="ot">&lt;-</span> y_hat <span class="sc">-</span> t_critical <span class="sc">*</span> SE_mean</span>
<span id="cb26-12"><a href="#cb26-12"></a>  CI_upper <span class="ot">&lt;-</span> y_hat <span class="sc">+</span> t_critical <span class="sc">*</span> SE_mean</span>
<span id="cb26-13"><a href="#cb26-13"></a></span>
<span id="cb26-14"><a href="#cb26-14"></a>  <span class="co"># Prediction interval</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>  SE_pred <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> n <span class="sc">+</span> (x0 <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Sxx))</span>
<span id="cb26-16"><a href="#cb26-16"></a>  PI_lower <span class="ot">&lt;-</span> y_hat <span class="sc">-</span> t_critical <span class="sc">*</span> SE_pred</span>
<span id="cb26-17"><a href="#cb26-17"></a>  PI_upper <span class="ot">&lt;-</span> y_hat <span class="sc">+</span> t_critical <span class="sc">*</span> SE_pred</span>
<span id="cb26-18"><a href="#cb26-18"></a></span>
<span id="cb26-19"><a href="#cb26-19"></a>  interval_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(interval_data, <span class="fu">data.table</span>(</span>
<span id="cb26-20"><a href="#cb26-20"></a>    <span class="at">hardness =</span> x0,</span>
<span id="cb26-21"><a href="#cb26-21"></a>    <span class="at">fitted =</span> y_hat,</span>
<span id="cb26-22"><a href="#cb26-22"></a>    <span class="at">CI_lower =</span> CI_lower,</span>
<span id="cb26-23"><a href="#cb26-23"></a>    <span class="at">CI_upper =</span> CI_upper,</span>
<span id="cb26-24"><a href="#cb26-24"></a>    <span class="at">PI_lower =</span> PI_lower,</span>
<span id="cb26-25"><a href="#cb26-25"></a>    <span class="at">PI_upper =</span> PI_upper</span>
<span id="cb26-26"><a href="#cb26-26"></a>  ))</span>
<span id="cb26-27"><a href="#cb26-27"></a>}</span>
<span id="cb26-28"><a href="#cb26-28"></a></span>
<span id="cb26-29"><a href="#cb26-29"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb26-30"><a href="#cb26-30"></a>  <span class="co"># Prediction intervals (wider, lighter)</span></span>
<span id="cb26-31"><a href="#cb26-31"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb26-32"><a href="#cb26-32"></a>    <span class="at">data =</span> interval_data, <span class="fu">aes</span>(<span class="at">x =</span> hardness, <span class="at">ymin =</span> PI_lower, <span class="at">ymax =</span> PI_upper),</span>
<span id="cb26-33"><a href="#cb26-33"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"red"</span></span>
<span id="cb26-34"><a href="#cb26-34"></a>  ) <span class="sc">+</span></span>
<span id="cb26-35"><a href="#cb26-35"></a>  <span class="co"># Confidence intervals (narrower, darker)</span></span>
<span id="cb26-36"><a href="#cb26-36"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb26-37"><a href="#cb26-37"></a>    <span class="at">data =</span> interval_data, <span class="fu">aes</span>(<span class="at">x =</span> hardness, <span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper),</span>
<span id="cb26-38"><a href="#cb26-38"></a>    <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">fill =</span> <span class="st">"blue"</span></span>
<span id="cb26-39"><a href="#cb26-39"></a>  ) <span class="sc">+</span></span>
<span id="cb26-40"><a href="#cb26-40"></a>  <span class="co"># Regression line</span></span>
<span id="cb26-41"><a href="#cb26-41"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> interval_data, <span class="fu">aes</span>(<span class="at">x =</span> hardness, <span class="at">y =</span> fitted), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-42"><a href="#cb26-42"></a>  <span class="co"># Data points</span></span>
<span id="cb26-43"><a href="#cb26-43"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> steel_data, <span class="fu">aes</span>(<span class="at">x =</span> hardness, <span class="at">y =</span> strength), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb26-44"><a href="#cb26-44"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-45"><a href="#cb26-45"></a>    <span class="at">x =</span> <span class="st">"Hardness"</span>,</span>
<span id="cb26-46"><a href="#cb26-46"></a>    <span class="at">y =</span> <span class="st">"Tensile Strength"</span>,</span>
<span id="cb26-47"><a href="#cb26-47"></a>    <span class="at">title =</span> <span class="st">"Confidence and Prediction Intervals"</span>,</span>
<span id="cb26-48"><a href="#cb26-48"></a>    <span class="at">subtitle =</span> <span class="st">"Blue = 95% CI for mean response, Red = 95% PI for individual observations"</span></span>
<span id="cb26-49"><a href="#cb26-49"></a>  ) <span class="sc">+</span></span>
<span id="cb26-50"><a href="#cb26-50"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb26-51"><a href="#cb26-51"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-52"><a href="#cb26-52"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb26-53"><a href="#cb26-53"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb26-54"><a href="#cb26-54"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="checking-model-adequacy" class="level3" data-number="1.2.8">
<h3 data-number="1.2.8" class="anchored" data-anchor-id="checking-model-adequacy"><span class="header-section-number">1.2.8</span> Checking Model Adequacy</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Residual Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Residuals:</strong> <span class="math inline">e_i = y_i - \hat{y}_i</span></p>
<p><strong>Standardized Residuals:</strong> <span class="math inline">d_i = \frac{e_i}{\sqrt{MS_E}}</span></p>
<p><strong>Studentized Residuals:</strong> More accurate for outlier detection</p>
<p><strong>Key Diagnostic Plots:</strong></p>
<ol type="1">
<li><p><strong>Residuals vs.&nbsp;Fitted Values:</strong> Check for constant variance</p></li>
<li><p><strong>Normal Q-Q Plot:</strong> Check normality assumption</p></li>
<li><p><strong>Residuals vs.&nbsp;Order:</strong> Check for independence</p></li>
<li><p><strong>Residuals vs.&nbsp;Predictor:</strong> Check linearity assumption</p></li>
</ol>
<p><strong>What to Look For:</strong></p>
<ul>
<li><p>Random scatter (no patterns)</p></li>
<li><p>Constant spread across fitted values</p></li>
<li><p>Points following straight line in Q-Q plot</p></li>
<li><p>No obvious trends or cycles</p></li>
</ul>
</div>
</div>
</section>
<section id="example-model-diagnostics" class="level3" data-number="1.2.9">
<h3 data-number="1.2.9" class="anchored" data-anchor-id="example-model-diagnostics"><span class="header-section-number">1.2.9</span> Example: Model Diagnostics</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Residual Analysis Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mean_Residuals SD_Residuals Min_Residuals Max_Residuals Mean_Std_Residuals
            &lt;num&gt;        &lt;num&gt;         &lt;num&gt;         &lt;num&gt;              &lt;num&gt;
1:   7.105427e-15     7.403595     -11.27576      15.14077       9.325873e-16
   SD_Std_Residuals
              &lt;num&gt;
1:        0.9733285</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "No obvious outliers detected (|std residual| &gt; 2)"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Shapiro-Wilk normality test for residuals:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals
W = 0.96347, p-value = 0.6152</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Durbin-Watson statistic: 1.7519"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(Values near 2 indicate no autocorrelation)"</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Model adequacy checking - residual analysis</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co"># Calculate residuals and standardized residuals</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>residuals_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="at">fitted =</span> fitted_values,</span>
<span id="cb34-5"><a href="#cb34-5"></a>  <span class="at">residuals =</span> residuals,</span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="at">standardized_residuals =</span> residuals <span class="sc">/</span> <span class="fu">sqrt</span>(MSE),</span>
<span id="cb34-7"><a href="#cb34-7"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb34-8"><a href="#cb34-8"></a>  <span class="at">hardness =</span> steel_data<span class="sc">$</span>hardness</span>
<span id="cb34-9"><a href="#cb34-9"></a>)</span>
<span id="cb34-10"><a href="#cb34-10"></a></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="co"># Summary statistics for residuals</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>residual_summary <span class="ot">&lt;-</span> residuals_data <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb34-14"><a href="#cb34-14"></a>    <span class="at">Mean_Residuals =</span> <span class="fu">fmean</span>(residuals),</span>
<span id="cb34-15"><a href="#cb34-15"></a>    <span class="at">SD_Residuals =</span> <span class="fu">fsd</span>(residuals),</span>
<span id="cb34-16"><a href="#cb34-16"></a>    <span class="at">Min_Residuals =</span> <span class="fu">fmin</span>(residuals),</span>
<span id="cb34-17"><a href="#cb34-17"></a>    <span class="at">Max_Residuals =</span> <span class="fu">fmax</span>(residuals),</span>
<span id="cb34-18"><a href="#cb34-18"></a>    <span class="at">Mean_Std_Residuals =</span> <span class="fu">fmean</span>(standardized_residuals),</span>
<span id="cb34-19"><a href="#cb34-19"></a>    <span class="at">SD_Std_Residuals =</span> <span class="fu">fsd</span>(standardized_residuals)</span>
<span id="cb34-20"><a href="#cb34-20"></a>  )</span>
<span id="cb34-21"><a href="#cb34-21"></a></span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="fu">print</span>(<span class="st">"Residual Analysis Summary:"</span>)</span>
<span id="cb34-23"><a href="#cb34-23"></a><span class="fu">print</span>(residual_summary)</span>
<span id="cb34-24"><a href="#cb34-24"></a></span>
<span id="cb34-25"><a href="#cb34-25"></a><span class="co"># Check for outliers (|standardized residual| &gt; 2)</span></span>
<span id="cb34-26"><a href="#cb34-26"></a>outliers <span class="ot">&lt;-</span> residuals_data[<span class="fu">abs</span>(standardized_residuals) <span class="sc">&gt;</span> <span class="dv">2</span>]</span>
<span id="cb34-27"><a href="#cb34-27"></a><span class="cf">if</span> (<span class="fu">nrow</span>(outliers) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb34-28"><a href="#cb34-28"></a>  <span class="fu">print</span>(<span class="st">"Potential outliers (|std residual| &gt; 2):"</span>)</span>
<span id="cb34-29"><a href="#cb34-29"></a>  <span class="fu">print</span>(outliers)</span>
<span id="cb34-30"><a href="#cb34-30"></a>} <span class="cf">else</span> {</span>
<span id="cb34-31"><a href="#cb34-31"></a>  <span class="fu">print</span>(<span class="st">"No obvious outliers detected (|std residual| &gt; 2)"</span>)</span>
<span id="cb34-32"><a href="#cb34-32"></a>}</span>
<span id="cb34-33"><a href="#cb34-33"></a></span>
<span id="cb34-34"><a href="#cb34-34"></a><span class="co"># Normality test for residuals</span></span>
<span id="cb34-35"><a href="#cb34-35"></a>shapiro_test <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(residuals)</span>
<span id="cb34-36"><a href="#cb34-36"></a><span class="fu">print</span>(<span class="st">"Shapiro-Wilk normality test for residuals:"</span>)</span>
<span id="cb34-37"><a href="#cb34-37"></a><span class="fu">print</span>(shapiro_test)</span>
<span id="cb34-38"><a href="#cb34-38"></a></span>
<span id="cb34-39"><a href="#cb34-39"></a><span class="co"># Durbin-Watson test for independence (if data has natural order)</span></span>
<span id="cb34-40"><a href="#cb34-40"></a>dw_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diff</span>(residuals)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb34-41"><a href="#cb34-41"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Durbin-Watson statistic:"</span>, <span class="fu">round</span>(dw_stat, <span class="dv">4</span>)))</span>
<span id="cb34-42"><a href="#cb34-42"></a><span class="fu">print</span>(<span class="st">"(Values near 2 indicate no autocorrelation)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Residual analysis plots"><img src="Ch06_files/figure-html/fig-Ch06Code03-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Residual analysis plots
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Residual analysis plots</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="co"># 1. Residuals vs Fitted</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> residuals_data, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">title =</span> <span class="st">"Residuals vs Fitted"</span>) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb35-10"><a href="#cb35-10"></a></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="co"># 2. Normal Q-Q plot</span></span>
<span id="cb35-12"><a href="#cb35-12"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> residuals_data, <span class="fu">aes</span>(<span class="at">sample =</span> standardized_residuals)) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb35-14"><a href="#cb35-14"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-15"><a href="#cb35-15"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-16"><a href="#cb35-16"></a>    <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Sample Quantiles"</span>,</span>
<span id="cb35-17"><a href="#cb35-17"></a>    <span class="at">title =</span> <span class="st">"Normal Q-Q Plot of Residuals"</span></span>
<span id="cb35-18"><a href="#cb35-18"></a>  ) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb35-21"><a href="#cb35-21"></a></span>
<span id="cb35-22"><a href="#cb35-22"></a><span class="co"># 3. Scale-location plot</span></span>
<span id="cb35-23"><a href="#cb35-23"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> residuals_data, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(standardized_residuals)))) <span class="sc">+</span></span>
<span id="cb35-24"><a href="#cb35-24"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb35-25"><a href="#cb35-25"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-26"><a href="#cb35-26"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-27"><a href="#cb35-27"></a>    <span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"√|Standardized Residuals|"</span>,</span>
<span id="cb35-28"><a href="#cb35-28"></a>    <span class="at">title =</span> <span class="st">"Scale-Location Plot"</span></span>
<span id="cb35-29"><a href="#cb35-29"></a>  ) <span class="sc">+</span></span>
<span id="cb35-30"><a href="#cb35-30"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb35-31"><a href="#cb35-31"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb35-32"><a href="#cb35-32"></a></span>
<span id="cb35-33"><a href="#cb35-33"></a><span class="co"># 4. Residuals vs Order</span></span>
<span id="cb35-34"><a href="#cb35-34"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> residuals_data, <span class="fu">aes</span>(<span class="at">x =</span> observation, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb35-35"><a href="#cb35-35"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb35-36"><a href="#cb35-36"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb35-37"><a href="#cb35-37"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb35-38"><a href="#cb35-38"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Observation Order"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">title =</span> <span class="st">"Residuals vs Order"</span>) <span class="sc">+</span></span>
<span id="cb35-39"><a href="#cb35-39"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb35-40"><a href="#cb35-40"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb35-41"><a href="#cb35-41"></a></span>
<span id="cb35-42"><a href="#cb35-42"></a><span class="co"># Combine all diagnostic plots</span></span>
<span id="cb35-43"><a href="#cb35-43"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="correlation-and-regression" class="level3" data-number="1.2.10">
<h3 data-number="1.2.10" class="anchored" data-anchor-id="correlation-and-regression"><span class="header-section-number">1.2.10</span> Correlation and Regression</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Correlation vs.&nbsp;Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Correlation Coefficient:</strong></p>
<p><span class="math display">r = \frac{S_{xy}}{\sqrt{S_{xx} S_{yy}}}</span></p>
<p><strong>Relationship to Regression:</strong></p>
<ul>
<li><p><span class="math inline">R^2 = r^2</span> in simple linear regression</p></li>
<li><p>Correlation measures <strong>strength</strong> of linear relationship</p></li>
<li><p>Regression provides <strong>prediction equation</strong></p></li>
</ul>
<p><strong>Important Notes:</strong></p>
<ul>
<li><p>Correlation ≠ Causation</p></li>
<li><p>Both assume linear relationship</p></li>
<li><p>Sensitive to outliers</p></li>
<li><p><span class="math inline">-1 \leq r \leq 1</span></p></li>
</ul>
<p><strong>Interpretation of |r|:</strong></p>
<ul>
<li><p>0.0-0.3: Weak relationship</p></li>
<li><p>0.3-0.7: Moderate relationship</p></li>
<li><p>0.7-1.0: Strong relationship</p></li>
</ul>
</div>
</div>
</section>
<section id="example-correlation-analysis" class="level3" data-number="1.2.11">
<h3 data-number="1.2.11" class="anchored" data-anchor-id="example-correlation-analysis"><span class="header-section-number">1.2.11</span> Example: Correlation Analysis</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation vs Regression Analysis:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Measure  Value                          Interpretation
                        &lt;char&gt;  &lt;num&gt;                                  &lt;char&gt;
1: Correlation coefficient (r) 0.9669              Strong linear relationship
2:                          r² 0.9349                  93.5 % shared variance
3:          R² from regression 0.9349 93.5 % variance explained by regression
4:        Difference |r² - R²| 0.0000                       Perfect agreement</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation Significance Test:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Test                             H0 t_statistic p_value
                     &lt;char&gt;                         &lt;char&gt;       &lt;num&gt;   &lt;num&gt;
1: Correlation significance ρ = 0 (no linear relationship)     16.0739       0
    decision              conclusion
      &lt;char&gt;                  &lt;char&gt;
1: Reject H₀ Significant correlation</code></pre>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># Correlation analysis</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>correlation_coef <span class="ot">&lt;-</span> <span class="fu">cor</span>(steel_data<span class="sc">$</span>hardness, steel_data<span class="sc">$</span>strength)</span>
<span id="cb40-3"><a href="#cb40-3"></a>correlation_squared <span class="ot">&lt;-</span> correlation_coef<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co"># Verify relationship between correlation and R-squared</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>correlation_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="at">Measure =</span> <span class="fu">c</span>(<span class="st">"Correlation coefficient (r)"</span>, <span class="st">"r²"</span>, <span class="st">"R² from regression"</span>, <span class="st">"Difference |r² - R²|"</span>),</span>
<span id="cb40-8"><a href="#cb40-8"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb40-9"><a href="#cb40-9"></a>    <span class="fu">round</span>(correlation_coef, <span class="dv">4</span>),</span>
<span id="cb40-10"><a href="#cb40-10"></a>    <span class="fu">round</span>(correlation_squared, <span class="dv">4</span>),</span>
<span id="cb40-11"><a href="#cb40-11"></a>    <span class="fu">round</span>(R_squared, <span class="dv">4</span>),</span>
<span id="cb40-12"><a href="#cb40-12"></a>    <span class="fu">round</span>(<span class="fu">abs</span>(correlation_squared <span class="sc">-</span> R_squared), <span class="dv">6</span>)</span>
<span id="cb40-13"><a href="#cb40-13"></a>  ),</span>
<span id="cb40-14"><a href="#cb40-14"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb40-15"><a href="#cb40-15"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(correlation_coef) <span class="sc">&gt;</span> <span class="fl">0.7</span>, <span class="st">"Strong linear relationship"</span>,</span>
<span id="cb40-16"><a href="#cb40-16"></a>      <span class="fu">ifelse</span>(<span class="fu">abs</span>(correlation_coef) <span class="sc">&gt;</span> <span class="fl">0.3</span>, <span class="st">"Moderate linear relationship"</span>, <span class="st">"Weak linear relationship"</span>)</span>
<span id="cb40-17"><a href="#cb40-17"></a>    ),</span>
<span id="cb40-18"><a href="#cb40-18"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(correlation_squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% shared variance"</span>),</span>
<span id="cb40-19"><a href="#cb40-19"></a>    <span class="fu">paste</span>(<span class="fu">round</span>(R_squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"% variance explained by regression"</span>),</span>
<span id="cb40-20"><a href="#cb40-20"></a>    <span class="fu">ifelse</span>(<span class="fu">abs</span>(correlation_squared <span class="sc">-</span> R_squared) <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"Perfect agreement"</span>, <span class="st">"Some difference"</span>)</span>
<span id="cb40-21"><a href="#cb40-21"></a>  )</span>
<span id="cb40-22"><a href="#cb40-22"></a>)</span>
<span id="cb40-23"><a href="#cb40-23"></a></span>
<span id="cb40-24"><a href="#cb40-24"></a><span class="fu">print</span>(<span class="st">"Correlation vs Regression Analysis:"</span>)</span>
<span id="cb40-25"><a href="#cb40-25"></a><span class="fu">print</span>(correlation_results)</span>
<span id="cb40-26"><a href="#cb40-26"></a></span>
<span id="cb40-27"><a href="#cb40-27"></a><span class="co"># Test significance of correlation</span></span>
<span id="cb40-28"><a href="#cb40-28"></a>t_stat_cor <span class="ot">&lt;-</span> correlation_coef <span class="sc">*</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> correlation_coef<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb40-29"><a href="#cb40-29"></a>p_value_cor <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stat_cor), n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb40-30"><a href="#cb40-30"></a></span>
<span id="cb40-31"><a href="#cb40-31"></a>correlation_test <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb40-32"><a href="#cb40-32"></a>  <span class="at">Test =</span> <span class="st">"Correlation significance"</span>,</span>
<span id="cb40-33"><a href="#cb40-33"></a>  <span class="at">H0 =</span> <span class="st">"ρ = 0 (no linear relationship)"</span>,</span>
<span id="cb40-34"><a href="#cb40-34"></a>  <span class="at">t_statistic =</span> <span class="fu">round</span>(t_stat_cor, <span class="dv">4</span>),</span>
<span id="cb40-35"><a href="#cb40-35"></a>  <span class="at">p_value =</span> <span class="fu">round</span>(p_value_cor, <span class="dv">4</span>),</span>
<span id="cb40-36"><a href="#cb40-36"></a>  <span class="at">decision =</span> <span class="fu">ifelse</span>(p_value_cor <span class="sc">&lt;</span> alpha, <span class="st">"Reject H₀"</span>, <span class="st">"Fail to reject H₀"</span>),</span>
<span id="cb40-37"><a href="#cb40-37"></a>  <span class="at">conclusion =</span> <span class="fu">ifelse</span>(p_value_cor <span class="sc">&lt;</span> alpha, <span class="st">"Significant correlation"</span>, <span class="st">"No significant correlation"</span>)</span>
<span id="cb40-38"><a href="#cb40-38"></a>)</span>
<span id="cb40-39"><a href="#cb40-39"></a></span>
<span id="cb40-40"><a href="#cb40-40"></a><span class="fu">print</span>(<span class="st">"Correlation Significance Test:"</span>)</span>
<span id="cb40-41"><a href="#cb40-41"></a><span class="fu">print</span>(correlation_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="multiple-regression" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="multiple-regression"><span class="header-section-number">1.3</span> Multiple Regression</h2>
<section id="estimation-of-parameters-in-multiple-regression" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="estimation-of-parameters-in-multiple-regression"><span class="header-section-number">1.3.1</span> Estimation of Parameters in Multiple Regression</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Multiple Linear Regression Model
</div>
</div>
<div class="callout-body-container callout-body">
<p>The multiple regression model with k predictors:</p>
<p><span class="math display">y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \ldots + \beta_k x_{ik} + \epsilon_i</span></p>
<p><strong>Matrix Form:</strong></p>
<p><span class="math display">\mathbf{y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}</span></p>
<p>where:</p>
<p><span class="math display">\mathbf{X} = \begin{bmatrix}
1 &amp; x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1k} \\
1 &amp; x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2k} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{nk}
\end{bmatrix}</span></p>
<p><strong>Least Squares Solution:</strong></p>
<p><span class="math display">\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}</span></p>
<p><strong>Properties:</strong></p>
<ul>
<li><p>Unbiased: <span class="math inline">E[\hat{\boldsymbol{\beta}}] = \boldsymbol{\beta}</span></p></li>
<li><p>Minimum variance among linear unbiased estimators</p></li>
<li><p>Normally distributed under normality assumption</p></li>
</ul>
</div>
</div>
</section>
<section id="example-chemical-process-yield" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="example-chemical-process-yield"><span class="header-section-number">1.3.2</span> Example: Chemical Process Yield</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A chemical engineer studies how reaction temperature and catalyst concentration affect yield:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false"></a><a href="data/chemical_yield.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chemical Process Data Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       n Temp_Mean  Temp_SD Conc_Mean  Conc_SD Yield_Mean Yield_SD
   &lt;int&gt;     &lt;num&gt;    &lt;num&gt;     &lt;num&gt;    &lt;num&gt;      &lt;num&gt;    &lt;num&gt;
1:    25  175.6184 13.62157  21.08764 6.724034   192.3572 14.55564</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation Matrix:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>              temperature concentration  yield
temperature        1.0000       -0.0674 0.7262
concentration     -0.0674        1.0000 0.5652
yield              0.7262        0.5652 1.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Multiple regression example - Chemical process yield</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a>chemical_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="at">run =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="at">temperature =</span> <span class="fu">runif</span>(<span class="dv">25</span>, <span class="at">min =</span> <span class="dv">150</span>, <span class="at">max =</span> <span class="dv">200</span>),</span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="at">concentration =</span> <span class="fu">runif</span>(<span class="dv">25</span>, <span class="at">min =</span> <span class="dv">10</span>, <span class="at">max =</span> <span class="dv">30</span>),</span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="at">yield =</span> <span class="cn">NULL</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>)</span>
<span id="cb45-9"><a href="#cb45-9"></a></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co"># Create realistic multiple regression relationship</span></span>
<span id="cb45-11"><a href="#cb45-11"></a>chemical_data[, yield <span class="sc">:</span><span class="er">=</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> temperature <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> concentration <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)]</span>
<span id="cb45-12"><a href="#cb45-12"></a></span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="co"># Summary statistics</span></span>
<span id="cb45-14"><a href="#cb45-14"></a>chemical_summary <span class="ot">&lt;-</span> chemical_data <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="#cb45-15"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb45-16"><a href="#cb45-16"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(run),</span>
<span id="cb45-17"><a href="#cb45-17"></a>    <span class="at">Temp_Mean =</span> <span class="fu">fmean</span>(temperature),</span>
<span id="cb45-18"><a href="#cb45-18"></a>    <span class="at">Temp_SD =</span> <span class="fu">fsd</span>(temperature),</span>
<span id="cb45-19"><a href="#cb45-19"></a>    <span class="at">Conc_Mean =</span> <span class="fu">fmean</span>(concentration),</span>
<span id="cb45-20"><a href="#cb45-20"></a>    <span class="at">Conc_SD =</span> <span class="fu">fsd</span>(concentration),</span>
<span id="cb45-21"><a href="#cb45-21"></a>    <span class="at">Yield_Mean =</span> <span class="fu">fmean</span>(yield),</span>
<span id="cb45-22"><a href="#cb45-22"></a>    <span class="at">Yield_SD =</span> <span class="fu">fsd</span>(yield)</span>
<span id="cb45-23"><a href="#cb45-23"></a>  )</span>
<span id="cb45-24"><a href="#cb45-24"></a></span>
<span id="cb45-25"><a href="#cb45-25"></a><span class="fu">print</span>(<span class="st">"Chemical Process Data Summary:"</span>)</span>
<span id="cb45-26"><a href="#cb45-26"></a><span class="fu">print</span>(chemical_summary)</span>
<span id="cb45-27"><a href="#cb45-27"></a></span>
<span id="cb45-28"><a href="#cb45-28"></a><span class="co"># Correlation matrix</span></span>
<span id="cb45-29"><a href="#cb45-29"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(chemical_data[, .(temperature, concentration, yield)])</span>
<span id="cb45-30"><a href="#cb45-30"></a><span class="fu">print</span>(<span class="st">"Correlation Matrix:"</span>)</span>
<span id="cb45-31"><a href="#cb45-31"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix, <span class="dv">4</span>))</span>
<span id="cb45-32"><a href="#cb45-32"></a></span>
<span id="cb45-33"><a href="#cb45-33"></a><span class="co"># Write data to CSV</span></span>
<span id="cb45-34"><a href="#cb45-34"></a><span class="fu">fwrite</span>(chemical_data, <span class="st">"data/chemical_yield.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">

</div>
</div>
</div>
<p><strong>Multiple Regression Model:</strong></p>
<p><span class="math display">Yield = \beta_0 + \beta_1 \times Temperature + \beta_2 \times Concentration + \epsilon</span></p>
<p><strong>Manual Matrix Calculation:</strong></p>
<ol type="1">
<li><p><strong>Design Matrix X:</strong> <span class="math display">\mathbf{X} = \begin{bmatrix}
1 &amp; x_{1,temp} &amp; x_{1,conc} \\
1 &amp; x_{2,temp} &amp; x_{2,conc} \\
\vdots &amp; \vdots &amp; \vdots \\
1 &amp; x_{n,temp} &amp; x_{n,conc}
\end{bmatrix}</span></p></li>
<li><p><strong>Parameter Estimates:</strong> <span class="math display">\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}</span></p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Manual Multiple Regression Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            Parameter Estimate Std_Error t_value p_value
               &lt;char&gt;    &lt;num&gt;     &lt;num&gt;   &lt;num&gt;   &lt;num&gt;
1:     β₀ (Intercept)  20.1051   12.8589  1.5635  0.1322
2:   β₁ (Temperature)   0.8205    0.0699 11.7400  0.0000
3: β₂ (Concentration)   1.3355    0.1416  9.4333  0.0000</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model Summary Statistics:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     Statistic    Value
        &lt;char&gt;    &lt;num&gt;
1:          R²   0.9063
2: Adjusted R²   0.8978
3: Residual SE   4.6530
4: F-statistic 106.4279</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R's lm() verification:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ temperature + concentration, data = chemical_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.6632 -1.8041 -0.8522  1.3582 10.2857 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   20.10507   12.85893   1.564    0.132    
temperature    0.82047    0.06989  11.740 6.05e-11 ***
concentration  1.33553    0.14158   9.433 3.45e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.653 on 22 degrees of freedom
Multiple R-squared:  0.9063,    Adjusted R-squared:  0.8978 
F-statistic: 106.4 on 2 and 22 DF,  p-value: 4.873e-12</code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># Multiple regression - manual matrix calculations</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="co"># Design matrix X</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>n_multi <span class="ot">&lt;-</span> <span class="fu">nrow</span>(chemical_data)</span>
<span id="cb52-4"><a href="#cb52-4"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, chemical_data<span class="sc">$</span>temperature, chemical_data<span class="sc">$</span>concentration)</span>
<span id="cb52-5"><a href="#cb52-5"></a>y <span class="ot">&lt;-</span> chemical_data<span class="sc">$</span>yield</span>
<span id="cb52-6"><a href="#cb52-6"></a></span>
<span id="cb52-7"><a href="#cb52-7"></a><span class="co"># Manual matrix calculations</span></span>
<span id="cb52-8"><a href="#cb52-8"></a>XtX <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> X</span>
<span id="cb52-9"><a href="#cb52-9"></a>Xty <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb52-10"><a href="#cb52-10"></a>beta_hat <span class="ot">&lt;-</span> <span class="fu">solve</span>(XtX) <span class="sc">%*%</span> Xty</span>
<span id="cb52-11"><a href="#cb52-11"></a></span>
<span id="cb52-12"><a href="#cb52-12"></a><span class="co"># Extract coefficients</span></span>
<span id="cb52-13"><a href="#cb52-13"></a>beta0_multi <span class="ot">&lt;-</span> beta_hat[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb52-14"><a href="#cb52-14"></a>beta1_multi <span class="ot">&lt;-</span> beta_hat[<span class="dv">2</span>, <span class="dv">1</span>]</span>
<span id="cb52-15"><a href="#cb52-15"></a>beta2_multi <span class="ot">&lt;-</span> beta_hat[<span class="dv">3</span>, <span class="dv">1</span>]</span>
<span id="cb52-16"><a href="#cb52-16"></a></span>
<span id="cb52-17"><a href="#cb52-17"></a><span class="co"># Calculate fitted values and residuals</span></span>
<span id="cb52-18"><a href="#cb52-18"></a>y_fitted <span class="ot">&lt;-</span> X <span class="sc">%*%</span> beta_hat</span>
<span id="cb52-19"><a href="#cb52-19"></a>residuals_multi <span class="ot">&lt;-</span> y <span class="sc">-</span> y_fitted</span>
<span id="cb52-20"><a href="#cb52-20"></a></span>
<span id="cb52-21"><a href="#cb52-21"></a><span class="co"># Sum of squares</span></span>
<span id="cb52-22"><a href="#cb52-22"></a>SST_multi <span class="ot">&lt;-</span> <span class="fu">sum</span>((y <span class="sc">-</span> <span class="fu">mean</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-23"><a href="#cb52-23"></a>SSE_multi <span class="ot">&lt;-</span> <span class="fu">sum</span>(residuals_multi<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-24"><a href="#cb52-24"></a>SSR_multi <span class="ot">&lt;-</span> SST_multi <span class="sc">-</span> SSE_multi</span>
<span id="cb52-25"><a href="#cb52-25"></a></span>
<span id="cb52-26"><a href="#cb52-26"></a><span class="co"># Degrees of freedom</span></span>
<span id="cb52-27"><a href="#cb52-27"></a>k <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># number of predictors</span></span>
<span id="cb52-28"><a href="#cb52-28"></a>df_regression <span class="ot">&lt;-</span> k</span>
<span id="cb52-29"><a href="#cb52-29"></a>df_error_multi <span class="ot">&lt;-</span> n_multi <span class="sc">-</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb52-30"><a href="#cb52-30"></a>df_total <span class="ot">&lt;-</span> n_multi <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb52-31"><a href="#cb52-31"></a></span>
<span id="cb52-32"><a href="#cb52-32"></a><span class="co"># Mean squares</span></span>
<span id="cb52-33"><a href="#cb52-33"></a>MSR_multi <span class="ot">&lt;-</span> SSR_multi <span class="sc">/</span> df_regression</span>
<span id="cb52-34"><a href="#cb52-34"></a>MSE_multi <span class="ot">&lt;-</span> SSE_multi <span class="sc">/</span> df_error_multi</span>
<span id="cb52-35"><a href="#cb52-35"></a></span>
<span id="cb52-36"><a href="#cb52-36"></a><span class="co"># R-squared and adjusted R-squared</span></span>
<span id="cb52-37"><a href="#cb52-37"></a>R_squared_multi <span class="ot">&lt;-</span> SSR_multi <span class="sc">/</span> SST_multi</span>
<span id="cb52-38"><a href="#cb52-38"></a>R_squared_adj <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (SSE_multi <span class="sc">/</span> df_error_multi) <span class="sc">/</span> (SST_multi <span class="sc">/</span> df_total)</span>
<span id="cb52-39"><a href="#cb52-39"></a></span>
<span id="cb52-40"><a href="#cb52-40"></a><span class="co"># Standard errors of coefficients</span></span>
<span id="cb52-41"><a href="#cb52-41"></a>var_covar_matrix <span class="ot">&lt;-</span> MSE_multi <span class="sc">*</span> <span class="fu">solve</span>(XtX)</span>
<span id="cb52-42"><a href="#cb52-42"></a>SE_beta0_multi <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_covar_matrix[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb52-43"><a href="#cb52-43"></a>SE_beta1_multi <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_covar_matrix[<span class="dv">2</span>, <span class="dv">2</span>])</span>
<span id="cb52-44"><a href="#cb52-44"></a>SE_beta2_multi <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_covar_matrix[<span class="dv">3</span>, <span class="dv">3</span>])</span>
<span id="cb52-45"><a href="#cb52-45"></a></span>
<span id="cb52-46"><a href="#cb52-46"></a><span class="co"># Manual multiple regression results</span></span>
<span id="cb52-47"><a href="#cb52-47"></a>multiple_manual_results <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb52-48"><a href="#cb52-48"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"β₀ (Intercept)"</span>, <span class="st">"β₁ (Temperature)"</span>, <span class="st">"β₂ (Concentration)"</span>),</span>
<span id="cb52-49"><a href="#cb52-49"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="fu">round</span>(beta0_multi, <span class="dv">4</span>), <span class="fu">round</span>(beta1_multi, <span class="dv">4</span>), <span class="fu">round</span>(beta2_multi, <span class="dv">4</span>)),</span>
<span id="cb52-50"><a href="#cb52-50"></a>  <span class="at">Std_Error =</span> <span class="fu">c</span>(<span class="fu">round</span>(SE_beta0_multi, <span class="dv">4</span>), <span class="fu">round</span>(SE_beta1_multi, <span class="dv">4</span>), <span class="fu">round</span>(SE_beta2_multi, <span class="dv">4</span>)),</span>
<span id="cb52-51"><a href="#cb52-51"></a>  <span class="at">t_value =</span> <span class="fu">c</span>(</span>
<span id="cb52-52"><a href="#cb52-52"></a>    <span class="fu">round</span>(beta0_multi <span class="sc">/</span> SE_beta0_multi, <span class="dv">4</span>),</span>
<span id="cb52-53"><a href="#cb52-53"></a>    <span class="fu">round</span>(beta1_multi <span class="sc">/</span> SE_beta1_multi, <span class="dv">4</span>),</span>
<span id="cb52-54"><a href="#cb52-54"></a>    <span class="fu">round</span>(beta2_multi <span class="sc">/</span> SE_beta2_multi, <span class="dv">4</span>)</span>
<span id="cb52-55"><a href="#cb52-55"></a>  ),</span>
<span id="cb52-56"><a href="#cb52-56"></a>  <span class="at">p_value =</span> <span class="fu">c</span>(</span>
<span id="cb52-57"><a href="#cb52-57"></a>    <span class="fu">round</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(beta0_multi <span class="sc">/</span> SE_beta0_multi), df_error_multi)), <span class="dv">4</span>),</span>
<span id="cb52-58"><a href="#cb52-58"></a>    <span class="fu">round</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(beta1_multi <span class="sc">/</span> SE_beta1_multi), df_error_multi)), <span class="dv">4</span>),</span>
<span id="cb52-59"><a href="#cb52-59"></a>    <span class="fu">round</span>(<span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(beta2_multi <span class="sc">/</span> SE_beta2_multi), df_error_multi)), <span class="dv">4</span>)</span>
<span id="cb52-60"><a href="#cb52-60"></a>  )</span>
<span id="cb52-61"><a href="#cb52-61"></a>)</span>
<span id="cb52-62"><a href="#cb52-62"></a></span>
<span id="cb52-63"><a href="#cb52-63"></a><span class="fu">print</span>(<span class="st">"Manual Multiple Regression Results:"</span>)</span>
<span id="cb52-64"><a href="#cb52-64"></a><span class="fu">print</span>(multiple_manual_results)</span>
<span id="cb52-65"><a href="#cb52-65"></a></span>
<span id="cb52-66"><a href="#cb52-66"></a><span class="co"># Model summary statistics</span></span>
<span id="cb52-67"><a href="#cb52-67"></a>model_stats <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb52-68"><a href="#cb52-68"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"R²"</span>, <span class="st">"Adjusted R²"</span>, <span class="st">"Residual SE"</span>, <span class="st">"F-statistic"</span>),</span>
<span id="cb52-69"><a href="#cb52-69"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb52-70"><a href="#cb52-70"></a>    <span class="fu">round</span>(R_squared_multi, <span class="dv">4</span>),</span>
<span id="cb52-71"><a href="#cb52-71"></a>    <span class="fu">round</span>(R_squared_adj, <span class="dv">4</span>),</span>
<span id="cb52-72"><a href="#cb52-72"></a>    <span class="fu">round</span>(<span class="fu">sqrt</span>(MSE_multi), <span class="dv">4</span>),</span>
<span id="cb52-73"><a href="#cb52-73"></a>    <span class="fu">round</span>(MSR_multi <span class="sc">/</span> MSE_multi, <span class="dv">4</span>)</span>
<span id="cb52-74"><a href="#cb52-74"></a>  )</span>
<span id="cb52-75"><a href="#cb52-75"></a>)</span>
<span id="cb52-76"><a href="#cb52-76"></a></span>
<span id="cb52-77"><a href="#cb52-77"></a><span class="fu">print</span>(<span class="st">"Model Summary Statistics:"</span>)</span>
<span id="cb52-78"><a href="#cb52-78"></a><span class="fu">print</span>(model_stats)</span>
<span id="cb52-79"><a href="#cb52-79"></a></span>
<span id="cb52-80"><a href="#cb52-80"></a><span class="co"># Verify with R's lm function</span></span>
<span id="cb52-81"><a href="#cb52-81"></a>lm_multi <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> temperature <span class="sc">+</span> concentration, <span class="at">data =</span> chemical_data)</span>
<span id="cb52-82"><a href="#cb52-82"></a><span class="fu">print</span>(<span class="st">"R's lm() verification:"</span>)</span>
<span id="cb52-83"><a href="#cb52-83"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm_multi))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code04" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code04-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Multiple regression visualization"><img src="Ch06_files/figure-html/fig-Ch06Code04-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Multiple regression visualization
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># Multiple regression visualization</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="co"># Create 3D-like visualization using different perspectives</span></span>
<span id="cb53-3"><a href="#cb53-3"></a></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="co"># Partial regression plots</span></span>
<span id="cb53-5"><a href="#cb53-5"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> chemical_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> yield)) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Yield"</span>, <span class="at">title =</span> <span class="st">"Yield vs Temperature"</span>) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb53-11"><a href="#cb53-11"></a></span>
<span id="cb53-12"><a href="#cb53-12"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> chemical_data, <span class="fu">aes</span>(<span class="at">x =</span> concentration, <span class="at">y =</span> yield)) <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Concentration"</span>, <span class="at">y =</span> <span class="st">"Yield"</span>, <span class="at">title =</span> <span class="st">"Yield vs Concentration"</span>) <span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb53-18"><a href="#cb53-18"></a></span>
<span id="cb53-19"><a href="#cb53-19"></a><span class="co"># Fitted vs actual</span></span>
<span id="cb53-20"><a href="#cb53-20"></a>fitted_multi <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(y_fitted)</span>
<span id="cb53-21"><a href="#cb53-21"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb53-22"><a href="#cb53-22"></a>  <span class="at">data =</span> <span class="fu">data.table</span>(<span class="at">fitted =</span> fitted_multi, <span class="at">actual =</span> y),</span>
<span id="cb53-23"><a href="#cb53-23"></a>  <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> actual)</span>
<span id="cb53-24"><a href="#cb53-24"></a>) <span class="sc">+</span></span>
<span id="cb53-25"><a href="#cb53-25"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb53-26"><a href="#cb53-26"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb53-27"><a href="#cb53-27"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Actual Values"</span>, <span class="at">title =</span> <span class="st">"Fitted vs Actual"</span>) <span class="sc">+</span></span>
<span id="cb53-28"><a href="#cb53-28"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb53-29"><a href="#cb53-29"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb53-30"><a href="#cb53-30"></a></span>
<span id="cb53-31"><a href="#cb53-31"></a><span class="co"># Residuals vs fitted</span></span>
<span id="cb53-32"><a href="#cb53-32"></a>residuals_multi_vec <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(residuals_multi)</span>
<span id="cb53-33"><a href="#cb53-33"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb53-34"><a href="#cb53-34"></a>  <span class="at">data =</span> <span class="fu">data.table</span>(<span class="at">fitted =</span> fitted_multi, <span class="at">residuals =</span> residuals_multi_vec),</span>
<span id="cb53-35"><a href="#cb53-35"></a>  <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)</span>
<span id="cb53-36"><a href="#cb53-36"></a>) <span class="sc">+</span></span>
<span id="cb53-37"><a href="#cb53-37"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb53-38"><a href="#cb53-38"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-39"><a href="#cb53-39"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb53-40"><a href="#cb53-40"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">title =</span> <span class="st">"Residuals vs Fitted"</span>) <span class="sc">+</span></span>
<span id="cb53-41"><a href="#cb53-41"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb53-42"><a href="#cb53-42"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb53-43"><a href="#cb53-43"></a></span>
<span id="cb53-44"><a href="#cb53-44"></a><span class="fu">grid.arrange</span>(p1, p2, p3, p4, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="inferences-in-multiple-regression" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="inferences-in-multiple-regression"><span class="header-section-number">1.3.3</span> Inferences in Multiple Regression</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Hypothesis Testing in Multiple Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Overall Significance Test:</strong></p>
<p>H₀: β₁ = β₂ = … = βₖ = 0 vs H₁: At least one βⱼ ≠ 0</p>
<p><strong>F-Test:</strong></p>
<p><span class="math display">F_0 = \frac{MS_R}{MS_E} = \frac{SS_R/k}{SS_E/(n-k-1)}</span></p>
<p><strong>Individual Parameter Tests:</strong></p>
<p>H₀: βⱼ = 0 vs H₁: βⱼ ≠ 0</p>
<p><strong>t-Test:</strong></p>
<p><span class="math display">t_0 = \frac{\hat{\beta}_j}{SE(\hat{\beta}_j)}</span></p>
<p><strong>ANOVA Table:</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Source</th>
<th>SS</th>
<th>df</th>
<th>MS</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Regression</td>
<td><span class="math inline">SS_R</span></td>
<td>k</td>
<td><span class="math inline">MS_R</span></td>
<td><span class="math inline">MS_R/MS_E</span></td>
</tr>
<tr class="even">
<td>Error</td>
<td><span class="math inline">SS_E</span></td>
<td>n-k-1</td>
<td><span class="math inline">MS_E</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">SS_T</span></td>
<td>n-1</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Adjusted R²:</strong></p>
<p><span class="math display">R_{adj}^2 = 1 - \frac{SS_E/(n-k-1)}{SS_T/(n-1)} = 1 - \frac{(1-R^2)(n-1)}{n-k-1}</span></p>
</div>
</div>
</section>
<section id="example-multiple-regression-inference" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="example-multiple-regression-inference"><span class="header-section-number">1.3.4</span> Example: Multiple Regression Inference</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Multiple Regression Hypothesis Test Results:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>            Parameter Test_Type Null_Hypothesis Test_Statistic P_Value
               &lt;char&gt;    &lt;char&gt;          &lt;char&gt;          &lt;num&gt;   &lt;num&gt;
1:      Overall Model    F-test     β₁ = β₂ = 0       106.4279  0.0000
2:     β₀ (Intercept)    t-test          β₀ = 0         1.5635  0.1322
3:   β₁ (Temperature)    t-test          β₁ = 0        11.7400  0.0000
4: β₂ (Concentration)    t-test          β₂ = 0         9.4333  0.0000
            Decision                   Interpretation
              &lt;char&gt;                           &lt;char&gt;
1:         Reject H₀             Model is significant
2: Fail to reject H₀        Intercept not significant
3:         Reject H₀   Temperature effect significant
4:         Reject H₀ Concentration effect significant</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Multiple Regression ANOVA Table:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Source      SS    df      MS F_Statistic P_Value
       &lt;char&gt;   &lt;num&gt; &lt;num&gt;   &lt;num&gt;       &lt;num&gt;   &lt;num&gt;
1: Regression 4608.48     2 2304.24    106.4279       0
2:      Error  476.32    22   21.65          NA      NA
3:      Total 5084.80    24      NA          NA      NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95% Confidence Intervals for Parameters:"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in Math.data.frame(structure(list(Parameter = c("β₀ (Intercept)", : non-numeric-alike variable(s) in data frame: Parameter</code></pre>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Multiple regression inference</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>alpha_multi <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb60-3"><a href="#cb60-3"></a>t_critical_multi <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha_multi <span class="sc">/</span> <span class="dv">2</span>, df_error_multi)</span>
<span id="cb60-4"><a href="#cb60-4"></a>F_critical_multi <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha_multi, df_regression, df_error_multi)</span>
<span id="cb60-5"><a href="#cb60-5"></a></span>
<span id="cb60-6"><a href="#cb60-6"></a><span class="co"># Overall F-test</span></span>
<span id="cb60-7"><a href="#cb60-7"></a>F_stat_multi <span class="ot">&lt;-</span> MSR_multi <span class="sc">/</span> MSE_multi</span>
<span id="cb60-8"><a href="#cb60-8"></a>p_value_F_multi <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(F_stat_multi, df_regression, df_error_multi)</span>
<span id="cb60-9"><a href="#cb60-9"></a></span>
<span id="cb60-10"><a href="#cb60-10"></a><span class="co"># Individual t-tests</span></span>
<span id="cb60-11"><a href="#cb60-11"></a>t_stats <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb60-12"><a href="#cb60-12"></a>  beta0_multi <span class="sc">/</span> SE_beta0_multi,</span>
<span id="cb60-13"><a href="#cb60-13"></a>  beta1_multi <span class="sc">/</span> SE_beta1_multi,</span>
<span id="cb60-14"><a href="#cb60-14"></a>  beta2_multi <span class="sc">/</span> SE_beta2_multi</span>
<span id="cb60-15"><a href="#cb60-15"></a>)</span>
<span id="cb60-16"><a href="#cb60-16"></a></span>
<span id="cb60-17"><a href="#cb60-17"></a>p_values_t <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_stats), df_error_multi))</span>
<span id="cb60-18"><a href="#cb60-18"></a></span>
<span id="cb60-19"><a href="#cb60-19"></a><span class="co"># Hypothesis test results</span></span>
<span id="cb60-20"><a href="#cb60-20"></a>hypothesis_tests_multi <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb60-21"><a href="#cb60-21"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"Overall Model"</span>, <span class="st">"β₀ (Intercept)"</span>, <span class="st">"β₁ (Temperature)"</span>, <span class="st">"β₂ (Concentration)"</span>),</span>
<span id="cb60-22"><a href="#cb60-22"></a>  <span class="at">Test_Type =</span> <span class="fu">c</span>(<span class="st">"F-test"</span>, <span class="st">"t-test"</span>, <span class="st">"t-test"</span>, <span class="st">"t-test"</span>),</span>
<span id="cb60-23"><a href="#cb60-23"></a>  <span class="at">Null_Hypothesis =</span> <span class="fu">c</span>(<span class="st">"β₁ = β₂ = 0"</span>, <span class="st">"β₀ = 0"</span>, <span class="st">"β₁ = 0"</span>, <span class="st">"β₂ = 0"</span>),</span>
<span id="cb60-24"><a href="#cb60-24"></a>  <span class="at">Test_Statistic =</span> <span class="fu">c</span>(<span class="fu">round</span>(F_stat_multi, <span class="dv">4</span>), <span class="fu">round</span>(t_stats, <span class="dv">4</span>)),</span>
<span id="cb60-25"><a href="#cb60-25"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(p_value_F_multi, <span class="dv">4</span>), <span class="fu">round</span>(p_values_t, <span class="dv">4</span>)),</span>
<span id="cb60-26"><a href="#cb60-26"></a>  <span class="at">Decision =</span> <span class="fu">c</span>(</span>
<span id="cb60-27"><a href="#cb60-27"></a>    <span class="fu">ifelse</span>(p_value_F_multi <span class="sc">&lt;</span> alpha_multi, <span class="st">"Reject H₀"</span>, <span class="st">"Fail to reject H₀"</span>),</span>
<span id="cb60-28"><a href="#cb60-28"></a>    <span class="fu">ifelse</span>(p_values_t <span class="sc">&lt;</span> alpha_multi, <span class="st">"Reject H₀"</span>, <span class="st">"Fail to reject H₀"</span>)</span>
<span id="cb60-29"><a href="#cb60-29"></a>  ),</span>
<span id="cb60-30"><a href="#cb60-30"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb60-31"><a href="#cb60-31"></a>    <span class="fu">ifelse</span>(p_value_F_multi <span class="sc">&lt;</span> alpha_multi, <span class="st">"Model is significant"</span>, <span class="st">"Model not significant"</span>),</span>
<span id="cb60-32"><a href="#cb60-32"></a>    <span class="fu">ifelse</span>(p_values_t[<span class="dv">1</span>] <span class="sc">&lt;</span> alpha_multi, <span class="st">"Intercept significant"</span>, <span class="st">"Intercept not significant"</span>),</span>
<span id="cb60-33"><a href="#cb60-33"></a>    <span class="fu">ifelse</span>(p_values_t[<span class="dv">2</span>] <span class="sc">&lt;</span> alpha_multi, <span class="st">"Temperature effect significant"</span>, <span class="st">"Temperature not significant"</span>),</span>
<span id="cb60-34"><a href="#cb60-34"></a>    <span class="fu">ifelse</span>(p_values_t[<span class="dv">3</span>] <span class="sc">&lt;</span> alpha_multi, <span class="st">"Concentration effect significant"</span>, <span class="st">"Concentration not significant"</span>)</span>
<span id="cb60-35"><a href="#cb60-35"></a>  )</span>
<span id="cb60-36"><a href="#cb60-36"></a>)</span>
<span id="cb60-37"><a href="#cb60-37"></a></span>
<span id="cb60-38"><a href="#cb60-38"></a><span class="fu">print</span>(<span class="st">"Multiple Regression Hypothesis Test Results:"</span>)</span>
<span id="cb60-39"><a href="#cb60-39"></a><span class="fu">print</span>(hypothesis_tests_multi)</span>
<span id="cb60-40"><a href="#cb60-40"></a></span>
<span id="cb60-41"><a href="#cb60-41"></a><span class="co"># ANOVA table for multiple regression</span></span>
<span id="cb60-42"><a href="#cb60-42"></a>anova_table_multi <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb60-43"><a href="#cb60-43"></a>  <span class="at">Source =</span> <span class="fu">c</span>(<span class="st">"Regression"</span>, <span class="st">"Error"</span>, <span class="st">"Total"</span>),</span>
<span id="cb60-44"><a href="#cb60-44"></a>  <span class="at">SS =</span> <span class="fu">c</span>(<span class="fu">round</span>(SSR_multi, <span class="dv">2</span>), <span class="fu">round</span>(SSE_multi, <span class="dv">2</span>), <span class="fu">round</span>(SST_multi, <span class="dv">2</span>)),</span>
<span id="cb60-45"><a href="#cb60-45"></a>  <span class="at">df =</span> <span class="fu">c</span>(df_regression, df_error_multi, df_total),</span>
<span id="cb60-46"><a href="#cb60-46"></a>  <span class="at">MS =</span> <span class="fu">c</span>(<span class="fu">round</span>(MSR_multi, <span class="dv">2</span>), <span class="fu">round</span>(MSE_multi, <span class="dv">2</span>), <span class="cn">NA</span>),</span>
<span id="cb60-47"><a href="#cb60-47"></a>  <span class="at">F_Statistic =</span> <span class="fu">c</span>(<span class="fu">round</span>(F_stat_multi, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb60-48"><a href="#cb60-48"></a>  <span class="at">P_Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(p_value_F_multi, <span class="dv">4</span>), <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb60-49"><a href="#cb60-49"></a>)</span>
<span id="cb60-50"><a href="#cb60-50"></a></span>
<span id="cb60-51"><a href="#cb60-51"></a><span class="fu">print</span>(<span class="st">"Multiple Regression ANOVA Table:"</span>)</span>
<span id="cb60-52"><a href="#cb60-52"></a><span class="fu">print</span>(anova_table_multi)</span>
<span id="cb60-53"><a href="#cb60-53"></a></span>
<span id="cb60-54"><a href="#cb60-54"></a><span class="co"># Confidence intervals for parameters</span></span>
<span id="cb60-55"><a href="#cb60-55"></a>CI_multi <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb60-56"><a href="#cb60-56"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"β₀ (Intercept)"</span>, <span class="st">"β₁ (Temperature)"</span>, <span class="st">"β₂ (Concentration)"</span>),</span>
<span id="cb60-57"><a href="#cb60-57"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(beta0_multi, beta1_multi, beta2_multi),</span>
<span id="cb60-58"><a href="#cb60-58"></a>  <span class="at">Lower_95CI =</span> <span class="fu">c</span>(</span>
<span id="cb60-59"><a href="#cb60-59"></a>    beta0_multi <span class="sc">-</span> t_critical_multi <span class="sc">*</span> SE_beta0_multi,</span>
<span id="cb60-60"><a href="#cb60-60"></a>    beta1_multi <span class="sc">-</span> t_critical_multi <span class="sc">*</span> SE_beta1_multi,</span>
<span id="cb60-61"><a href="#cb60-61"></a>    beta2_multi <span class="sc">-</span> t_critical_multi <span class="sc">*</span> SE_beta2_multi</span>
<span id="cb60-62"><a href="#cb60-62"></a>  ),</span>
<span id="cb60-63"><a href="#cb60-63"></a>  <span class="at">Upper_95CI =</span> <span class="fu">c</span>(</span>
<span id="cb60-64"><a href="#cb60-64"></a>    beta0_multi <span class="sc">+</span> t_critical_multi <span class="sc">*</span> SE_beta0_multi,</span>
<span id="cb60-65"><a href="#cb60-65"></a>    beta1_multi <span class="sc">+</span> t_critical_multi <span class="sc">*</span> SE_beta1_multi,</span>
<span id="cb60-66"><a href="#cb60-66"></a>    beta2_multi <span class="sc">+</span> t_critical_multi <span class="sc">*</span> SE_beta2_multi</span>
<span id="cb60-67"><a href="#cb60-67"></a>  )</span>
<span id="cb60-68"><a href="#cb60-68"></a>)</span>
<span id="cb60-69"><a href="#cb60-69"></a></span>
<span id="cb60-70"><a href="#cb60-70"></a><span class="fu">print</span>(<span class="st">"95% Confidence Intervals for Parameters:"</span>)</span>
<span id="cb60-71"><a href="#cb60-71"></a><span class="fu">print</span>(<span class="fu">round</span>(CI_multi, <span class="dv">4</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
<section id="checking-model-adequacy-1" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="checking-model-adequacy-1"><span class="header-section-number">1.3.5</span> Checking Model Adequacy</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Multiple Regression Diagnostics
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Key Diagnostic Plots:</strong></p>
<ol type="1">
<li><p><strong>Residuals vs.&nbsp;Fitted:</strong> Check linearity and constant variance</p></li>
<li><p><strong>Normal Q-Q Plot:</strong> Check normality of residuals</p></li>
<li><p><strong>Scale-Location:</strong> Check homoscedasticity</p></li>
<li><p><strong>Residuals vs.&nbsp;Leverage:</strong> Identify influential points</p></li>
</ol>
<p><strong>Multicollinearity Detection:</strong></p>
<ul>
<li><strong>Variance Inflation Factor (VIF):</strong></li>
</ul>
<p><span class="math display">VIF_j = \frac{1}{1-R_j^2}</span></p>
<p>where <span class="math inline">R_j^2</span> is the R² from regressing <span class="math inline">x_j</span> on other predictors</p>
<ul>
<li><strong>Rule of thumb:</strong> VIF &gt; 10 indicates serious multicollinearity</li>
</ul>
<p><strong>Influential Observations:</strong></p>
<ul>
<li><p><strong>Leverage:</strong> <span class="math inline">h_{ii}</span> (diagonal elements of hat matrix)</p></li>
<li><p><strong>Cook’s Distance:</strong> Measures influence on fitted values</p></li>
<li><p><strong>Studentized Residuals:</strong> Better for outlier detection</p></li>
</ul>
</div>
</div>
</section>
<section id="example-model-diagnostics-for-multiple-regression" class="level3" data-number="1.3.6">
<h3 data-number="1.3.6" class="anchored" data-anchor-id="example-model-diagnostics-for-multiple-regression"><span class="header-section-number">1.3.6</span> Example: Model Diagnostics for Multiple Regression</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Multiple Regression Diagnostic Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Diagnostic  Value Threshold            Concern
                        &lt;char&gt;  &lt;num&gt;    &lt;char&gt;             &lt;char&gt;
1: Max |Standardized Residual| 2.2105       2-3 Potential outliers
2:  Max |Studentized Residual| 2.3367       2-3 Potential outliers
3:                Max Leverage 0.1960    &gt; 0.24                 OK
4:         Max Cook's Distance 0.2256         1                 OK
5:             VIF Temperature 1.0046        10                 OK
6:           VIF Concentration 1.0046        10                 OK</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Flagged observations:"
   observation standardized_resid studentized_resid leverage cooks_distance
         &lt;int&gt;              &lt;num&gt;             &lt;num&gt;    &lt;num&gt;          &lt;num&gt;
1:           8             -1.862            -1.989    0.124          0.163
2:          11              2.211             2.337    0.105          0.191
3:          20              1.895             2.066    0.159          0.226
   outlier high_leverage influential
    &lt;lgcl&gt;        &lt;lgcl&gt;      &lt;lgcl&gt;
1:   FALSE         FALSE        TRUE
2:    TRUE         FALSE        TRUE
3:   FALSE         FALSE        TRUE</code></pre>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># Multiple regression diagnostics</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="co"># Calculate leverages (diagonal elements of hat matrix)</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>H <span class="ot">&lt;-</span> X <span class="sc">%*%</span> <span class="fu">solve</span>(XtX) <span class="sc">%*%</span> <span class="fu">t</span>(X)</span>
<span id="cb64-4"><a href="#cb64-4"></a>leverages <span class="ot">&lt;-</span> <span class="fu">diag</span>(H)</span>
<span id="cb64-5"><a href="#cb64-5"></a></span>
<span id="cb64-6"><a href="#cb64-6"></a><span class="co"># Standardized and studentized residuals</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>standardized_resid_multi <span class="ot">&lt;-</span> residuals_multi_vec <span class="sc">/</span> <span class="fu">sqrt</span>(MSE_multi)</span>
<span id="cb64-8"><a href="#cb64-8"></a>studentized_resid_multi <span class="ot">&lt;-</span> residuals_multi_vec <span class="sc">/</span> <span class="fu">sqrt</span>(MSE_multi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> leverages))</span>
<span id="cb64-9"><a href="#cb64-9"></a></span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="co"># Cook's distance</span></span>
<span id="cb64-11"><a href="#cb64-11"></a>cooks_distance <span class="ot">&lt;-</span> (standardized_resid_multi<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">*</span> (leverages <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> leverages))</span>
<span id="cb64-12"><a href="#cb64-12"></a></span>
<span id="cb64-13"><a href="#cb64-13"></a><span class="co"># VIF calculations (for multicollinearity)</span></span>
<span id="cb64-14"><a href="#cb64-14"></a><span class="co"># VIF for temperature (regress temp on concentration)</span></span>
<span id="cb64-15"><a href="#cb64-15"></a>temp_on_conc <span class="ot">&lt;-</span> <span class="fu">lm</span>(temperature <span class="sc">~</span> concentration, <span class="at">data =</span> chemical_data)</span>
<span id="cb64-16"><a href="#cb64-16"></a>R2_temp <span class="ot">&lt;-</span> <span class="fu">summary</span>(temp_on_conc)<span class="sc">$</span>r.squared</span>
<span id="cb64-17"><a href="#cb64-17"></a>VIF_temp <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> R2_temp)</span>
<span id="cb64-18"><a href="#cb64-18"></a></span>
<span id="cb64-19"><a href="#cb64-19"></a><span class="co"># VIF for concentration (regress conc on temperature)</span></span>
<span id="cb64-20"><a href="#cb64-20"></a>conc_on_temp <span class="ot">&lt;-</span> <span class="fu">lm</span>(concentration <span class="sc">~</span> temperature, <span class="at">data =</span> chemical_data)</span>
<span id="cb64-21"><a href="#cb64-21"></a>R2_conc <span class="ot">&lt;-</span> <span class="fu">summary</span>(conc_on_temp)<span class="sc">$</span>r.squared</span>
<span id="cb64-22"><a href="#cb64-22"></a>VIF_conc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> R2_conc)</span>
<span id="cb64-23"><a href="#cb64-23"></a></span>
<span id="cb64-24"><a href="#cb64-24"></a><span class="co"># Diagnostic summary</span></span>
<span id="cb64-25"><a href="#cb64-25"></a>diagnostic_summary <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb64-26"><a href="#cb64-26"></a>  <span class="at">Diagnostic =</span> <span class="fu">c</span>(</span>
<span id="cb64-27"><a href="#cb64-27"></a>    <span class="st">"Max |Standardized Residual|"</span>, <span class="st">"Max |Studentized Residual|"</span>,</span>
<span id="cb64-28"><a href="#cb64-28"></a>    <span class="st">"Max Leverage"</span>, <span class="st">"Max Cook's Distance"</span>, <span class="st">"VIF Temperature"</span>, <span class="st">"VIF Concentration"</span></span>
<span id="cb64-29"><a href="#cb64-29"></a>  ),</span>
<span id="cb64-30"><a href="#cb64-30"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb64-31"><a href="#cb64-31"></a>    <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">abs</span>(standardized_resid_multi)), <span class="dv">4</span>),</span>
<span id="cb64-32"><a href="#cb64-32"></a>    <span class="fu">round</span>(<span class="fu">max</span>(<span class="fu">abs</span>(studentized_resid_multi)), <span class="dv">4</span>),</span>
<span id="cb64-33"><a href="#cb64-33"></a>    <span class="fu">round</span>(<span class="fu">max</span>(leverages), <span class="dv">4</span>),</span>
<span id="cb64-34"><a href="#cb64-34"></a>    <span class="fu">round</span>(<span class="fu">max</span>(cooks_distance), <span class="dv">4</span>),</span>
<span id="cb64-35"><a href="#cb64-35"></a>    <span class="fu">round</span>(VIF_temp, <span class="dv">4</span>),</span>
<span id="cb64-36"><a href="#cb64-36"></a>    <span class="fu">round</span>(VIF_conc, <span class="dv">4</span>)</span>
<span id="cb64-37"><a href="#cb64-37"></a>  ),</span>
<span id="cb64-38"><a href="#cb64-38"></a>  <span class="at">Threshold =</span> <span class="fu">c</span>(<span class="st">"2-3"</span>, <span class="st">"2-3"</span>, <span class="fu">paste</span>(<span class="st">"&gt;"</span>, <span class="fu">round</span>(<span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n_multi, <span class="dv">3</span>)), <span class="st">"1"</span>, <span class="st">"10"</span>, <span class="st">"10"</span>),</span>
<span id="cb64-39"><a href="#cb64-39"></a>  <span class="at">Concern =</span> <span class="fu">c</span>(</span>
<span id="cb64-40"><a href="#cb64-40"></a>    <span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">abs</span>(standardized_resid_multi)) <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="st">"Potential outliers"</span>, <span class="st">"OK"</span>),</span>
<span id="cb64-41"><a href="#cb64-41"></a>    <span class="fu">ifelse</span>(<span class="fu">max</span>(<span class="fu">abs</span>(studentized_resid_multi)) <span class="sc">&gt;</span> <span class="dv">2</span>, <span class="st">"Potential outliers"</span>, <span class="st">"OK"</span>),</span>
<span id="cb64-42"><a href="#cb64-42"></a>    <span class="fu">ifelse</span>(<span class="fu">max</span>(leverages) <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n_multi, <span class="st">"High leverage points"</span>, <span class="st">"OK"</span>),</span>
<span id="cb64-43"><a href="#cb64-43"></a>    <span class="fu">ifelse</span>(<span class="fu">max</span>(cooks_distance) <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="st">"Influential observations"</span>, <span class="st">"OK"</span>),</span>
<span id="cb64-44"><a href="#cb64-44"></a>    <span class="fu">ifelse</span>(VIF_temp <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="st">"Serious multicollinearity"</span>, <span class="st">"OK"</span>),</span>
<span id="cb64-45"><a href="#cb64-45"></a>    <span class="fu">ifelse</span>(VIF_conc <span class="sc">&gt;</span> <span class="dv">10</span>, <span class="st">"Serious multicollinearity"</span>, <span class="st">"OK"</span>)</span>
<span id="cb64-46"><a href="#cb64-46"></a>  )</span>
<span id="cb64-47"><a href="#cb64-47"></a>)</span>
<span id="cb64-48"><a href="#cb64-48"></a></span>
<span id="cb64-49"><a href="#cb64-49"></a><span class="fu">print</span>(<span class="st">"Multiple Regression Diagnostic Summary:"</span>)</span>
<span id="cb64-50"><a href="#cb64-50"></a><span class="fu">print</span>(diagnostic_summary)</span>
<span id="cb64-51"><a href="#cb64-51"></a></span>
<span id="cb64-52"><a href="#cb64-52"></a><span class="co"># Identify specific problematic observations</span></span>
<span id="cb64-53"><a href="#cb64-53"></a>problem_obs <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb64-54"><a href="#cb64-54"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span>n_multi,</span>
<span id="cb64-55"><a href="#cb64-55"></a>  <span class="at">standardized_resid =</span> <span class="fu">round</span>(standardized_resid_multi, <span class="dv">3</span>),</span>
<span id="cb64-56"><a href="#cb64-56"></a>  <span class="at">studentized_resid =</span> <span class="fu">round</span>(studentized_resid_multi, <span class="dv">3</span>),</span>
<span id="cb64-57"><a href="#cb64-57"></a>  <span class="at">leverage =</span> <span class="fu">round</span>(leverages, <span class="dv">3</span>),</span>
<span id="cb64-58"><a href="#cb64-58"></a>  <span class="at">cooks_distance =</span> <span class="fu">round</span>(cooks_distance, <span class="dv">3</span>)</span>
<span id="cb64-59"><a href="#cb64-59"></a>)</span>
<span id="cb64-60"><a href="#cb64-60"></a></span>
<span id="cb64-61"><a href="#cb64-61"></a><span class="co"># Flag potential problems</span></span>
<span id="cb64-62"><a href="#cb64-62"></a>problem_obs[, outlier <span class="sc">:</span><span class="er">=</span> <span class="fu">abs</span>(standardized_resid) <span class="sc">&gt;</span> <span class="dv">2</span>]</span>
<span id="cb64-63"><a href="#cb64-63"></a>problem_obs[, high_leverage <span class="sc">:</span><span class="er">=</span> leverage <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n_multi]</span>
<span id="cb64-64"><a href="#cb64-64"></a>problem_obs[, influential <span class="sc">:</span><span class="er">=</span> cooks_distance <span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">/</span> n_multi] <span class="co"># Conservative threshold</span></span>
<span id="cb64-65"><a href="#cb64-65"></a></span>
<span id="cb64-66"><a href="#cb64-66"></a>flagged_obs <span class="ot">&lt;-</span> problem_obs[outlier <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">|</span> high_leverage <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">|</span> influential <span class="sc">==</span> <span class="cn">TRUE</span>]</span>
<span id="cb64-67"><a href="#cb64-67"></a></span>
<span id="cb64-68"><a href="#cb64-68"></a><span class="cf">if</span> (<span class="fu">nrow</span>(flagged_obs) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb64-69"><a href="#cb64-69"></a>  <span class="fu">print</span>(<span class="st">"Flagged observations:"</span>)</span>
<span id="cb64-70"><a href="#cb64-70"></a>  <span class="fu">print</span>(flagged_obs)</span>
<span id="cb64-71"><a href="#cb64-71"></a>} <span class="cf">else</span> {</span>
<span id="cb64-72"><a href="#cb64-72"></a>  <span class="fu">print</span>(<span class="st">"No observations flagged for potential problems"</span>)</span>
<span id="cb64-73"><a href="#cb64-73"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code05" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code05-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Multiple regression diagnostic plots"><img src="Ch06_files/figure-html/fig-Ch06Code05-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code05-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Multiple regression diagnostic plots
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Multiple regression diagnostic plots</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>multi_diagnostic_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="at">fitted =</span> fitted_multi,</span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="at">residuals =</span> residuals_multi_vec,</span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="at">standardized_resid =</span> standardized_resid_multi,</span>
<span id="cb65-6"><a href="#cb65-6"></a>  <span class="at">studentized_resid =</span> studentized_resid_multi,</span>
<span id="cb65-7"><a href="#cb65-7"></a>  <span class="at">leverage =</span> leverages,</span>
<span id="cb65-8"><a href="#cb65-8"></a>  <span class="at">cooks_distance =</span> cooks_distance,</span>
<span id="cb65-9"><a href="#cb65-9"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span>n_multi</span>
<span id="cb65-10"><a href="#cb65-10"></a>)</span>
<span id="cb65-11"><a href="#cb65-11"></a></span>
<span id="cb65-12"><a href="#cb65-12"></a><span class="co"># 1. Residuals vs Fitted</span></span>
<span id="cb65-13"><a href="#cb65-13"></a>p1_multi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> multi_diagnostic_data, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb65-14"><a href="#cb65-14"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb65-16"><a href="#cb65-16"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb65-17"><a href="#cb65-17"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">title =</span> <span class="st">"Residuals vs Fitted"</span>) <span class="sc">+</span></span>
<span id="cb65-18"><a href="#cb65-18"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb65-19"><a href="#cb65-19"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb65-20"><a href="#cb65-20"></a></span>
<span id="cb65-21"><a href="#cb65-21"></a><span class="co"># 2. Normal Q-Q plot</span></span>
<span id="cb65-22"><a href="#cb65-22"></a>p2_multi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> multi_diagnostic_data, <span class="fu">aes</span>(<span class="at">sample =</span> standardized_resid)) <span class="sc">+</span></span>
<span id="cb65-23"><a href="#cb65-23"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span></span>
<span id="cb65-24"><a href="#cb65-24"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb65-25"><a href="#cb65-25"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-26"><a href="#cb65-26"></a>    <span class="at">x =</span> <span class="st">"Theoretical Quantiles"</span>, <span class="at">y =</span> <span class="st">"Standardized Residuals"</span>,</span>
<span id="cb65-27"><a href="#cb65-27"></a>    <span class="at">title =</span> <span class="st">"Normal Q-Q Plot"</span></span>
<span id="cb65-28"><a href="#cb65-28"></a>  ) <span class="sc">+</span></span>
<span id="cb65-29"><a href="#cb65-29"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb65-30"><a href="#cb65-30"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb65-31"><a href="#cb65-31"></a></span>
<span id="cb65-32"><a href="#cb65-32"></a><span class="co"># 3. Scale-Location</span></span>
<span id="cb65-33"><a href="#cb65-33"></a>p3_multi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> multi_diagnostic_data, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(standardized_resid)))) <span class="sc">+</span></span>
<span id="cb65-34"><a href="#cb65-34"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb65-35"><a href="#cb65-35"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb65-36"><a href="#cb65-36"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-37"><a href="#cb65-37"></a>    <span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"√|Standardized Residuals|"</span>,</span>
<span id="cb65-38"><a href="#cb65-38"></a>    <span class="at">title =</span> <span class="st">"Scale-Location"</span></span>
<span id="cb65-39"><a href="#cb65-39"></a>  ) <span class="sc">+</span></span>
<span id="cb65-40"><a href="#cb65-40"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb65-41"><a href="#cb65-41"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb65-42"><a href="#cb65-42"></a></span>
<span id="cb65-43"><a href="#cb65-43"></a><span class="co"># 4. Residuals vs Leverage</span></span>
<span id="cb65-44"><a href="#cb65-44"></a>p4_multi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> multi_diagnostic_data, <span class="fu">aes</span>(<span class="at">x =</span> leverage, <span class="at">y =</span> studentized_resid)) <span class="sc">+</span></span>
<span id="cb65-45"><a href="#cb65-45"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb65-46"><a href="#cb65-46"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb65-47"><a href="#cb65-47"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n_multi, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb65-48"><a href="#cb65-48"></a>  <span class="fu">labs</span>(</span>
<span id="cb65-49"><a href="#cb65-49"></a>    <span class="at">x =</span> <span class="st">"Leverage"</span>, <span class="at">y =</span> <span class="st">"Studentized Residuals"</span>,</span>
<span id="cb65-50"><a href="#cb65-50"></a>    <span class="at">title =</span> <span class="st">"Residuals vs Leverage"</span></span>
<span id="cb65-51"><a href="#cb65-51"></a>  ) <span class="sc">+</span></span>
<span id="cb65-52"><a href="#cb65-52"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb65-53"><a href="#cb65-53"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb65-54"><a href="#cb65-54"></a></span>
<span id="cb65-55"><a href="#cb65-55"></a><span class="fu">grid.arrange</span>(p1_multi, p2_multi, p3_multi, p4_multi, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="other-aspects-of-regression" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="other-aspects-of-regression"><span class="header-section-number">1.4</span> Other Aspects of Regression</h2>
<section id="polynomial-models" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="polynomial-models"><span class="header-section-number">1.4.1</span> Polynomial Models</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Polynomial Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>When the relationship is curved, use polynomial models:</p>
<p><strong>Second-Order (Quadratic):</strong></p>
<p><span class="math display">y = \beta_0 + \beta_1 x + \beta_2 x^2 + \epsilon</span></p>
<p><strong>Third-Order (Cubic):</strong></p>
<p><span class="math display">y = \beta_0 + \beta_1 x + \beta_2 x^2 + \beta_3 x^3 + \epsilon</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>β₁: Linear effect</p></li>
<li><p>β₂: Quadratic effect (curvature)</p></li>
<li><p>β₃: Cubic effect (inflection)</p></li>
</ul>
<p><strong>Model Selection:</strong></p>
<ul>
<li><p>Start with linear model</p></li>
<li><p>Add higher-order terms if needed</p></li>
<li><p>Use hypothesis tests to determine necessary degree</p></li>
<li><p>Be cautious of overfitting</p></li>
</ul>
</div>
</div>
</section>
<section id="example-polynomial-regression" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="example-polynomial-regression"><span class="header-section-number">1.4.2</span> Example: Polynomial Regression</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A process engineer studies how temperature affects reaction rate and suspects a nonlinear relationship:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false"></a><a href="data/reaction_rate.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Reaction Rate vs Temperature Data:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    temperature      rate
          &lt;num&gt;     &lt;num&gt;
 1:         100  69.57229
 2:         110  66.01070
 3:         120  77.32496
 4:         130  82.34042
 5:         140  84.94795
 6:         150  88.67155
 7:         160  92.08906
 8:         170  97.41559
 9:         180  98.66312
10:         190 107.59609</code></pre>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># Polynomial regression example</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb68-3"><a href="#cb68-3"></a>reaction_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb68-4"><a href="#cb68-4"></a>  <span class="at">temperature =</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">300</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb68-5"><a href="#cb68-5"></a>  <span class="at">rate =</span> <span class="cn">NULL</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>)</span>
<span id="cb68-7"><a href="#cb68-7"></a></span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="co"># Create nonlinear relationship</span></span>
<span id="cb68-9"><a href="#cb68-9"></a>reaction_data[, rate <span class="sc">:</span><span class="er">=</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> temperature <span class="sc">-</span> <span class="fl">0.002</span> <span class="sc">*</span> temperature<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10"></a>  <span class="fl">0.000003</span> <span class="sc">*</span> temperature<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">21</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)]</span>
<span id="cb68-11"><a href="#cb68-11"></a></span>
<span id="cb68-12"><a href="#cb68-12"></a><span class="fu">print</span>(<span class="st">"Reaction Rate vs Temperature Data:"</span>)</span>
<span id="cb68-13"><a href="#cb68-13"></a><span class="fu">print</span>(<span class="fu">head</span>(reaction_data, <span class="dv">10</span>))</span>
<span id="cb68-14"><a href="#cb68-14"></a></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="co"># Write data to CSV</span></span>
<span id="cb68-16"><a href="#cb68-16"></a><span class="fu">fwrite</span>(reaction_data, <span class="st">"data/reaction_rate.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">

</div>
</div>
</div>
<p><strong>Model Comparison:</strong></p>
<ol type="1">
<li><p><strong>Linear:</strong> <span class="math inline">Rate = \beta_0 + \beta_1 \times Temperature + \epsilon</span></p></li>
<li><p><strong>Quadratic:</strong> <span class="math inline">Rate = \beta_0 + \beta_1 \times Temperature + \beta_2 \times Temperature^2 + \epsilon</span></p></li>
<li><p><strong>Cubic:</strong> <span class="math inline">Rate = \beta_0 + \beta_1 \times Temperature + \beta_2 \times Temperature^2 + \beta_3 \times Temperature^3 + \epsilon</span></p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Polynomial Model Comparison:"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in Math.data.frame(structure(list(Model = c("Linear", "Quadratic", : non-numeric-alike variable(s) in data frame: Model, Formula</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-test: Linear vs Quadratic"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: rate ~ temperature
Model 2: rate ~ temperature + I(temperature^2)
  Res.Df     RSS Df Sum of Sq      F  Pr(&gt;F)  
1     19 103.809                              
2     18  86.945  1    16.864 3.4914 0.07805 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-test: Quadratic vs Cubic"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: rate ~ temperature + I(temperature^2)
Model 2: rate ~ temperature + I(temperature^2) + I(temperature^3)
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     18 86.945                           
2     17 86.571  1   0.37395 0.0734 0.7897</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Best model based on Adjusted R²: Quadratic"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Quadratic Model Summary:"

Call:
lm(formula = rate ~ temperature + I(temperature^2), data = reaction_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.6671 -1.2600  0.1417  1.5729  3.1584 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      20.9024617  5.5825087   3.744  0.00148 ** 
temperature       0.4917544  0.0592276   8.303 1.44e-07 ***
I(temperature^2) -0.0002742  0.0001467  -1.869  0.07805 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.198 on 18 degrees of freedom
Multiple R-squared:  0.9923,    Adjusted R-squared:  0.9915 
F-statistic:  1165 on 2 and 18 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># Fit polynomial models of different degrees</span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="co"># Linear model</span></span>
<span id="cb77-3"><a href="#cb77-3"></a>lm_linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(rate <span class="sc">~</span> temperature, <span class="at">data =</span> reaction_data)</span>
<span id="cb77-4"><a href="#cb77-4"></a></span>
<span id="cb77-5"><a href="#cb77-5"></a><span class="co"># Quadratic model</span></span>
<span id="cb77-6"><a href="#cb77-6"></a>lm_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(rate <span class="sc">~</span> temperature <span class="sc">+</span> <span class="fu">I</span>(temperature<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> reaction_data)</span>
<span id="cb77-7"><a href="#cb77-7"></a></span>
<span id="cb77-8"><a href="#cb77-8"></a><span class="co"># Cubic model</span></span>
<span id="cb77-9"><a href="#cb77-9"></a>lm_cubic <span class="ot">&lt;-</span> <span class="fu">lm</span>(rate <span class="sc">~</span> temperature <span class="sc">+</span> <span class="fu">I</span>(temperature<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(temperature<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> reaction_data)</span>
<span id="cb77-10"><a href="#cb77-10"></a></span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="co"># Model comparison</span></span>
<span id="cb77-12"><a href="#cb77-12"></a>model_comparison <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb77-13"><a href="#cb77-13"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Quadratic"</span>, <span class="st">"Cubic"</span>),</span>
<span id="cb77-14"><a href="#cb77-14"></a>  <span class="at">Formula =</span> <span class="fu">c</span>(</span>
<span id="cb77-15"><a href="#cb77-15"></a>    <span class="st">"rate ~ temperature"</span>,</span>
<span id="cb77-16"><a href="#cb77-16"></a>    <span class="st">"rate ~ temperature + temperature²"</span>,</span>
<span id="cb77-17"><a href="#cb77-17"></a>    <span class="st">"rate ~ temperature + temperature² + temperature³"</span></span>
<span id="cb77-18"><a href="#cb77-18"></a>  ),</span>
<span id="cb77-19"><a href="#cb77-19"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb77-20"><a href="#cb77-20"></a>    <span class="fu">summary</span>(lm_linear)<span class="sc">$</span>r.squared,</span>
<span id="cb77-21"><a href="#cb77-21"></a>    <span class="fu">summary</span>(lm_quad)<span class="sc">$</span>r.squared,</span>
<span id="cb77-22"><a href="#cb77-22"></a>    <span class="fu">summary</span>(lm_cubic)<span class="sc">$</span>r.squared</span>
<span id="cb77-23"><a href="#cb77-23"></a>  ),</span>
<span id="cb77-24"><a href="#cb77-24"></a>  <span class="at">Adj_R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb77-25"><a href="#cb77-25"></a>    <span class="fu">summary</span>(lm_linear)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb77-26"><a href="#cb77-26"></a>    <span class="fu">summary</span>(lm_quad)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb77-27"><a href="#cb77-27"></a>    <span class="fu">summary</span>(lm_cubic)<span class="sc">$</span>adj.r.squared</span>
<span id="cb77-28"><a href="#cb77-28"></a>  ),</span>
<span id="cb77-29"><a href="#cb77-29"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(lm_linear), <span class="fu">AIC</span>(lm_quad), <span class="fu">AIC</span>(lm_cubic)),</span>
<span id="cb77-30"><a href="#cb77-30"></a>  <span class="at">BIC =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(lm_linear), <span class="fu">BIC</span>(lm_quad), <span class="fu">BIC</span>(lm_cubic)),</span>
<span id="cb77-31"><a href="#cb77-31"></a>  <span class="at">F_statistic =</span> <span class="fu">c</span>(</span>
<span id="cb77-32"><a href="#cb77-32"></a>    <span class="fu">summary</span>(lm_linear)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb77-33"><a href="#cb77-33"></a>    <span class="fu">summary</span>(lm_quad)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb77-34"><a href="#cb77-34"></a>    <span class="fu">summary</span>(lm_cubic)<span class="sc">$</span>fstatistic[<span class="dv">1</span>]</span>
<span id="cb77-35"><a href="#cb77-35"></a>  ),</span>
<span id="cb77-36"><a href="#cb77-36"></a>  <span class="at">p_value =</span> <span class="fu">c</span>(</span>
<span id="cb77-37"><a href="#cb77-37"></a>    <span class="fu">pf</span>(<span class="fu">summary</span>(lm_linear)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb77-38"><a href="#cb77-38"></a>      <span class="fu">summary</span>(lm_linear)<span class="sc">$</span>fstatistic[<span class="dv">2</span>],</span>
<span id="cb77-39"><a href="#cb77-39"></a>      <span class="fu">summary</span>(lm_linear)<span class="sc">$</span>fstatistic[<span class="dv">3</span>],</span>
<span id="cb77-40"><a href="#cb77-40"></a>      <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb77-41"><a href="#cb77-41"></a>    ),</span>
<span id="cb77-42"><a href="#cb77-42"></a>    <span class="fu">pf</span>(<span class="fu">summary</span>(lm_quad)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb77-43"><a href="#cb77-43"></a>      <span class="fu">summary</span>(lm_quad)<span class="sc">$</span>fstatistic[<span class="dv">2</span>],</span>
<span id="cb77-44"><a href="#cb77-44"></a>      <span class="fu">summary</span>(lm_quad)<span class="sc">$</span>fstatistic[<span class="dv">3</span>],</span>
<span id="cb77-45"><a href="#cb77-45"></a>      <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb77-46"><a href="#cb77-46"></a>    ),</span>
<span id="cb77-47"><a href="#cb77-47"></a>    <span class="fu">pf</span>(<span class="fu">summary</span>(lm_cubic)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb77-48"><a href="#cb77-48"></a>      <span class="fu">summary</span>(lm_cubic)<span class="sc">$</span>fstatistic[<span class="dv">2</span>],</span>
<span id="cb77-49"><a href="#cb77-49"></a>      <span class="fu">summary</span>(lm_cubic)<span class="sc">$</span>fstatistic[<span class="dv">3</span>],</span>
<span id="cb77-50"><a href="#cb77-50"></a>      <span class="at">lower.tail =</span> <span class="cn">FALSE</span></span>
<span id="cb77-51"><a href="#cb77-51"></a>    )</span>
<span id="cb77-52"><a href="#cb77-52"></a>  )</span>
<span id="cb77-53"><a href="#cb77-53"></a>)</span>
<span id="cb77-54"><a href="#cb77-54"></a></span>
<span id="cb77-55"><a href="#cb77-55"></a><span class="fu">print</span>(<span class="st">"Polynomial Model Comparison:"</span>)</span>
<span id="cb77-56"><a href="#cb77-56"></a><span class="fu">print</span>(<span class="fu">round</span>(model_comparison, <span class="dv">4</span>))</span>
<span id="cb77-57"><a href="#cb77-57"></a></span>
<span id="cb77-58"><a href="#cb77-58"></a><span class="co"># Sequential F-tests for additional terms</span></span>
<span id="cb77-59"><a href="#cb77-59"></a><span class="co"># Test if quadratic term improves linear model</span></span>
<span id="cb77-60"><a href="#cb77-60"></a>anova_linear_quad <span class="ot">&lt;-</span> <span class="fu">anova</span>(lm_linear, lm_quad)</span>
<span id="cb77-61"><a href="#cb77-61"></a><span class="fu">print</span>(<span class="st">"F-test: Linear vs Quadratic"</span>)</span>
<span id="cb77-62"><a href="#cb77-62"></a><span class="fu">print</span>(anova_linear_quad)</span>
<span id="cb77-63"><a href="#cb77-63"></a></span>
<span id="cb77-64"><a href="#cb77-64"></a><span class="co"># Test if cubic term improves quadratic model</span></span>
<span id="cb77-65"><a href="#cb77-65"></a>anova_quad_cubic <span class="ot">&lt;-</span> <span class="fu">anova</span>(lm_quad, lm_cubic)</span>
<span id="cb77-66"><a href="#cb77-66"></a><span class="fu">print</span>(<span class="st">"F-test: Quadratic vs Cubic"</span>)</span>
<span id="cb77-67"><a href="#cb77-67"></a><span class="fu">print</span>(anova_quad_cubic)</span>
<span id="cb77-68"><a href="#cb77-68"></a></span>
<span id="cb77-69"><a href="#cb77-69"></a><span class="co"># Detailed summary of best model (based on adj R²)</span></span>
<span id="cb77-70"><a href="#cb77-70"></a>best_model_idx <span class="ot">&lt;-</span> <span class="fu">which.max</span>(model_comparison<span class="sc">$</span>Adj_R_squared)</span>
<span id="cb77-71"><a href="#cb77-71"></a>best_model_name <span class="ot">&lt;-</span> model_comparison<span class="sc">$</span>Model[best_model_idx]</span>
<span id="cb77-72"><a href="#cb77-72"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Best model based on Adjusted R²:"</span>, best_model_name))</span>
<span id="cb77-73"><a href="#cb77-73"></a></span>
<span id="cb77-74"><a href="#cb77-74"></a><span class="cf">if</span> (best_model_name <span class="sc">==</span> <span class="st">"Cubic"</span>) {</span>
<span id="cb77-75"><a href="#cb77-75"></a>  <span class="fu">print</span>(<span class="st">"Cubic Model Summary:"</span>)</span>
<span id="cb77-76"><a href="#cb77-76"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(lm_cubic))</span>
<span id="cb77-77"><a href="#cb77-77"></a>} <span class="cf">else</span> <span class="cf">if</span> (best_model_name <span class="sc">==</span> <span class="st">"Quadratic"</span>) {</span>
<span id="cb77-78"><a href="#cb77-78"></a>  <span class="fu">print</span>(<span class="st">"Quadratic Model Summary:"</span>)</span>
<span id="cb77-79"><a href="#cb77-79"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(lm_quad))</span>
<span id="cb77-80"><a href="#cb77-80"></a>} <span class="cf">else</span> {</span>
<span id="cb77-81"><a href="#cb77-81"></a>  <span class="fu">print</span>(<span class="st">"Linear Model Summary:"</span>)</span>
<span id="cb77-82"><a href="#cb77-82"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(lm_linear))</span>
<span id="cb77-83"><a href="#cb77-83"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code06" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code06-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Polynomial regression models comparison"><img src="Ch06_files/figure-html/fig-Ch06Code06-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code06-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Polynomial regression models comparison
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># Polynomial regression visualization</span></span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co"># Create prediction data for smooth curves</span></span>
<span id="cb78-3"><a href="#cb78-3"></a>temp_pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(reaction_data<span class="sc">$</span>temperature), <span class="fu">max</span>(reaction_data<span class="sc">$</span>temperature), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb78-4"><a href="#cb78-4"></a>pred_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">temperature =</span> temp_pred)</span>
<span id="cb78-5"><a href="#cb78-5"></a></span>
<span id="cb78-6"><a href="#cb78-6"></a><span class="co"># Predictions from each model</span></span>
<span id="cb78-7"><a href="#cb78-7"></a>pred_linear <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_linear, <span class="at">newdata =</span> pred_data)</span>
<span id="cb78-8"><a href="#cb78-8"></a>pred_quad <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_quad, <span class="at">newdata =</span> pred_data)</span>
<span id="cb78-9"><a href="#cb78-9"></a>pred_cubic <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_cubic, <span class="at">newdata =</span> pred_data)</span>
<span id="cb78-10"><a href="#cb78-10"></a></span>
<span id="cb78-11"><a href="#cb78-11"></a><span class="co"># Combine predictions</span></span>
<span id="cb78-12"><a href="#cb78-12"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb78-13"><a href="#cb78-13"></a>  <span class="at">temperature =</span> <span class="fu">rep</span>(temp_pred, <span class="dv">3</span>),</span>
<span id="cb78-14"><a href="#cb78-14"></a>  <span class="at">predicted_rate =</span> <span class="fu">c</span>(pred_linear, pred_quad, pred_cubic),</span>
<span id="cb78-15"><a href="#cb78-15"></a>  <span class="at">model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Linear"</span>, <span class="st">"Quadratic"</span>, <span class="st">"Cubic"</span>), <span class="at">each =</span> <span class="fu">length</span>(temp_pred))</span>
<span id="cb78-16"><a href="#cb78-16"></a>)</span>
<span id="cb78-17"><a href="#cb78-17"></a></span>
<span id="cb78-18"><a href="#cb78-18"></a><span class="co"># Plot all models</span></span>
<span id="cb78-19"><a href="#cb78-19"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb78-20"><a href="#cb78-20"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb78-21"><a href="#cb78-21"></a>    <span class="at">data =</span> reaction_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> rate),</span>
<span id="cb78-22"><a href="#cb78-22"></a>    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb78-23"><a href="#cb78-23"></a>  ) <span class="sc">+</span></span>
<span id="cb78-24"><a href="#cb78-24"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb78-25"><a href="#cb78-25"></a>    <span class="at">data =</span> plot_data, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> predicted_rate, <span class="at">color =</span> model),</span>
<span id="cb78-26"><a href="#cb78-26"></a>    <span class="at">linewidth =</span> <span class="fl">1.2</span></span>
<span id="cb78-27"><a href="#cb78-27"></a>  ) <span class="sc">+</span></span>
<span id="cb78-28"><a href="#cb78-28"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Linear"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Quadratic"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Cubic"</span> <span class="ot">=</span> <span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb78-29"><a href="#cb78-29"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-30"><a href="#cb78-30"></a>    <span class="at">x =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb78-31"><a href="#cb78-31"></a>    <span class="at">y =</span> <span class="st">"Reaction Rate"</span>,</span>
<span id="cb78-32"><a href="#cb78-32"></a>    <span class="at">title =</span> <span class="st">"Polynomial Regression Models Comparison"</span>,</span>
<span id="cb78-33"><a href="#cb78-33"></a>    <span class="at">subtitle =</span> <span class="st">"Comparing linear, quadratic, and cubic fits"</span>,</span>
<span id="cb78-34"><a href="#cb78-34"></a>    <span class="at">color =</span> <span class="st">"Model"</span></span>
<span id="cb78-35"><a href="#cb78-35"></a>  ) <span class="sc">+</span></span>
<span id="cb78-36"><a href="#cb78-36"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb78-37"><a href="#cb78-37"></a>  <span class="fu">theme</span>(</span>
<span id="cb78-38"><a href="#cb78-38"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb78-39"><a href="#cb78-39"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb78-40"><a href="#cb78-40"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb78-41"><a href="#cb78-41"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="categorical-regressors" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="categorical-regressors"><span class="header-section-number">1.4.3</span> Categorical Regressors</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Dummy Variables for Categorical Predictors
</div>
</div>
<div class="callout-body-container callout-body">
<p>When predictors are categorical, use dummy variables:</p>
<p><strong>Binary Categorical Variable (2 levels):</strong></p>
<p>For variable with levels A and B:</p>
<ul>
<li><p>x = 0 for level A</p></li>
<li><p>x = 1 for level B</p></li>
</ul>
<p><strong>Multi-level Categorical Variable (k levels):</strong></p>
<p>Use k-1 dummy variables:</p>
<p><span class="math display">x_1 = \begin{cases} 1 &amp; \text{if level 2} \\ 0 &amp; \text{otherwise} \end{cases}</span></p>
<p><span class="math display">x_2 = \begin{cases} 1 &amp; \text{if level 3} \\ 0 &amp; \text{otherwise} \end{cases}</span></p>
<p><span class="math display">\vdots</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>Reference level: All dummy variables = 0</p></li>
<li><p>β₀: Mean response for reference level</p></li>
<li><p>βⱼ: Difference in mean response between level j+1 and reference level</p></li>
</ul>
</div>
</div>
</section>
<section id="example-categorical-variables" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="example-categorical-variables"><span class="header-section-number">1.4.4</span> Example: Categorical Variables</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A quality engineer studies how supplier and heat treatment affect strength:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false"></a><a href="data/strength_categorical.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Categorical Variables Example - First 15 observations:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    observation supplier heat_treatment  strength
          &lt;int&gt;   &lt;char&gt;         &lt;char&gt;     &lt;num&gt;
 1:           1        A             No  96.20567
 2:           2        A            Yes 121.76799
 3:           3        A             No  98.99465
 4:           4        A            Yes 112.79896
 5:           5        A             No 106.48668
 6:           6        A            Yes 106.10137
 7:           7        A             No  95.80303
 8:           8        A            Yes 119.79145
 9:           9        A             No 102.14922
10:          10        A            Yes 117.88237
11:          11        A             No 100.10912
12:          12        A            Yes 115.25777
13:          13        A             No  92.78922
14:          14        A            Yes 130.48557
15:          15        A             No 103.01518</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Summary by Supplier and Heat Treatment:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   supplier heat_treatment     n mean_strength sd_strength min_strength
     &lt;char&gt;         &lt;char&gt; &lt;int&gt;         &lt;num&gt;       &lt;num&gt;        &lt;num&gt;
1:        A             No    10      99.89853    4.317355     92.78922
2:        A            Yes    10     117.80654    6.941354    106.10137
3:        B             No    10     111.01700    5.039307    100.85786
4:        B            Yes    10     125.45412    4.000820    117.65973
5:        C             No    10     102.42515    4.899730     94.05402
6:        C            Yes    10     131.78177    6.143025    119.69643
   max_strength
          &lt;num&gt;
1:     106.4867
2:     130.4856
3:     117.6057
4:     129.8654
5:     110.6014
6:     141.1987</code></pre>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># Categorical variables example</span></span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="fu">set.seed</span>(<span class="dv">101112</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a>strength_cat_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb83-4"><a href="#cb83-4"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>,</span>
<span id="cb83-5"><a href="#cb83-5"></a>  <span class="at">supplier =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="at">each =</span> <span class="dv">20</span>),</span>
<span id="cb83-6"><a href="#cb83-6"></a>  <span class="at">heat_treatment =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"Yes"</span>), <span class="dv">30</span>),</span>
<span id="cb83-7"><a href="#cb83-7"></a>  <span class="at">strength =</span> <span class="cn">NULL</span></span>
<span id="cb83-8"><a href="#cb83-8"></a>)</span>
<span id="cb83-9"><a href="#cb83-9"></a></span>
<span id="cb83-10"><a href="#cb83-10"></a><span class="co"># Create realistic effects</span></span>
<span id="cb83-11"><a href="#cb83-11"></a><span class="co"># Base strength: 100</span></span>
<span id="cb83-12"><a href="#cb83-12"></a><span class="co"># Supplier B: +10, Supplier C: +5 (vs A)</span></span>
<span id="cb83-13"><a href="#cb83-13"></a><span class="co"># Heat treatment: +15</span></span>
<span id="cb83-14"><a href="#cb83-14"></a><span class="co"># Some interaction: Supplier C with heat treatment gets extra +8</span></span>
<span id="cb83-15"><a href="#cb83-15"></a>strength_cat_data[, strength <span class="sc">:</span><span class="er">=</span> <span class="dv">100</span> <span class="sc">+</span></span>
<span id="cb83-16"><a href="#cb83-16"></a>  <span class="fu">ifelse</span>(supplier <span class="sc">==</span> <span class="st">"B"</span>, <span class="dv">10</span>, <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb83-17"><a href="#cb83-17"></a>  <span class="fu">ifelse</span>(supplier <span class="sc">==</span> <span class="st">"C"</span>, <span class="dv">5</span>, <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb83-18"><a href="#cb83-18"></a>  <span class="fu">ifelse</span>(heat_treatment <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">15</span>, <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb83-19"><a href="#cb83-19"></a>  <span class="fu">ifelse</span>(supplier <span class="sc">==</span> <span class="st">"C"</span> <span class="sc">&amp;</span> heat_treatment <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">8</span>, <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb83-20"><a href="#cb83-20"></a>  <span class="fu">rnorm</span>(<span class="dv">60</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">5</span>)]</span>
<span id="cb83-21"><a href="#cb83-21"></a></span>
<span id="cb83-22"><a href="#cb83-22"></a><span class="fu">print</span>(<span class="st">"Categorical Variables Example - First 15 observations:"</span>)</span>
<span id="cb83-23"><a href="#cb83-23"></a><span class="fu">print</span>(<span class="fu">head</span>(strength_cat_data, <span class="dv">15</span>))</span>
<span id="cb83-24"><a href="#cb83-24"></a></span>
<span id="cb83-25"><a href="#cb83-25"></a><span class="co"># Summary by groups</span></span>
<span id="cb83-26"><a href="#cb83-26"></a>group_summary <span class="ot">&lt;-</span> strength_cat_data <span class="sc">%&gt;%</span></span>
<span id="cb83-27"><a href="#cb83-27"></a>  <span class="fu">fgroup_by</span>(supplier, heat_treatment) <span class="sc">%&gt;%</span></span>
<span id="cb83-28"><a href="#cb83-28"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb83-29"><a href="#cb83-29"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(strength),</span>
<span id="cb83-30"><a href="#cb83-30"></a>    <span class="at">mean_strength =</span> <span class="fu">fmean</span>(strength),</span>
<span id="cb83-31"><a href="#cb83-31"></a>    <span class="at">sd_strength =</span> <span class="fu">fsd</span>(strength),</span>
<span id="cb83-32"><a href="#cb83-32"></a>    <span class="at">min_strength =</span> <span class="fu">fmin</span>(strength),</span>
<span id="cb83-33"><a href="#cb83-33"></a>    <span class="at">max_strength =</span> <span class="fu">fmax</span>(strength)</span>
<span id="cb83-34"><a href="#cb83-34"></a>  )</span>
<span id="cb83-35"><a href="#cb83-35"></a></span>
<span id="cb83-36"><a href="#cb83-36"></a><span class="fu">print</span>(<span class="st">"Summary by Supplier and Heat Treatment:"</span>)</span>
<span id="cb83-37"><a href="#cb83-37"></a><span class="fu">print</span>(group_summary)</span>
<span id="cb83-38"><a href="#cb83-38"></a></span>
<span id="cb83-39"><a href="#cb83-39"></a><span class="co"># Write data to CSV</span></span>
<span id="cb83-40"><a href="#cb83-40"></a><span class="fu">fwrite</span>(strength_cat_data, <span class="st">"data/strength_categorical.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">

</div>
</div>
</div>
<p><strong>Model with Categorical Variables:</strong></p>
<p><span class="math display">Strength = \beta_0 + \beta_1 \times Supplier_B + \beta_2 \times Supplier_C + \beta_3 \times HeatTreat_{Yes} + \epsilon</span></p>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p>β₀: Mean strength for Supplier A, no heat treatment</p></li>
<li><p>β₁: Effect of Supplier B vs.&nbsp;Supplier A</p></li>
<li><p>β₂: Effect of Supplier C vs.&nbsp;Supplier A</p></li>
<li><p>β₃: Effect of heat treatment</p></li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Main Effects Model:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = strength ~ supplier + heat_treatment, data = strength_cat_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.0348  -4.0101   0.5405   3.7302  13.8116 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         98.569      1.596  61.766  &lt; 2e-16 ***
supplierB            9.383      1.954   4.801 1.22e-05 ***
supplierC            8.251      1.954   4.222 8.99e-05 ***
heat_treatmentYes   20.567      1.596  12.888  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.181 on 56 degrees of freedom
Multiple R-squared:  0.7756,    Adjusted R-squared:  0.7636 
F-statistic: 64.52 on 3 and 56 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model with Interaction:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = strength ~ supplier * heat_treatment, data = strength_cat_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-12.0853  -2.9002   0.1333   3.1805  12.6790 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   99.899      1.683  59.354  &lt; 2e-16 ***
supplierB                     11.118      2.380   4.671 2.03e-05 ***
supplierC                      2.527      2.380   1.061  0.29319    
heat_treatmentYes             17.908      2.380   7.524 5.82e-10 ***
supplierB:heat_treatmentYes   -3.471      3.366  -1.031  0.30709    
supplierC:heat_treatmentYes   11.449      3.366   3.401  0.00127 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.322 on 54 degrees of freedom
Multiple R-squared:  0.8395,    Adjusted R-squared:  0.8247 
F-statistic: 56.51 on 5 and 54 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Manual Dummy Variable Model (should match main effects):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = strength ~ supplier_B + supplier_C + heat_yes, data = strength_cat_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.0348  -4.0101   0.5405   3.7302  13.8116 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   98.569      1.596  61.766  &lt; 2e-16 ***
supplier_B     9.383      1.954   4.801 1.22e-05 ***
supplier_C     8.251      1.954   4.222 8.99e-05 ***
heat_yes      20.567      1.596  12.888  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.181 on 56 degrees of freedom
Multiple R-squared:  0.7756,    Adjusted R-squared:  0.7636 
F-statistic: 64.52 on 3 and 56 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Coefficient Interpretation:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      Coefficient Value                                  Interpretation
           &lt;char&gt; &lt;num&gt;                                          &lt;char&gt;
1:      Intercept 98.57 Mean strength for Supplier A, no heat treatment
2:     Supplier B  9.38         Additional strength for Supplier B vs A
3:     Supplier C  8.25         Additional strength for Supplier C vs A
4: Heat Treatment 20.57         Additional strength from heat treatment</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-test for overall supplier effect:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: strength ~ heat_treatment
Model 2: strength ~ supplier + heat_treatment
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     58 3188.6                                  
2     56 2139.2  2    1049.3 13.735 1.401e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-test for interaction effect:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: strength ~ supplier + heat_treatment
Model 2: strength ~ supplier * heat_treatment
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     56 2139.2                                  
2     54 1529.7  2    609.52 10.758 0.0001168 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="co"># Regression with categorical variables</span></span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="co"># R automatically creates dummy variables with factor variables</span></span>
<span id="cb96-3"><a href="#cb96-3"></a>strength_cat_data[, supplier <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(supplier)]</span>
<span id="cb96-4"><a href="#cb96-4"></a>strength_cat_data[, heat_treatment <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(heat_treatment)]</span>
<span id="cb96-5"><a href="#cb96-5"></a></span>
<span id="cb96-6"><a href="#cb96-6"></a><span class="co"># Main effects model</span></span>
<span id="cb96-7"><a href="#cb96-7"></a>lm_cat_main <span class="ot">&lt;-</span> <span class="fu">lm</span>(strength <span class="sc">~</span> supplier <span class="sc">+</span> heat_treatment, <span class="at">data =</span> strength_cat_data)</span>
<span id="cb96-8"><a href="#cb96-8"></a></span>
<span id="cb96-9"><a href="#cb96-9"></a><span class="co"># Model with interaction</span></span>
<span id="cb96-10"><a href="#cb96-10"></a>lm_cat_interact <span class="ot">&lt;-</span> <span class="fu">lm</span>(strength <span class="sc">~</span> supplier <span class="sc">*</span> heat_treatment, <span class="at">data =</span> strength_cat_data)</span>
<span id="cb96-11"><a href="#cb96-11"></a></span>
<span id="cb96-12"><a href="#cb96-12"></a><span class="fu">print</span>(<span class="st">"Main Effects Model:"</span>)</span>
<span id="cb96-13"><a href="#cb96-13"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm_cat_main))</span>
<span id="cb96-14"><a href="#cb96-14"></a></span>
<span id="cb96-15"><a href="#cb96-15"></a><span class="fu">print</span>(<span class="st">"Model with Interaction:"</span>)</span>
<span id="cb96-16"><a href="#cb96-16"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm_cat_interact))</span>
<span id="cb96-17"><a href="#cb96-17"></a></span>
<span id="cb96-18"><a href="#cb96-18"></a><span class="co"># Manual dummy variable creation for illustration</span></span>
<span id="cb96-19"><a href="#cb96-19"></a>strength_cat_data[, supplier_B <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(supplier <span class="sc">==</span> <span class="st">"B"</span>, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb96-20"><a href="#cb96-20"></a>strength_cat_data[, supplier_C <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(supplier <span class="sc">==</span> <span class="st">"C"</span>, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb96-21"><a href="#cb96-21"></a>strength_cat_data[, heat_yes <span class="sc">:</span><span class="er">=</span> <span class="fu">ifelse</span>(heat_treatment <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)]</span>
<span id="cb96-22"><a href="#cb96-22"></a></span>
<span id="cb96-23"><a href="#cb96-23"></a><span class="co"># Manual model with dummy variables</span></span>
<span id="cb96-24"><a href="#cb96-24"></a>lm_manual_dummy <span class="ot">&lt;-</span> <span class="fu">lm</span>(strength <span class="sc">~</span> supplier_B <span class="sc">+</span> supplier_C <span class="sc">+</span> heat_yes, <span class="at">data =</span> strength_cat_data)</span>
<span id="cb96-25"><a href="#cb96-25"></a></span>
<span id="cb96-26"><a href="#cb96-26"></a><span class="fu">print</span>(<span class="st">"Manual Dummy Variable Model (should match main effects):"</span>)</span>
<span id="cb96-27"><a href="#cb96-27"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm_manual_dummy))</span>
<span id="cb96-28"><a href="#cb96-28"></a></span>
<span id="cb96-29"><a href="#cb96-29"></a><span class="co"># Interpret coefficients</span></span>
<span id="cb96-30"><a href="#cb96-30"></a>coef_interpretation <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb96-31"><a href="#cb96-31"></a>  <span class="at">Coefficient =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Supplier B"</span>, <span class="st">"Supplier C"</span>, <span class="st">"Heat Treatment"</span>),</span>
<span id="cb96-32"><a href="#cb96-32"></a>  <span class="at">Value =</span> <span class="fu">round</span>(<span class="fu">coef</span>(lm_cat_main), <span class="dv">2</span>),</span>
<span id="cb96-33"><a href="#cb96-33"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb96-34"><a href="#cb96-34"></a>    <span class="st">"Mean strength for Supplier A, no heat treatment"</span>,</span>
<span id="cb96-35"><a href="#cb96-35"></a>    <span class="st">"Additional strength for Supplier B vs A"</span>,</span>
<span id="cb96-36"><a href="#cb96-36"></a>    <span class="st">"Additional strength for Supplier C vs A"</span>,</span>
<span id="cb96-37"><a href="#cb96-37"></a>    <span class="st">"Additional strength from heat treatment"</span></span>
<span id="cb96-38"><a href="#cb96-38"></a>  )</span>
<span id="cb96-39"><a href="#cb96-39"></a>)</span>
<span id="cb96-40"><a href="#cb96-40"></a></span>
<span id="cb96-41"><a href="#cb96-41"></a><span class="fu">print</span>(<span class="st">"Coefficient Interpretation:"</span>)</span>
<span id="cb96-42"><a href="#cb96-42"></a><span class="fu">print</span>(coef_interpretation)</span>
<span id="cb96-43"><a href="#cb96-43"></a></span>
<span id="cb96-44"><a href="#cb96-44"></a><span class="co"># Test significance of categorical variables</span></span>
<span id="cb96-45"><a href="#cb96-45"></a><span class="co"># Test overall supplier effect</span></span>
<span id="cb96-46"><a href="#cb96-46"></a>anova_supplier <span class="ot">&lt;-</span> <span class="fu">anova</span>(<span class="fu">lm</span>(strength <span class="sc">~</span> heat_treatment, <span class="at">data =</span> strength_cat_data), lm_cat_main)</span>
<span id="cb96-47"><a href="#cb96-47"></a><span class="fu">print</span>(<span class="st">"F-test for overall supplier effect:"</span>)</span>
<span id="cb96-48"><a href="#cb96-48"></a><span class="fu">print</span>(anova_supplier)</span>
<span id="cb96-49"><a href="#cb96-49"></a></span>
<span id="cb96-50"><a href="#cb96-50"></a><span class="co"># Test interaction effect</span></span>
<span id="cb96-51"><a href="#cb96-51"></a>anova_interaction <span class="ot">&lt;-</span> <span class="fu">anova</span>(lm_cat_main, lm_cat_interact)</span>
<span id="cb96-52"><a href="#cb96-52"></a><span class="fu">print</span>(<span class="st">"F-test for interaction effect:"</span>)</span>
<span id="cb96-53"><a href="#cb96-53"></a><span class="fu">print</span>(anova_interaction)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model Statistics Comparison:"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in Math.data.frame(structure(list(Model = c("Main Effects", "With Interaction": non-numeric-alike variable(s) in data frame: Model</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-Ch06Code07" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code07-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: Categorical variables in regression"><img src="Ch06_files/figure-html/fig-Ch06Code07-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Categorical variables in regression
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="co"># Visualization of categorical variables</span></span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="co"># Box plots by groups</span></span>
<span id="cb99-3"><a href="#cb99-3"></a>p1_cat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> strength_cat_data, <span class="fu">aes</span>(<span class="at">x =</span> supplier, <span class="at">y =</span> strength, <span class="at">fill =</span> heat_treatment)) <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5"></a>  <span class="fu">labs</span>(</span>
<span id="cb99-6"><a href="#cb99-6"></a>    <span class="at">x =</span> <span class="st">"Supplier"</span>, <span class="at">y =</span> <span class="st">"Strength"</span>, <span class="at">fill =</span> <span class="st">"Heat Treatment"</span>,</span>
<span id="cb99-7"><a href="#cb99-7"></a>    <span class="at">title =</span> <span class="st">"Strength by Supplier and Heat Treatment"</span></span>
<span id="cb99-8"><a href="#cb99-8"></a>  ) <span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb99-10"><a href="#cb99-10"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb99-11"><a href="#cb99-11"></a></span>
<span id="cb99-12"><a href="#cb99-12"></a><span class="co"># Interaction plot</span></span>
<span id="cb99-13"><a href="#cb99-13"></a>interaction_means <span class="ot">&lt;-</span> strength_cat_data <span class="sc">%&gt;%</span></span>
<span id="cb99-14"><a href="#cb99-14"></a>  <span class="fu">fgroup_by</span>(supplier, heat_treatment) <span class="sc">%&gt;%</span></span>
<span id="cb99-15"><a href="#cb99-15"></a>  <span class="fu">fsummarise</span>(<span class="at">mean_strength =</span> <span class="fu">fmean</span>(strength))</span>
<span id="cb99-16"><a href="#cb99-16"></a></span>
<span id="cb99-17"><a href="#cb99-17"></a>p2_cat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> interaction_means, <span class="fu">aes</span>(</span>
<span id="cb99-18"><a href="#cb99-18"></a>  <span class="at">x =</span> supplier, <span class="at">y =</span> mean_strength,</span>
<span id="cb99-19"><a href="#cb99-19"></a>  <span class="at">color =</span> heat_treatment, <span class="at">group =</span> heat_treatment</span>
<span id="cb99-20"><a href="#cb99-20"></a>)) <span class="sc">+</span></span>
<span id="cb99-21"><a href="#cb99-21"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb99-22"><a href="#cb99-22"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb99-23"><a href="#cb99-23"></a>  <span class="fu">labs</span>(</span>
<span id="cb99-24"><a href="#cb99-24"></a>    <span class="at">x =</span> <span class="st">"Supplier"</span>, <span class="at">y =</span> <span class="st">"Mean Strength"</span>, <span class="at">color =</span> <span class="st">"Heat Treatment"</span>,</span>
<span id="cb99-25"><a href="#cb99-25"></a>    <span class="at">title =</span> <span class="st">"Interaction Plot"</span></span>
<span id="cb99-26"><a href="#cb99-26"></a>  ) <span class="sc">+</span></span>
<span id="cb99-27"><a href="#cb99-27"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb99-28"><a href="#cb99-28"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb99-29"><a href="#cb99-29"></a></span>
<span id="cb99-30"><a href="#cb99-30"></a><span class="co"># Residuals from interaction model</span></span>
<span id="cb99-31"><a href="#cb99-31"></a>resid_interact <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm_cat_interact)</span>
<span id="cb99-32"><a href="#cb99-32"></a>fitted_interact <span class="ot">&lt;-</span> <span class="fu">fitted</span>(lm_cat_interact)</span>
<span id="cb99-33"><a href="#cb99-33"></a></span>
<span id="cb99-34"><a href="#cb99-34"></a>p3_cat <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb99-35"><a href="#cb99-35"></a>  <span class="at">data =</span> <span class="fu">data.table</span>(<span class="at">fitted =</span> fitted_interact, <span class="at">residuals =</span> resid_interact),</span>
<span id="cb99-36"><a href="#cb99-36"></a>  <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)</span>
<span id="cb99-37"><a href="#cb99-37"></a>) <span class="sc">+</span></span>
<span id="cb99-38"><a href="#cb99-38"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb99-39"><a href="#cb99-39"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb99-40"><a href="#cb99-40"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb99-41"><a href="#cb99-41"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">title =</span> <span class="st">"Residuals vs Fitted"</span>) <span class="sc">+</span></span>
<span id="cb99-42"><a href="#cb99-42"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb99-43"><a href="#cb99-43"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb99-44"><a href="#cb99-44"></a></span>
<span id="cb99-45"><a href="#cb99-45"></a><span class="co"># Model comparison table</span></span>
<span id="cb99-46"><a href="#cb99-46"></a>model_stats_cat <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb99-47"><a href="#cb99-47"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Main Effects"</span>, <span class="st">"With Interaction"</span>),</span>
<span id="cb99-48"><a href="#cb99-48"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(<span class="fu">summary</span>(lm_cat_main)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(lm_cat_interact)<span class="sc">$</span>r.squared),</span>
<span id="cb99-49"><a href="#cb99-49"></a>  <span class="at">Adj_R_squared =</span> <span class="fu">c</span>(<span class="fu">summary</span>(lm_cat_main)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(lm_cat_interact)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb99-50"><a href="#cb99-50"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(lm_cat_main), <span class="fu">AIC</span>(lm_cat_interact)),</span>
<span id="cb99-51"><a href="#cb99-51"></a>  <span class="at">F_statistic =</span> <span class="fu">c</span>(<span class="fu">summary</span>(lm_cat_main)<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="fu">summary</span>(lm_cat_interact)<span class="sc">$</span>fstatistic[<span class="dv">1</span>])</span>
<span id="cb99-52"><a href="#cb99-52"></a>)</span>
<span id="cb99-53"><a href="#cb99-53"></a></span>
<span id="cb99-54"><a href="#cb99-54"></a><span class="fu">print</span>(<span class="st">"Model Statistics Comparison:"</span>)</span>
<span id="cb99-55"><a href="#cb99-55"></a><span class="fu">print</span>(<span class="fu">round</span>(model_stats_cat, <span class="dv">3</span>))</span>
<span id="cb99-56"><a href="#cb99-56"></a></span>
<span id="cb99-57"><a href="#cb99-57"></a><span class="fu">grid.arrange</span>(p1_cat, p2_cat, p3_cat, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="variable-selection-techniques" class="level3" data-number="1.4.5">
<h3 data-number="1.4.5" class="anchored" data-anchor-id="variable-selection-techniques"><span class="header-section-number">1.4.5</span> Variable Selection Techniques</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Model Selection Methods
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Forward Selection:</strong></p>
<ol type="1">
<li><p>Start with no variables</p></li>
<li><p>Add variables one by one</p></li>
<li><p>Stop when no improvement</p></li>
</ol>
<p><strong>Backward Elimination:</strong></p>
<ol type="1">
<li><p>Start with all variables</p></li>
<li><p>Remove variables one by one</p></li>
<li><p>Stop when all remaining are significant</p></li>
</ol>
<p><strong>Stepwise Selection:</strong></p>
<ol type="1">
<li><p>Combine forward and backward</p></li>
<li><p>Can add or remove at each step</p></li>
<li><p>More flexible approach</p></li>
</ol>
<p><strong>Selection Criteria:</strong></p>
<ul>
<li><p><strong>AIC (Akaike Information Criterion):</strong> <span class="math inline">AIC = n \ln(SS_E/n) + 2(k+1)</span></p></li>
<li><p><strong>BIC (Bayesian Information Criterion):</strong> <span class="math inline">BIC = n \ln(SS_E/n) + (k+1)\ln(n)</span></p></li>
<li><p><strong>Adjusted R²:</strong> Penalizes for additional variables</p></li>
<li><p><strong>Mallows’ Cp:</strong> <span class="math inline">C_p = \frac{SS_E}{MS_E} + 2(k+1) - n</span></p></li>
</ul>
<p><strong>Best Practices:</strong></p>
<ul>
<li><p>Use multiple criteria</p></li>
<li><p>Cross-validate final model</p></li>
<li><p>Consider subject matter knowledge</p></li>
<li><p>Avoid overfitting</p></li>
</ul>
</div>
</div>
</section>
<section id="example-variable-selection" class="level3" data-number="1.4.6">
<h3 data-number="1.4.6" class="anchored" data-anchor-id="example-variable-selection"><span class="header-section-number">1.4.6</span> Example: Variable Selection</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>An engineer has multiple potential predictors for product quality and wants to identify the most important ones:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false"></a><a href="data/quality_predictors.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Quality Prediction Data Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Variable Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation Matrix:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>              temperature pressure flow_rate     pH catalyst_conc   time
temperature         1.000   -0.143     0.075  0.022         0.142  0.023
pressure           -0.143    1.000    -0.035  0.369        -0.114 -0.172
flow_rate           0.075   -0.035     1.000  0.370         0.084 -0.061
pH                  0.022    0.369     0.370  1.000         0.121 -0.140
catalyst_conc       0.142   -0.114     0.084  0.121         1.000  0.071
time                0.023   -0.172    -0.061 -0.140         0.071  1.000
quality             0.771    0.284     0.157  0.381         0.282 -0.017
              quality
temperature     0.771
pressure        0.284
flow_rate       0.157
pH              0.381
catalyst_conc   0.282
time           -0.017
quality         1.000</code></pre>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="co"># Variable selection example</span></span>
<span id="cb104-2"><a href="#cb104-2"></a><span class="fu">set.seed</span>(<span class="dv">131415</span>)</span>
<span id="cb104-3"><a href="#cb104-3"></a>quality_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb104-4"><a href="#cb104-4"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,</span>
<span id="cb104-5"><a href="#cb104-5"></a>  <span class="at">temperature =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">20</span>),</span>
<span id="cb104-6"><a href="#cb104-6"></a>  <span class="at">pressure =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb104-7"><a href="#cb104-7"></a>  <span class="at">flow_rate =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb104-8"><a href="#cb104-8"></a>  <span class="at">pH =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">7</span>, <span class="at">sd =</span> <span class="fl">0.5</span>),</span>
<span id="cb104-9"><a href="#cb104-9"></a>  <span class="at">catalyst_conc =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="fl">0.1</span>, <span class="at">sd =</span> <span class="fl">0.02</span>),</span>
<span id="cb104-10"><a href="#cb104-10"></a>  <span class="at">time =</span> <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">60</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb104-11"><a href="#cb104-11"></a>  <span class="at">quality =</span> <span class="cn">NULL</span></span>
<span id="cb104-12"><a href="#cb104-12"></a>)</span>
<span id="cb104-13"><a href="#cb104-13"></a></span>
<span id="cb104-14"><a href="#cb104-14"></a><span class="co"># Create realistic relationship where only some variables matter</span></span>
<span id="cb104-15"><a href="#cb104-15"></a><span class="co"># Important: temperature, pressure, catalyst_conc</span></span>
<span id="cb104-16"><a href="#cb104-16"></a><span class="co"># Less important: pH</span></span>
<span id="cb104-17"><a href="#cb104-17"></a><span class="co"># Not important: flow_rate, time</span></span>
<span id="cb104-18"><a href="#cb104-18"></a>quality_data[, quality <span class="sc">:</span><span class="er">=</span> <span class="dv">50</span> <span class="sc">+</span></span>
<span id="cb104-19"><a href="#cb104-19"></a>  <span class="fl">0.3</span> <span class="sc">*</span> temperature <span class="sc">+</span></span>
<span id="cb104-20"><a href="#cb104-20"></a>  <span class="fl">2.0</span> <span class="sc">*</span> pressure <span class="sc">+</span></span>
<span id="cb104-21"><a href="#cb104-21"></a>  <span class="dv">100</span> <span class="sc">*</span> catalyst_conc <span class="sc">+</span></span>
<span id="cb104-22"><a href="#cb104-22"></a>  <span class="fl">3.0</span> <span class="sc">*</span> pH <span class="sc">+</span></span>
<span id="cb104-23"><a href="#cb104-23"></a>  <span class="fl">0.1</span> <span class="sc">*</span> flow_rate <span class="sc">+</span> <span class="co"># weak effect</span></span>
<span id="cb104-24"><a href="#cb104-24"></a>  <span class="fl">0.05</span> <span class="sc">*</span> time <span class="sc">+</span> <span class="co"># very weak effect</span></span>
<span id="cb104-25"><a href="#cb104-25"></a>  <span class="fu">rnorm</span>(<span class="dv">50</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">3</span>)]</span>
<span id="cb104-26"><a href="#cb104-26"></a></span>
<span id="cb104-27"><a href="#cb104-27"></a><span class="fu">print</span>(<span class="st">"Quality Prediction Data Summary:"</span>)</span>
<span id="cb104-28"><a href="#cb104-28"></a>predictors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"temperature"</span>, <span class="st">"pressure"</span>, <span class="st">"flow_rate"</span>, <span class="st">"pH"</span>, <span class="st">"catalyst_conc"</span>, <span class="st">"time"</span>)</span>
<span id="cb104-29"><a href="#cb104-29"></a>summary_stats <span class="ot">&lt;-</span> quality_data[, <span class="fu">lapply</span>(.SD, <span class="cf">function</span>(x) <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(x), <span class="at">sd =</span> <span class="fu">sd</span>(x))),</span>
<span id="cb104-30"><a href="#cb104-30"></a>  .SDcols <span class="ot">=</span> <span class="fu">c</span>(predictors, <span class="st">"quality"</span>)</span>
<span id="cb104-31"><a href="#cb104-31"></a>]</span>
<span id="cb104-32"><a href="#cb104-32"></a></span>
<span id="cb104-33"><a href="#cb104-33"></a><span class="fu">print</span>(<span class="st">"Variable Summary:"</span>)</span>
<span id="cb104-34"><a href="#cb104-34"></a><span class="cf">for</span> (var <span class="cf">in</span> <span class="fu">names</span>(summary_stats)) {</span>
<span id="cb104-35"><a href="#cb104-35"></a>  <span class="fu">cat</span>(<span class="fu">sprintf</span>(</span>
<span id="cb104-36"><a href="#cb104-36"></a>    <span class="st">"%s: Mean = %.3f, SD = %.3f</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb104-37"><a href="#cb104-37"></a>    var, summary_stats[[var]]<span class="sc">$</span>mean, summary_stats[[var]]<span class="sc">$</span>sd</span>
<span id="cb104-38"><a href="#cb104-38"></a>  ))</span>
<span id="cb104-39"><a href="#cb104-39"></a>}</span>
<span id="cb104-40"><a href="#cb104-40"></a></span>
<span id="cb104-41"><a href="#cb104-41"></a><span class="co"># Correlation matrix</span></span>
<span id="cb104-42"><a href="#cb104-42"></a>cor_matrix_quality <span class="ot">&lt;-</span> <span class="fu">cor</span>(quality_data[, .SD, <span class="at">.SDcols =</span> <span class="fu">c</span>(predictors, <span class="st">"quality"</span>)])</span>
<span id="cb104-43"><a href="#cb104-43"></a><span class="fu">print</span>(<span class="st">"Correlation Matrix:"</span>)</span>
<span id="cb104-44"><a href="#cb104-44"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix_quality, <span class="dv">3</span>))</span>
<span id="cb104-45"><a href="#cb104-45"></a></span>
<span id="cb104-46"><a href="#cb104-46"></a><span class="co"># Write data to CSV</span></span>
<span id="cb104-47"><a href="#cb104-47"></a><span class="fu">fwrite</span>(quality_data, <span class="st">"data/quality_predictors.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">

</div>
</div>
</div>
<p><strong>Available Predictors:</strong></p>
<ul>
<li>Temperature, Pressure, Flow_Rate, pH, Catalyst_Conc, Time</li>
</ul>
<p><strong>Selection Process:</strong></p>
<ol type="1">
<li><p><strong>All Possible Models:</strong> Evaluate all 2^k possible models</p></li>
<li><p><strong>Stepwise Selection:</strong> Use automated procedures</p></li>
<li><p><strong>Criterion-Based:</strong> Compare AIC, BIC, Cp values</p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model Selection Summary:"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in Math.data.frame(structure(list(Method = c("Full Model", "Stepwise AIC", : non-numeric-alike variable(s) in data frame: Method</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Final Selected Model Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = quality ~ temperature + pressure + pH + catalyst_conc, 
    data = quality_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.5183 -2.0431 -0.2991  2.2480  6.2915 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    64.4306     7.9554   8.099 2.47e-10 ***
temperature     0.2677     0.0208  12.872  &lt; 2e-16 ***
pressure        1.3271     0.2602   5.100 6.58e-06 ***
pH              3.5314     1.0675   3.308  0.00185 ** 
catalyst_conc  78.7116    26.5539   2.964  0.00484 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.074 on 45 degrees of freedom
Multiple R-squared:  0.838, Adjusted R-squared:  0.8236 
F-statistic: 58.19 on 4 and 45 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Selected Variables:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "temperature"   "pressure"      "pH"            "catalyst_conc"</code></pre>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="co"># Variable selection procedures</span></span>
<span id="cb111-2"><a href="#cb111-2"></a></span>
<span id="cb111-3"><a href="#cb111-3"></a><span class="co"># Full model with all predictors</span></span>
<span id="cb111-4"><a href="#cb111-4"></a>lm_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> temperature <span class="sc">+</span> pressure <span class="sc">+</span> flow_rate <span class="sc">+</span> pH <span class="sc">+</span> catalyst_conc <span class="sc">+</span> time,</span>
<span id="cb111-5"><a href="#cb111-5"></a>  <span class="at">data =</span> quality_data</span>
<span id="cb111-6"><a href="#cb111-6"></a>)</span>
<span id="cb111-7"><a href="#cb111-7"></a></span>
<span id="cb111-8"><a href="#cb111-8"></a><span class="co"># Stepwise selection using AIC</span></span>
<span id="cb111-9"><a href="#cb111-9"></a>step_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_full, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb111-10"><a href="#cb111-10"></a></span>
<span id="cb111-11"><a href="#cb111-11"></a><span class="co"># Forward selection starting from intercept only</span></span>
<span id="cb111-12"><a href="#cb111-12"></a>lm_intercept <span class="ot">&lt;-</span> <span class="fu">lm</span>(quality <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> quality_data)</span>
<span id="cb111-13"><a href="#cb111-13"></a>step_forward <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_intercept,</span>
<span id="cb111-14"><a href="#cb111-14"></a>  <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> lm_intercept, <span class="at">upper =</span> lm_full),</span>
<span id="cb111-15"><a href="#cb111-15"></a>  <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span></span>
<span id="cb111-16"><a href="#cb111-16"></a>)</span>
<span id="cb111-17"><a href="#cb111-17"></a></span>
<span id="cb111-18"><a href="#cb111-18"></a><span class="co"># Backward elimination starting from full model</span></span>
<span id="cb111-19"><a href="#cb111-19"></a>step_backward <span class="ot">&lt;-</span> <span class="fu">step</span>(lm_full, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb111-20"><a href="#cb111-20"></a></span>
<span id="cb111-21"><a href="#cb111-21"></a><span class="co"># Compare selected models</span></span>
<span id="cb111-22"><a href="#cb111-22"></a>model_selection_summary <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb111-23"><a href="#cb111-23"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Full Model"</span>, <span class="st">"Stepwise AIC"</span>, <span class="st">"Forward AIC"</span>, <span class="st">"Backward AIC"</span>),</span>
<span id="cb111-24"><a href="#cb111-24"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb111-25"><a href="#cb111-25"></a>    <span class="fu">summary</span>(lm_full)<span class="sc">$</span>r.squared,</span>
<span id="cb111-26"><a href="#cb111-26"></a>    <span class="fu">summary</span>(step_aic)<span class="sc">$</span>r.squared,</span>
<span id="cb111-27"><a href="#cb111-27"></a>    <span class="fu">summary</span>(step_forward)<span class="sc">$</span>r.squared,</span>
<span id="cb111-28"><a href="#cb111-28"></a>    <span class="fu">summary</span>(step_backward)<span class="sc">$</span>r.squared</span>
<span id="cb111-29"><a href="#cb111-29"></a>  ),</span>
<span id="cb111-30"><a href="#cb111-30"></a>  <span class="at">Adj_R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb111-31"><a href="#cb111-31"></a>    <span class="fu">summary</span>(lm_full)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb111-32"><a href="#cb111-32"></a>    <span class="fu">summary</span>(step_aic)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb111-33"><a href="#cb111-33"></a>    <span class="fu">summary</span>(step_forward)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb111-34"><a href="#cb111-34"></a>    <span class="fu">summary</span>(step_backward)<span class="sc">$</span>adj.r.squared</span>
<span id="cb111-35"><a href="#cb111-35"></a>  ),</span>
<span id="cb111-36"><a href="#cb111-36"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(lm_full), <span class="fu">AIC</span>(step_aic), <span class="fu">AIC</span>(step_forward), <span class="fu">AIC</span>(step_backward)),</span>
<span id="cb111-37"><a href="#cb111-37"></a>  <span class="at">BIC =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(lm_full), <span class="fu">BIC</span>(step_aic), <span class="fu">BIC</span>(step_forward), <span class="fu">BIC</span>(step_backward)),</span>
<span id="cb111-38"><a href="#cb111-38"></a>  <span class="at">n_parameters =</span> <span class="fu">c</span>(</span>
<span id="cb111-39"><a href="#cb111-39"></a>    <span class="fu">length</span>(<span class="fu">coef</span>(lm_full)),</span>
<span id="cb111-40"><a href="#cb111-40"></a>    <span class="fu">length</span>(<span class="fu">coef</span>(step_aic)),</span>
<span id="cb111-41"><a href="#cb111-41"></a>    <span class="fu">length</span>(<span class="fu">coef</span>(step_forward)),</span>
<span id="cb111-42"><a href="#cb111-42"></a>    <span class="fu">length</span>(<span class="fu">coef</span>(step_backward))</span>
<span id="cb111-43"><a href="#cb111-43"></a>  )</span>
<span id="cb111-44"><a href="#cb111-44"></a>)</span>
<span id="cb111-45"><a href="#cb111-45"></a></span>
<span id="cb111-46"><a href="#cb111-46"></a><span class="fu">print</span>(<span class="st">"Model Selection Summary:"</span>)</span>
<span id="cb111-47"><a href="#cb111-47"></a><span class="fu">print</span>(<span class="fu">round</span>(model_selection_summary[, .(Method, R_squared, Adj_R_squared, AIC, BIC, n_parameters)], <span class="dv">4</span>))</span>
<span id="cb111-48"><a href="#cb111-48"></a></span>
<span id="cb111-49"><a href="#cb111-49"></a><span class="co"># Final selected model (based on AIC stepwise)</span></span>
<span id="cb111-50"><a href="#cb111-50"></a><span class="fu">print</span>(<span class="st">"Final Selected Model Summary:"</span>)</span>
<span id="cb111-51"><a href="#cb111-51"></a><span class="fu">print</span>(<span class="fu">summary</span>(step_aic))</span>
<span id="cb111-52"><a href="#cb111-52"></a></span>
<span id="cb111-53"><a href="#cb111-53"></a><span class="co"># Extract selected variables</span></span>
<span id="cb111-54"><a href="#cb111-54"></a>selected_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">coef</span>(step_aic))[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># Remove intercept</span></span>
<span id="cb111-55"><a href="#cb111-55"></a><span class="fu">print</span>(<span class="st">"Selected Variables:"</span>)</span>
<span id="cb111-56"><a href="#cb111-56"></a><span class="fu">print</span>(selected_vars)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code08-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code08-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code08-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;8: Variable selection results"><img src="Ch06_files/figure-html/fig-Ch06Code08-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code08-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Variable selection results
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-Ch06Code08-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code08-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code08-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Figure&nbsp;9: Variable selection results"><img src="Ch06_files/figure-html/fig-Ch06Code08-2.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code08-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Variable selection results
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="co"># Variable selection visualization</span></span>
<span id="cb112-2"><a href="#cb112-2"></a></span>
<span id="cb112-3"><a href="#cb112-3"></a><span class="co"># Model comparison plot</span></span>
<span id="cb112-4"><a href="#cb112-4"></a>model_comp_data <span class="ot">&lt;-</span> model_selection_summary[, .(Method, AIC, BIC, Adj_R_squared)]</span>
<span id="cb112-5"><a href="#cb112-5"></a>model_comp_long <span class="ot">&lt;-</span> <span class="fu">melt</span>(model_comp_data,</span>
<span id="cb112-6"><a href="#cb112-6"></a>  <span class="at">id.vars =</span> <span class="st">"Method"</span>,</span>
<span id="cb112-7"><a href="#cb112-7"></a>  <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"AIC"</span>, <span class="st">"BIC"</span>),</span>
<span id="cb112-8"><a href="#cb112-8"></a>  <span class="at">variable.name =</span> <span class="st">"Criterion"</span>, <span class="at">value.name =</span> <span class="st">"Value"</span></span>
<span id="cb112-9"><a href="#cb112-9"></a>)</span>
<span id="cb112-10"><a href="#cb112-10"></a></span>
<span id="cb112-11"><a href="#cb112-11"></a>p1_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> model_comp_long, <span class="fu">aes</span>(<span class="at">x =</span> Method, <span class="at">y =</span> Value, <span class="at">fill =</span> Criterion)) <span class="sc">+</span></span>
<span id="cb112-12"><a href="#cb112-12"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb112-13"><a href="#cb112-13"></a>  <span class="fu">labs</span>(</span>
<span id="cb112-14"><a href="#cb112-14"></a>    <span class="at">x =</span> <span class="st">"Model Selection Method"</span>, <span class="at">y =</span> <span class="st">"Criterion Value"</span>,</span>
<span id="cb112-15"><a href="#cb112-15"></a>    <span class="at">title =</span> <span class="st">"Model Selection Criteria"</span>, <span class="at">fill =</span> <span class="st">"Criterion"</span></span>
<span id="cb112-16"><a href="#cb112-16"></a>  ) <span class="sc">+</span></span>
<span id="cb112-17"><a href="#cb112-17"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb112-18"><a href="#cb112-18"></a>  <span class="fu">theme</span>(</span>
<span id="cb112-19"><a href="#cb112-19"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb112-20"><a href="#cb112-20"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb112-21"><a href="#cb112-21"></a>  )</span>
<span id="cb112-22"><a href="#cb112-22"></a></span>
<span id="cb112-23"><a href="#cb112-23"></a><span class="co"># Adjusted R² comparison</span></span>
<span id="cb112-24"><a href="#cb112-24"></a>p2_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> model_selection_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Method, <span class="sc">-</span>Adj_R_squared), <span class="at">y =</span> Adj_R_squared)) <span class="sc">+</span></span>
<span id="cb112-25"><a href="#cb112-25"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb112-26"><a href="#cb112-26"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Adj_R_squared, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb112-27"><a href="#cb112-27"></a>  <span class="fu">labs</span>(</span>
<span id="cb112-28"><a href="#cb112-28"></a>    <span class="at">x =</span> <span class="st">"Model Selection Method"</span>, <span class="at">y =</span> <span class="st">"Adjusted R²"</span>,</span>
<span id="cb112-29"><a href="#cb112-29"></a>    <span class="at">title =</span> <span class="st">"Model Performance Comparison"</span></span>
<span id="cb112-30"><a href="#cb112-30"></a>  ) <span class="sc">+</span></span>
<span id="cb112-31"><a href="#cb112-31"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb112-32"><a href="#cb112-32"></a>  <span class="fu">theme</span>(</span>
<span id="cb112-33"><a href="#cb112-33"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb112-34"><a href="#cb112-34"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)</span>
<span id="cb112-35"><a href="#cb112-35"></a>  )</span>
<span id="cb112-36"><a href="#cb112-36"></a></span>
<span id="cb112-37"><a href="#cb112-37"></a><span class="co"># Final model coefficients</span></span>
<span id="cb112-38"><a href="#cb112-38"></a>final_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(step_aic)[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># Remove intercept</span></span>
<span id="cb112-39"><a href="#cb112-39"></a>coef_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb112-40"><a href="#cb112-40"></a>  <span class="at">variable =</span> <span class="fu">names</span>(final_coefs),</span>
<span id="cb112-41"><a href="#cb112-41"></a>  <span class="at">coefficient =</span> <span class="fu">as.numeric</span>(final_coefs)</span>
<span id="cb112-42"><a href="#cb112-42"></a>)</span>
<span id="cb112-43"><a href="#cb112-43"></a></span>
<span id="cb112-44"><a href="#cb112-44"></a>p3_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> coef_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, <span class="fu">abs</span>(coefficient)), <span class="at">y =</span> coefficient)) <span class="sc">+</span></span>
<span id="cb112-45"><a href="#cb112-45"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb112-46"><a href="#cb112-46"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb112-47"><a href="#cb112-47"></a>  <span class="fu">labs</span>(</span>
<span id="cb112-48"><a href="#cb112-48"></a>    <span class="at">x =</span> <span class="st">"Variable"</span>, <span class="at">y =</span> <span class="st">"Coefficient"</span>,</span>
<span id="cb112-49"><a href="#cb112-49"></a>    <span class="at">title =</span> <span class="st">"Final Model Coefficients"</span></span>
<span id="cb112-50"><a href="#cb112-50"></a>  ) <span class="sc">+</span></span>
<span id="cb112-51"><a href="#cb112-51"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb112-52"><a href="#cb112-52"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb112-53"><a href="#cb112-53"></a></span>
<span id="cb112-54"><a href="#cb112-54"></a><span class="co"># Correlation plot of selected variables</span></span>
<span id="cb112-55"><a href="#cb112-55"></a>selected_cor <span class="ot">&lt;-</span> cor_matrix_quality[<span class="fu">c</span>(selected_vars, <span class="st">"quality"</span>), <span class="fu">c</span>(selected_vars, <span class="st">"quality"</span>)]</span>
<span id="cb112-56"><a href="#cb112-56"></a></span>
<span id="cb112-57"><a href="#cb112-57"></a>p4_var <span class="ot">&lt;-</span> <span class="fu">corrplot</span>(selected_cor,</span>
<span id="cb112-58"><a href="#cb112-58"></a>  <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">type =</span> <span class="st">"upper"</span>,</span>
<span id="cb112-59"><a href="#cb112-59"></a>  <span class="at">order =</span> <span class="st">"hclust"</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>, <span class="at">tl.col =</span> <span class="st">"black"</span></span>
<span id="cb112-60"><a href="#cb112-60"></a>)</span>
<span id="cb112-61"><a href="#cb112-61"></a></span>
<span id="cb112-62"><a href="#cb112-62"></a><span class="fu">grid.arrange</span>(p1_var, p2_var, p3_var, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="comprehensive-example-complete-regression-analysis" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="comprehensive-example-complete-regression-analysis"><span class="header-section-number">1.5</span> Comprehensive Example: Complete Regression Analysis</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Comprehensive Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>A manufacturing engineer conducts a complete regression analysis to optimize a production process:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-25-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-1" role="tab" aria-controls="tabset-25-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-2" role="tab" aria-controls="tabset-25-2" aria-selected="false">R Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-25-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-25-3" role="tab" aria-controls="tabset-25-3" aria-selected="false"></a><a href="data/production_optimization.csv">Download Data</a></li></ul>
<div class="tab-content">
<div id="tabset-25-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-25-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Production Optimization Data Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       n temp_mean  temp_sd pressure_mean pressure_sd time_mean  time_sd
   &lt;int&gt;     &lt;num&gt;    &lt;num&gt;         &lt;num&gt;       &lt;num&gt;     &lt;num&gt;    &lt;num&gt;
1:    40  182.9235 13.28839      7.768272    1.368849  44.61594 6.506526
   yield_mean yield_sd
        &lt;num&gt;    &lt;num&gt;
1:   153.0184 7.917538</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Yield by Operator:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   operator     n mean_yield sd_yield
     &lt;char&gt; &lt;int&gt;      &lt;num&gt;    &lt;num&gt;
1:        A    12   153.8781 6.764170
2:        B    13   153.7998 8.222506
3:        C    15   151.6535 8.805235</code></pre>
</div>
</div>
</div>
<div id="tabset-25-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="co"># Comprehensive regression analysis example</span></span>
<span id="cb117-2"><a href="#cb117-2"></a><span class="fu">set.seed</span>(<span class="dv">161718</span>)</span>
<span id="cb117-3"><a href="#cb117-3"></a>production_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb117-4"><a href="#cb117-4"></a>  <span class="at">batch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>,</span>
<span id="cb117-5"><a href="#cb117-5"></a>  <span class="at">temp =</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">180</span>, <span class="at">sd =</span> <span class="dv">15</span>),</span>
<span id="cb117-6"><a href="#cb117-6"></a>  <span class="at">pressure =</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">8</span>, <span class="at">sd =</span> <span class="fl">1.5</span>),</span>
<span id="cb117-7"><a href="#cb117-7"></a>  <span class="at">time =</span> <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">45</span>, <span class="at">sd =</span> <span class="dv">8</span>),</span>
<span id="cb117-8"><a href="#cb117-8"></a>  <span class="at">operator =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), <span class="dv">40</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb117-9"><a href="#cb117-9"></a>  <span class="at">yield =</span> <span class="cn">NULL</span></span>
<span id="cb117-10"><a href="#cb117-10"></a>)</span>
<span id="cb117-11"><a href="#cb117-11"></a></span>
<span id="cb117-12"><a href="#cb117-12"></a><span class="co"># Complex relationship with interactions and quadratic terms</span></span>
<span id="cb117-13"><a href="#cb117-13"></a>production_data[, yield <span class="sc">:</span><span class="er">=</span> <span class="dv">60</span> <span class="sc">+</span></span>
<span id="cb117-14"><a href="#cb117-14"></a>  <span class="fl">0.5</span> <span class="sc">*</span> temp <span class="sc">+</span></span>
<span id="cb117-15"><a href="#cb117-15"></a>  <span class="fl">3.0</span> <span class="sc">*</span> pressure <span class="sc">+</span></span>
<span id="cb117-16"><a href="#cb117-16"></a>  <span class="fl">0.3</span> <span class="sc">*</span> time <span class="sc">+</span></span>
<span id="cb117-17"><a href="#cb117-17"></a>  <span class="fl">0.01</span> <span class="sc">*</span> temp <span class="sc">*</span> pressure <span class="sc">+</span> <span class="co"># interaction</span></span>
<span id="cb117-18"><a href="#cb117-18"></a>  <span class="sc">-</span><span class="fl">0.0015</span> <span class="sc">*</span> temp<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="co"># quadratic term</span></span>
<span id="cb117-19"><a href="#cb117-19"></a>  <span class="fu">ifelse</span>(operator <span class="sc">==</span> <span class="st">"B"</span>, <span class="dv">5</span>, <span class="dv">0</span>) <span class="sc">+</span> <span class="co"># operator effect</span></span>
<span id="cb117-20"><a href="#cb117-20"></a>  <span class="fu">ifelse</span>(operator <span class="sc">==</span> <span class="st">"C"</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb117-21"><a href="#cb117-21"></a>  <span class="fu">rnorm</span>(<span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">4</span>)]</span>
<span id="cb117-22"><a href="#cb117-22"></a></span>
<span id="cb117-23"><a href="#cb117-23"></a><span class="fu">print</span>(<span class="st">"Production Optimization Data Summary:"</span>)</span>
<span id="cb117-24"><a href="#cb117-24"></a>prod_summary <span class="ot">&lt;-</span> production_data <span class="sc">%&gt;%</span></span>
<span id="cb117-25"><a href="#cb117-25"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb117-26"><a href="#cb117-26"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(batch),</span>
<span id="cb117-27"><a href="#cb117-27"></a>    <span class="at">temp_mean =</span> <span class="fu">fmean</span>(temp),</span>
<span id="cb117-28"><a href="#cb117-28"></a>    <span class="at">temp_sd =</span> <span class="fu">fsd</span>(temp),</span>
<span id="cb117-29"><a href="#cb117-29"></a>    <span class="at">pressure_mean =</span> <span class="fu">fmean</span>(pressure),</span>
<span id="cb117-30"><a href="#cb117-30"></a>    <span class="at">pressure_sd =</span> <span class="fu">fsd</span>(pressure),</span>
<span id="cb117-31"><a href="#cb117-31"></a>    <span class="at">time_mean =</span> <span class="fu">fmean</span>(time),</span>
<span id="cb117-32"><a href="#cb117-32"></a>    <span class="at">time_sd =</span> <span class="fu">fsd</span>(time),</span>
<span id="cb117-33"><a href="#cb117-33"></a>    <span class="at">yield_mean =</span> <span class="fu">fmean</span>(yield),</span>
<span id="cb117-34"><a href="#cb117-34"></a>    <span class="at">yield_sd =</span> <span class="fu">fsd</span>(yield)</span>
<span id="cb117-35"><a href="#cb117-35"></a>  )</span>
<span id="cb117-36"><a href="#cb117-36"></a><span class="fu">print</span>(prod_summary)</span>
<span id="cb117-37"><a href="#cb117-37"></a></span>
<span id="cb117-38"><a href="#cb117-38"></a><span class="co"># Operator summary</span></span>
<span id="cb117-39"><a href="#cb117-39"></a>operator_summary <span class="ot">&lt;-</span> production_data <span class="sc">%&gt;%</span></span>
<span id="cb117-40"><a href="#cb117-40"></a>  <span class="fu">fgroup_by</span>(operator) <span class="sc">%&gt;%</span></span>
<span id="cb117-41"><a href="#cb117-41"></a>  <span class="fu">fsummarise</span>(</span>
<span id="cb117-42"><a href="#cb117-42"></a>    <span class="at">n =</span> <span class="fu">fnobs</span>(yield),</span>
<span id="cb117-43"><a href="#cb117-43"></a>    <span class="at">mean_yield =</span> <span class="fu">fmean</span>(yield),</span>
<span id="cb117-44"><a href="#cb117-44"></a>    <span class="at">sd_yield =</span> <span class="fu">fsd</span>(yield)</span>
<span id="cb117-45"><a href="#cb117-45"></a>  )</span>
<span id="cb117-46"><a href="#cb117-46"></a><span class="fu">print</span>(<span class="st">"Yield by Operator:"</span>)</span>
<span id="cb117-47"><a href="#cb117-47"></a><span class="fu">print</span>(operator_summary)</span>
<span id="cb117-48"><a href="#cb117-48"></a></span>
<span id="cb117-49"><a href="#cb117-49"></a><span class="co"># Write data to CSV</span></span>
<span id="cb117-50"><a href="#cb117-50"></a><span class="fu">fwrite</span>(production_data, <span class="st">"data/production_optimization.csv"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div id="tabset-25-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-25-3-tab">

</div>
</div>
</div>
<p><strong>Complete Analysis Steps:</strong></p>
<ol type="1">
<li><p><strong>Exploratory Data Analysis</strong></p></li>
<li><p><strong>Simple Linear Regression</strong></p></li>
<li><p><strong>Multiple Regression</strong></p></li>
<li><p><strong>Polynomial Terms</strong></p></li>
<li><p><strong>Model Diagnostics</strong></p></li>
<li><p><strong>Variable Selection</strong></p></li>
<li><p><strong>Final Model Validation</strong></p></li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-26-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-1" role="tab" aria-controls="tabset-26-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-26-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-26-2" role="tab" aria-controls="tabset-26-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-26-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-26-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "=== COMPREHENSIVE REGRESSION ANALYSIS ==="</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n--- STEP 1: EXPLORATORY DATA ANALYSIS ---"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Correlation Matrix (numeric variables):"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          temp pressure  time yield
temp     1.000    0.202 0.326 0.256
pressure 0.202    1.000 0.081 0.865
time     0.326    0.081 1.000 0.193
yield    0.256    0.865 0.193 1.000</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n--- STEP 2: SIMPLE LINEAR REGRESSIONS ---"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Simple Linear Regression Results:"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in Math.data.frame(structure(list(Predictor = c("Temperature", "Pressure", : non-numeric-alike variable(s) in data frame: Predictor</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n--- STEP 3: MULTIPLE REGRESSION - MAIN EFFECTS ---"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ temp + pressure + time + operator, data = production_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.9510 -1.9880 -0.6332  1.6444  7.3494 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 100.92275    8.32329  12.125 6.75e-14 ***
temp          0.02179    0.04351   0.501   0.6198    
pressure      5.16863    0.40476  12.770 1.58e-14 ***
time          0.18107    0.09638   1.879   0.0689 .  
operatorB     2.70940    1.50947   1.795   0.0816 .  
operatorC    -2.66870    1.39023  -1.920   0.0633 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.339 on 34 degrees of freedom
Multiple R-squared:  0.845, Adjusted R-squared:  0.8222 
F-statistic: 37.06 on 5 and 34 DF,  p-value: 7.99e-13</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n--- STEP 4: POLYNOMIAL TERMS ---"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model with quadratic terms:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ temp + pressure + time + operator + I(temp^2) + 
    I(pressure^2), data = production_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.8800 -2.3948 -0.3778  1.8195  6.9391 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    1.016e+02  9.148e+01   1.111   0.2750  
temp           1.551e-01  9.902e-01   0.157   0.8765  
pressure       1.953e+00  4.266e+00   0.458   0.6501  
time           1.820e-01  9.871e-02   1.844   0.0744 .
operatorB      2.769e+00  1.608e+00   1.722   0.0947 .
operatorC     -2.831e+00  1.454e+00  -1.948   0.0603 .
I(temp^2)     -3.837e-04  2.745e-03  -0.140   0.8897  
I(pressure^2)  2.063e-01  2.720e-01   0.758   0.4539  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.41 on 32 degrees of freedom
Multiple R-squared:  0.8478,    Adjusted R-squared:  0.8145 
F-statistic: 25.46 on 7 and 32 DF,  p-value: 2.249e-11</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-test for polynomial terms:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: yield ~ temp + pressure + time + operator
Model 2: yield ~ temp + pressure + time + operator + I(temp^2) + I(pressure^2)
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     34 379.04                           
2     32 372.12  2    6.9196 0.2975 0.7447</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n--- STEP 5: INTERACTION TERMS ---"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model with interaction:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ temp + pressure + time + operator + I(temp^2) + 
    temp:pressure, data = production_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.0145 -1.9143 -0.6736  1.6542  7.3233 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   88.1805758 90.6278053   0.973   0.3379  
temp           0.1572700  1.0375790   0.152   0.8805  
pressure       5.3005491  7.3022345   0.726   0.4732  
time           0.1820613  0.0996318   1.827   0.0770 .
operatorB      2.7710622  1.6318944   1.698   0.0992 .
operatorC     -2.6475067  1.4768318  -1.793   0.0825 .
I(temp^2)     -0.0003614  0.0032065  -0.113   0.9110  
temp:pressure -0.0006904  0.0393592  -0.018   0.9861  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.441 on 32 degrees of freedom
Multiple R-squared:  0.8451,    Adjusted R-squared:  0.8112 
F-statistic: 24.93 on 7 and 32 DF,  p-value: 2.967e-11</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F-test for interaction term:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: yield ~ temp + pressure + time + operator + I(temp^2) + I(pressure^2)
Model 2: yield ~ temp + pressure + time + operator + I(temp^2) + temp:pressure
  Res.Df    RSS Df Sum of Sq F Pr(&gt;F)
1     32 372.12                      
2     32 378.80  0   -6.6817         </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n--- STEP 6: MODEL SELECTION ---"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model Comparison:"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in Math.data.frame(structure(list(Model = c("Main Effects", "Polynomial", : non-numeric-alike variable(s) in data frame: Model</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Best model by AIC: Main Effects"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n--- STEP 7: FINAL MODEL DIAGNOSTICS ---"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Final Model Diagnostic Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Residual standard error:"</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in print.default("Multiple R-squared:", round(summary(final_model)$r.squared, : invalid printing digits 0</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>Error in print.default("Adjusted R-squared:", round(summary(final_model)$adj.r.squared, : invalid printing digits 0</code></pre>
</div>
</div>
</div>
<div id="tabset-26-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-26-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1"></a><span class="co"># Comprehensive regression analysis steps</span></span>
<span id="cb146-2"><a href="#cb146-2"></a></span>
<span id="cb146-3"><a href="#cb146-3"></a><span class="fu">print</span>(<span class="st">"=== COMPREHENSIVE REGRESSION ANALYSIS ==="</span>)</span>
<span id="cb146-4"><a href="#cb146-4"></a></span>
<span id="cb146-5"><a href="#cb146-5"></a><span class="co"># Step 1: Exploratory Data Analysis</span></span>
<span id="cb146-6"><a href="#cb146-6"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- STEP 1: EXPLORATORY DATA ANALYSIS ---"</span>)</span>
<span id="cb146-7"><a href="#cb146-7"></a>cor_matrix_prod <span class="ot">&lt;-</span> <span class="fu">cor</span>(production_data[, .(temp, pressure, time, yield)])</span>
<span id="cb146-8"><a href="#cb146-8"></a><span class="fu">print</span>(<span class="st">"Correlation Matrix (numeric variables):"</span>)</span>
<span id="cb146-9"><a href="#cb146-9"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix_prod, <span class="dv">3</span>))</span>
<span id="cb146-10"><a href="#cb146-10"></a></span>
<span id="cb146-11"><a href="#cb146-11"></a><span class="co"># Step 2: Simple linear regressions</span></span>
<span id="cb146-12"><a href="#cb146-12"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- STEP 2: SIMPLE LINEAR REGRESSIONS ---"</span>)</span>
<span id="cb146-13"><a href="#cb146-13"></a>lm_temp <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> temp, <span class="at">data =</span> production_data)</span>
<span id="cb146-14"><a href="#cb146-14"></a>lm_pressure <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> pressure, <span class="at">data =</span> production_data)</span>
<span id="cb146-15"><a href="#cb146-15"></a>lm_time <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> time, <span class="at">data =</span> production_data)</span>
<span id="cb146-16"><a href="#cb146-16"></a></span>
<span id="cb146-17"><a href="#cb146-17"></a>simple_models <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb146-18"><a href="#cb146-18"></a>  <span class="at">Predictor =</span> <span class="fu">c</span>(<span class="st">"Temperature"</span>, <span class="st">"Pressure"</span>, <span class="st">"Time"</span>),</span>
<span id="cb146-19"><a href="#cb146-19"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb146-20"><a href="#cb146-20"></a>    <span class="fu">summary</span>(lm_temp)<span class="sc">$</span>r.squared,</span>
<span id="cb146-21"><a href="#cb146-21"></a>    <span class="fu">summary</span>(lm_pressure)<span class="sc">$</span>r.squared,</span>
<span id="cb146-22"><a href="#cb146-22"></a>    <span class="fu">summary</span>(lm_time)<span class="sc">$</span>r.squared</span>
<span id="cb146-23"><a href="#cb146-23"></a>  ),</span>
<span id="cb146-24"><a href="#cb146-24"></a>  <span class="at">F_statistic =</span> <span class="fu">c</span>(</span>
<span id="cb146-25"><a href="#cb146-25"></a>    <span class="fu">summary</span>(lm_temp)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb146-26"><a href="#cb146-26"></a>    <span class="fu">summary</span>(lm_pressure)<span class="sc">$</span>fstatistic[<span class="dv">1</span>],</span>
<span id="cb146-27"><a href="#cb146-27"></a>    <span class="fu">summary</span>(lm_time)<span class="sc">$</span>fstatistic[<span class="dv">1</span>]</span>
<span id="cb146-28"><a href="#cb146-28"></a>  ),</span>
<span id="cb146-29"><a href="#cb146-29"></a>  <span class="at">p_value =</span> <span class="fu">c</span>(</span>
<span id="cb146-30"><a href="#cb146-30"></a>    <span class="fu">pf</span>(<span class="fu">summary</span>(lm_temp)<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">38</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb146-31"><a href="#cb146-31"></a>    <span class="fu">pf</span>(<span class="fu">summary</span>(lm_pressure)<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">38</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>),</span>
<span id="cb146-32"><a href="#cb146-32"></a>    <span class="fu">pf</span>(<span class="fu">summary</span>(lm_time)<span class="sc">$</span>fstatistic[<span class="dv">1</span>], <span class="dv">1</span>, <span class="dv">38</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb146-33"><a href="#cb146-33"></a>  )</span>
<span id="cb146-34"><a href="#cb146-34"></a>)</span>
<span id="cb146-35"><a href="#cb146-35"></a><span class="fu">print</span>(<span class="st">"Simple Linear Regression Results:"</span>)</span>
<span id="cb146-36"><a href="#cb146-36"></a><span class="fu">print</span>(<span class="fu">round</span>(simple_models, <span class="dv">4</span>))</span>
<span id="cb146-37"><a href="#cb146-37"></a></span>
<span id="cb146-38"><a href="#cb146-38"></a><span class="co"># Step 3: Multiple regression with main effects</span></span>
<span id="cb146-39"><a href="#cb146-39"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- STEP 3: MULTIPLE REGRESSION - MAIN EFFECTS ---"</span>)</span>
<span id="cb146-40"><a href="#cb146-40"></a>production_data[, operator <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(operator)]</span>
<span id="cb146-41"><a href="#cb146-41"></a>lm_main <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> temp <span class="sc">+</span> pressure <span class="sc">+</span> time <span class="sc">+</span> operator, <span class="at">data =</span> production_data)</span>
<span id="cb146-42"><a href="#cb146-42"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm_main))</span>
<span id="cb146-43"><a href="#cb146-43"></a></span>
<span id="cb146-44"><a href="#cb146-44"></a><span class="co"># Step 4: Add polynomial terms</span></span>
<span id="cb146-45"><a href="#cb146-45"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- STEP 4: POLYNOMIAL TERMS ---"</span>)</span>
<span id="cb146-46"><a href="#cb146-46"></a>lm_poly <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> temp <span class="sc">+</span> pressure <span class="sc">+</span> time <span class="sc">+</span> operator <span class="sc">+</span> <span class="fu">I</span>(temp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(pressure<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb146-47"><a href="#cb146-47"></a>  <span class="at">data =</span> production_data</span>
<span id="cb146-48"><a href="#cb146-48"></a>)</span>
<span id="cb146-49"><a href="#cb146-49"></a><span class="fu">print</span>(<span class="st">"Model with quadratic terms:"</span>)</span>
<span id="cb146-50"><a href="#cb146-50"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm_poly))</span>
<span id="cb146-51"><a href="#cb146-51"></a></span>
<span id="cb146-52"><a href="#cb146-52"></a><span class="co"># Test if polynomial terms are needed</span></span>
<span id="cb146-53"><a href="#cb146-53"></a>anova_poly <span class="ot">&lt;-</span> <span class="fu">anova</span>(lm_main, lm_poly)</span>
<span id="cb146-54"><a href="#cb146-54"></a><span class="fu">print</span>(<span class="st">"F-test for polynomial terms:"</span>)</span>
<span id="cb146-55"><a href="#cb146-55"></a><span class="fu">print</span>(anova_poly)</span>
<span id="cb146-56"><a href="#cb146-56"></a></span>
<span id="cb146-57"><a href="#cb146-57"></a><span class="co"># Step 5: Add interaction terms</span></span>
<span id="cb146-58"><a href="#cb146-58"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- STEP 5: INTERACTION TERMS ---"</span>)</span>
<span id="cb146-59"><a href="#cb146-59"></a>lm_interact <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> temp <span class="sc">+</span> pressure <span class="sc">+</span> time <span class="sc">+</span> operator <span class="sc">+</span> <span class="fu">I</span>(temp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> temp<span class="sc">:</span>pressure,</span>
<span id="cb146-60"><a href="#cb146-60"></a>  <span class="at">data =</span> production_data</span>
<span id="cb146-61"><a href="#cb146-61"></a>)</span>
<span id="cb146-62"><a href="#cb146-62"></a><span class="fu">print</span>(<span class="st">"Model with interaction:"</span>)</span>
<span id="cb146-63"><a href="#cb146-63"></a><span class="fu">print</span>(<span class="fu">summary</span>(lm_interact))</span>
<span id="cb146-64"><a href="#cb146-64"></a></span>
<span id="cb146-65"><a href="#cb146-65"></a><span class="co"># Test if interaction is needed</span></span>
<span id="cb146-66"><a href="#cb146-66"></a>anova_interact <span class="ot">&lt;-</span> <span class="fu">anova</span>(lm_poly, lm_interact)</span>
<span id="cb146-67"><a href="#cb146-67"></a><span class="fu">print</span>(<span class="st">"F-test for interaction term:"</span>)</span>
<span id="cb146-68"><a href="#cb146-68"></a><span class="fu">print</span>(anova_interact)</span>
<span id="cb146-69"><a href="#cb146-69"></a></span>
<span id="cb146-70"><a href="#cb146-70"></a><span class="co"># Step 6: Model selection</span></span>
<span id="cb146-71"><a href="#cb146-71"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- STEP 6: MODEL SELECTION ---"</span>)</span>
<span id="cb146-72"><a href="#cb146-72"></a>comprehensive_models <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb146-73"><a href="#cb146-73"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Main Effects"</span>, <span class="st">"Polynomial"</span>, <span class="st">"With Interaction"</span>),</span>
<span id="cb146-74"><a href="#cb146-74"></a>  <span class="at">R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb146-75"><a href="#cb146-75"></a>    <span class="fu">summary</span>(lm_main)<span class="sc">$</span>r.squared,</span>
<span id="cb146-76"><a href="#cb146-76"></a>    <span class="fu">summary</span>(lm_poly)<span class="sc">$</span>r.squared,</span>
<span id="cb146-77"><a href="#cb146-77"></a>    <span class="fu">summary</span>(lm_interact)<span class="sc">$</span>r.squared</span>
<span id="cb146-78"><a href="#cb146-78"></a>  ),</span>
<span id="cb146-79"><a href="#cb146-79"></a>  <span class="at">Adj_R_squared =</span> <span class="fu">c</span>(</span>
<span id="cb146-80"><a href="#cb146-80"></a>    <span class="fu">summary</span>(lm_main)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb146-81"><a href="#cb146-81"></a>    <span class="fu">summary</span>(lm_poly)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb146-82"><a href="#cb146-82"></a>    <span class="fu">summary</span>(lm_interact)<span class="sc">$</span>adj.r.squared</span>
<span id="cb146-83"><a href="#cb146-83"></a>  ),</span>
<span id="cb146-84"><a href="#cb146-84"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(lm_main), <span class="fu">AIC</span>(lm_poly), <span class="fu">AIC</span>(lm_interact)),</span>
<span id="cb146-85"><a href="#cb146-85"></a>  <span class="at">BIC =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(lm_main), <span class="fu">BIC</span>(lm_poly), <span class="fu">BIC</span>(lm_interact)),</span>
<span id="cb146-86"><a href="#cb146-86"></a>  <span class="at">RMSE =</span> <span class="fu">c</span>(</span>
<span id="cb146-87"><a href="#cb146-87"></a>    <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(lm_main)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb146-88"><a href="#cb146-88"></a>    <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(lm_poly)<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb146-89"><a href="#cb146-89"></a>    <span class="fu">sqrt</span>(<span class="fu">mean</span>(<span class="fu">residuals</span>(lm_interact)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb146-90"><a href="#cb146-90"></a>  )</span>
<span id="cb146-91"><a href="#cb146-91"></a>)</span>
<span id="cb146-92"><a href="#cb146-92"></a></span>
<span id="cb146-93"><a href="#cb146-93"></a><span class="fu">print</span>(<span class="st">"Model Comparison:"</span>)</span>
<span id="cb146-94"><a href="#cb146-94"></a><span class="fu">print</span>(<span class="fu">round</span>(comprehensive_models, <span class="dv">4</span>))</span>
<span id="cb146-95"><a href="#cb146-95"></a></span>
<span id="cb146-96"><a href="#cb146-96"></a><span class="co"># Select best model (lowest AIC)</span></span>
<span id="cb146-97"><a href="#cb146-97"></a>best_model_comp <span class="ot">&lt;-</span> <span class="fu">which.min</span>(comprehensive_models<span class="sc">$</span>AIC)</span>
<span id="cb146-98"><a href="#cb146-98"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Best model by AIC:"</span>, comprehensive_models<span class="sc">$</span>Model[best_model_comp]))</span>
<span id="cb146-99"><a href="#cb146-99"></a></span>
<span id="cb146-100"><a href="#cb146-100"></a><span class="co"># Step 7: Final model diagnostics</span></span>
<span id="cb146-101"><a href="#cb146-101"></a><span class="fu">print</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">--- STEP 7: FINAL MODEL DIAGNOSTICS ---"</span>)</span>
<span id="cb146-102"><a href="#cb146-102"></a>final_model <span class="ot">&lt;-</span> lm_interact <span class="co"># Assuming this is the best</span></span>
<span id="cb146-103"><a href="#cb146-103"></a></span>
<span id="cb146-104"><a href="#cb146-104"></a><span class="co"># Basic diagnostics</span></span>
<span id="cb146-105"><a href="#cb146-105"></a>residuals_final <span class="ot">&lt;-</span> <span class="fu">residuals</span>(final_model)</span>
<span id="cb146-106"><a href="#cb146-106"></a>fitted_final <span class="ot">&lt;-</span> <span class="fu">fitted</span>(final_model)</span>
<span id="cb146-107"><a href="#cb146-107"></a>n_final <span class="ot">&lt;-</span> <span class="fu">nrow</span>(production_data)</span>
<span id="cb146-108"><a href="#cb146-108"></a>k_final <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(final_model)) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb146-109"><a href="#cb146-109"></a></span>
<span id="cb146-110"><a href="#cb146-110"></a>diagnostic_final <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb146-111"><a href="#cb146-111"></a>  <span class="at">observation =</span> <span class="dv">1</span><span class="sc">:</span>n_final,</span>
<span id="cb146-112"><a href="#cb146-112"></a>  <span class="at">residuals =</span> residuals_final,</span>
<span id="cb146-113"><a href="#cb146-113"></a>  <span class="at">fitted =</span> fitted_final,</span>
<span id="cb146-114"><a href="#cb146-114"></a>  <span class="at">standardized_resid =</span> residuals_final <span class="sc">/</span> <span class="fu">sd</span>(residuals_final)</span>
<span id="cb146-115"><a href="#cb146-115"></a>)</span>
<span id="cb146-116"><a href="#cb146-116"></a></span>
<span id="cb146-117"><a href="#cb146-117"></a><span class="fu">print</span>(<span class="st">"Final Model Diagnostic Summary:"</span>)</span>
<span id="cb146-118"><a href="#cb146-118"></a><span class="fu">print</span>(<span class="st">"Residual standard error:"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(final_model)<span class="sc">$</span>sigma, <span class="dv">3</span>))</span>
<span id="cb146-119"><a href="#cb146-119"></a><span class="fu">print</span>(<span class="st">"Multiple R-squared:"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(final_model)<span class="sc">$</span>r.squared, <span class="dv">3</span>))</span>
<span id="cb146-120"><a href="#cb146-120"></a><span class="fu">print</span>(<span class="st">"Adjusted R-squared:"</span>, <span class="fu">round</span>(<span class="fu">summary</span>(final_model)<span class="sc">$</span>adj.r.squared, <span class="dv">3</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-27-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-1" role="tab" aria-controls="tabset-27-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-27-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-27-2" role="tab" aria-controls="tabset-27-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-27-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-27-1-tab">
<div class="cell">
<div class="cell-output-display">
<div id="fig-Ch06Code09" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Ch06Code09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="Ch06_files/figure-html/fig-Ch06Code09-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;10: Comprehensive regression analysis dashboard"><img src="Ch06_files/figure-html/fig-Ch06Code09-1.png" class="img-fluid figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Ch06Code09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Comprehensive regression analysis dashboard
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-27-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-27-2-tab">
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="co"># Comprehensive regression analysis dashboard</span></span>
<span id="cb147-2"><a href="#cb147-2"></a></span>
<span id="cb147-3"><a href="#cb147-3"></a><span class="co"># 1. Pairwise scatter plots</span></span>
<span id="cb147-4"><a href="#cb147-4"></a>p1_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> production_data, <span class="fu">aes</span>(<span class="at">x =</span> temp, <span class="at">y =</span> yield, <span class="at">color =</span> operator)) <span class="sc">+</span></span>
<span id="cb147-5"><a href="#cb147-5"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb147-6"><a href="#cb147-6"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb147-7"><a href="#cb147-7"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Temperature"</span>, <span class="at">y =</span> <span class="st">"Yield"</span>, <span class="at">title =</span> <span class="st">"Yield vs Temperature"</span>) <span class="sc">+</span></span>
<span id="cb147-8"><a href="#cb147-8"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb147-9"><a href="#cb147-9"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb147-10"><a href="#cb147-10"></a></span>
<span id="cb147-11"><a href="#cb147-11"></a>p2_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> production_data, <span class="fu">aes</span>(<span class="at">x =</span> pressure, <span class="at">y =</span> yield, <span class="at">color =</span> operator)) <span class="sc">+</span></span>
<span id="cb147-12"><a href="#cb147-12"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb147-13"><a href="#cb147-13"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb147-14"><a href="#cb147-14"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Pressure"</span>, <span class="at">y =</span> <span class="st">"Yield"</span>, <span class="at">title =</span> <span class="st">"Yield vs Pressure"</span>) <span class="sc">+</span></span>
<span id="cb147-15"><a href="#cb147-15"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb147-16"><a href="#cb147-16"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb147-17"><a href="#cb147-17"></a></span>
<span id="cb147-18"><a href="#cb147-18"></a><span class="co"># 2. Model comparison plot</span></span>
<span id="cb147-19"><a href="#cb147-19"></a>model_comp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb147-20"><a href="#cb147-20"></a>  <span class="at">data =</span> comprehensive_models,</span>
<span id="cb147-21"><a href="#cb147-21"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Model, <span class="sc">-</span>Adj_R_squared), <span class="at">y =</span> Adj_R_squared)</span>
<span id="cb147-22"><a href="#cb147-22"></a>) <span class="sc">+</span></span>
<span id="cb147-23"><a href="#cb147-23"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb147-24"><a href="#cb147-24"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Adj_R_squared, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb147-25"><a href="#cb147-25"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Model"</span>, <span class="at">y =</span> <span class="st">"Adjusted R²"</span>, <span class="at">title =</span> <span class="st">"Model Comparison"</span>) <span class="sc">+</span></span>
<span id="cb147-26"><a href="#cb147-26"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb147-27"><a href="#cb147-27"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb147-28"><a href="#cb147-28"></a></span>
<span id="cb147-29"><a href="#cb147-29"></a><span class="co"># 3. Final model diagnostics</span></span>
<span id="cb147-30"><a href="#cb147-30"></a>p3_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> diagnostic_final, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb147-31"><a href="#cb147-31"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb147-32"><a href="#cb147-32"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb147-33"><a href="#cb147-33"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb147-34"><a href="#cb147-34"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted Values"</span>, <span class="at">y =</span> <span class="st">"Residuals"</span>, <span class="at">title =</span> <span class="st">"Final Model Diagnostics"</span>) <span class="sc">+</span></span>
<span id="cb147-35"><a href="#cb147-35"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb147-36"><a href="#cb147-36"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb147-37"><a href="#cb147-37"></a></span>
<span id="cb147-38"><a href="#cb147-38"></a><span class="co"># 4. Actual vs Predicted</span></span>
<span id="cb147-39"><a href="#cb147-39"></a>p4_comp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb147-40"><a href="#cb147-40"></a>  <span class="at">data =</span> <span class="fu">data.table</span>(<span class="at">actual =</span> production_data<span class="sc">$</span>yield, <span class="at">predicted =</span> fitted_final),</span>
<span id="cb147-41"><a href="#cb147-41"></a>  <span class="fu">aes</span>(<span class="at">x =</span> predicted, <span class="at">y =</span> actual)</span>
<span id="cb147-42"><a href="#cb147-42"></a>) <span class="sc">+</span></span>
<span id="cb147-43"><a href="#cb147-43"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb147-44"><a href="#cb147-44"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb147-45"><a href="#cb147-45"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Predicted Yield"</span>, <span class="at">y =</span> <span class="st">"Actual Yield"</span>, <span class="at">title =</span> <span class="st">"Actual vs Predicted"</span>) <span class="sc">+</span></span>
<span id="cb147-46"><a href="#cb147-46"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb147-47"><a href="#cb147-47"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb147-48"><a href="#cb147-48"></a></span>
<span id="cb147-49"><a href="#cb147-49"></a><span class="fu">grid.arrange</span>(p1_comp, p2_comp, model_comp_plot, p3_comp, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="key-formulas-and-decision-framework" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="key-formulas-and-decision-framework"><span class="header-section-number">1.6</span> Key Formulas and Decision Framework</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Essential Formulas Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Simple Linear Regression:</strong></p>
<p><span class="math display">\hat{\beta}_1 = \frac{S_{xy}}{S_{xx}}, \quad \hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}</span></p>
<p><strong>Multiple Regression:</strong></p>
<p><span class="math display">\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{y}</span></p>
<p><strong>Coefficient of Determination:</strong></p>
<p><span class="math display">R^2 = \frac{SS_R}{SS_T}, \quad R_{adj}^2 = 1 - \frac{(1-R^2)(n-1)}{n-k-1}</span></p>
<p><strong>Prediction Interval:</strong></p>
<p><span class="math display">\hat{y}_0 \pm t_{\alpha/2, n-k-1} \sqrt{MS_E\left(1 + \mathbf{x}_0^T(\mathbf{X}^T\mathbf{X})^{-1}\mathbf{x}_0\right)}</span></p>
<p><strong>F-Test for Overall Significance:</strong></p>
<p><span class="math display">F_0 = \frac{MS_R}{MS_E} = \frac{SS_R/k}{SS_E/(n-k-1)}</span></p>
<p><strong>t-Test for Individual Parameters:</strong></p>
<p><span class="math display">t_0 = \frac{\hat{\beta}_j}{SE(\hat{\beta}_j)}</span></p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-28-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-1" role="tab" aria-controls="tabset-28-1" aria-selected="true">R Output</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-28-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-28-2" role="tab" aria-controls="tabset-28-2" aria-selected="false">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-28-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-28-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Key Formulas and Functions Summary:"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                Purpose                Key_Formula    R_Function
                 &lt;char&gt;                     &lt;char&gt;        &lt;char&gt;
1: Parameter Estimation             β̂ = (X'X)⁻¹X'y          lm()
2:   Hypothesis Testing              t = β̂ⱼ/SE(β̂ⱼ)     summary()
3:      Model Selection AIC = n ln(SSE/n) + 2(k+1) step(), AIC()
4:           Prediction     ŷ ± t_{α/2} × SE(pred)     predict()
5:          Diagnostics            VIF = 1/(1-R²ⱼ) vif(), plot()
              Interpretation
                      &lt;char&gt;
1:   Least squares estimates
2:   Test significance of βⱼ
3: Balance fit vs complexity
4:     Individual prediction
5:   Check multicollinearity</code></pre>
</div>
<div id="tbl-Ch06Code01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-Ch06Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Model selection criteria comparison
</figcaption>
<div aria-describedby="tbl-Ch06Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small">
<caption>Regression Model Types and Applications</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model_Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Example</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Key_Feature</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">R_squared_Range</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Main_Diagnostic</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">When_to_Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; width: 2.5cm;">Simple Linear</td>
<td style="text-align: left; width: 2.5cm;">Steel Strength</td>
<td style="text-align: left; width: 3cm;">Single predictor</td>
<td style="text-align: left; width: 2cm;">0.60-0.80</td>
<td style="text-align: left; width: 2.5cm;">Linearity</td>
<td style="text-align: left; width: 3.5cm;">Exploring relationships</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 2.5cm;">Multiple Linear</td>
<td style="text-align: left; width: 2.5cm;">Chemical Yield</td>
<td style="text-align: left; width: 3cm;">Multiple predictors</td>
<td style="text-align: left; width: 2cm;">0.75-0.90</td>
<td style="text-align: left; width: 2.5cm;">Multicollinearity</td>
<td style="text-align: left; width: 3.5cm;">Multiple continuous predictors</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 2.5cm;">Polynomial</td>
<td style="text-align: left; width: 2.5cm;">Reaction Rate</td>
<td style="text-align: left; width: 3cm;">Nonlinear relationship</td>
<td style="text-align: left; width: 2cm;">0.85-0.95</td>
<td style="text-align: left; width: 2.5cm;">Curvature</td>
<td style="text-align: left; width: 3.5cm;">Curved relationships</td>
</tr>
<tr class="even">
<td style="text-align: left; width: 2.5cm;">Categorical</td>
<td style="text-align: left; width: 2.5cm;">Strength by Supplier</td>
<td style="text-align: left; width: 3cm;">Factor variables</td>
<td style="text-align: left; width: 2cm;">0.70-0.85</td>
<td style="text-align: left; width: 2.5cm;">Group effects</td>
<td style="text-align: left; width: 3.5cm;">Comparing groups/categories</td>
</tr>
<tr class="odd">
<td style="text-align: left; width: 2.5cm;">Variable Selection</td>
<td style="text-align: left; width: 2.5cm;">Quality Prediction</td>
<td style="text-align: left; width: 3cm;">Automated selection</td>
<td style="text-align: left; width: 2cm;">0.80-0.92</td>
<td style="text-align: left; width: 2.5cm;">Overfitting</td>
<td style="text-align: left; width: 3.5cm;">Many potential predictors</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
<div id="tabset-28-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-28-2-tab">
<div id="tbl-Ch06Code01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-Ch06Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2
</figcaption>
<div aria-describedby="tbl-Ch06Code01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a><span class="co"># Model selection criteria comparison table</span></span>
<span id="cb150-2"><a href="#cb150-2"></a>all_models_summary <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb150-3"><a href="#cb150-3"></a>  <span class="at">Model_Type =</span> <span class="fu">c</span>(<span class="st">"Simple Linear"</span>, <span class="st">"Multiple Linear"</span>, <span class="st">"Polynomial"</span>, <span class="st">"Categorical"</span>, <span class="st">"Variable Selection"</span>),</span>
<span id="cb150-4"><a href="#cb150-4"></a>  <span class="at">Example =</span> <span class="fu">c</span>(<span class="st">"Steel Strength"</span>, <span class="st">"Chemical Yield"</span>, <span class="st">"Reaction Rate"</span>, <span class="st">"Strength by Supplier"</span>, <span class="st">"Quality Prediction"</span>),</span>
<span id="cb150-5"><a href="#cb150-5"></a>  <span class="at">Key_Feature =</span> <span class="fu">c</span>(<span class="st">"Single predictor"</span>, <span class="st">"Multiple predictors"</span>, <span class="st">"Nonlinear relationship"</span>, <span class="st">"Factor variables"</span>, <span class="st">"Automated selection"</span>),</span>
<span id="cb150-6"><a href="#cb150-6"></a>  <span class="at">R_squared_Range =</span> <span class="fu">c</span>(<span class="st">"0.60-0.80"</span>, <span class="st">"0.75-0.90"</span>, <span class="st">"0.85-0.95"</span>, <span class="st">"0.70-0.85"</span>, <span class="st">"0.80-0.92"</span>),</span>
<span id="cb150-7"><a href="#cb150-7"></a>  <span class="at">Main_Diagnostic =</span> <span class="fu">c</span>(<span class="st">"Linearity"</span>, <span class="st">"Multicollinearity"</span>, <span class="st">"Curvature"</span>, <span class="st">"Group effects"</span>, <span class="st">"Overfitting"</span>),</span>
<span id="cb150-8"><a href="#cb150-8"></a>  <span class="at">When_to_Use =</span> <span class="fu">c</span>(</span>
<span id="cb150-9"><a href="#cb150-9"></a>    <span class="st">"Exploring relationships"</span>,</span>
<span id="cb150-10"><a href="#cb150-10"></a>    <span class="st">"Multiple continuous predictors"</span>,</span>
<span id="cb150-11"><a href="#cb150-11"></a>    <span class="st">"Curved relationships"</span>,</span>
<span id="cb150-12"><a href="#cb150-12"></a>    <span class="st">"Comparing groups/categories"</span>,</span>
<span id="cb150-13"><a href="#cb150-13"></a>    <span class="st">"Many potential predictors"</span></span>
<span id="cb150-14"><a href="#cb150-14"></a>  )</span>
<span id="cb150-15"><a href="#cb150-15"></a>)</span>
<span id="cb150-16"><a href="#cb150-16"></a></span>
<span id="cb150-17"><a href="#cb150-17"></a><span class="fu">kbl</span>(all_models_summary,</span>
<span id="cb150-18"><a href="#cb150-18"></a>  <span class="at">caption =</span> <span class="st">"Regression Model Types and Applications"</span></span>
<span id="cb150-19"><a href="#cb150-19"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb150-20"><a href="#cb150-20"></a>  <span class="fu">kable_styling</span>() <span class="sc">%&gt;%</span></span>
<span id="cb150-21"><a href="#cb150-21"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">width =</span> <span class="st">"2.5cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-22"><a href="#cb150-22"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">width =</span> <span class="st">"2.5cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-23"><a href="#cb150-23"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">width =</span> <span class="st">"3cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-24"><a href="#cb150-24"></a>  <span class="fu">column_spec</span>(<span class="dv">4</span>, <span class="at">width =</span> <span class="st">"2cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-25"><a href="#cb150-25"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">width =</span> <span class="st">"2.5cm"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb150-26"><a href="#cb150-26"></a>  <span class="fu">column_spec</span>(<span class="dv">6</span>, <span class="at">width =</span> <span class="st">"3.5cm"</span>)</span>
<span id="cb150-27"><a href="#cb150-27"></a></span>
<span id="cb150-28"><a href="#cb150-28"></a><span class="co"># Summary of all key formulas and criteria</span></span>
<span id="cb150-29"><a href="#cb150-29"></a>formula_summary <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb150-30"><a href="#cb150-30"></a>  <span class="at">Purpose =</span> <span class="fu">c</span>(<span class="st">"Parameter Estimation"</span>, <span class="st">"Hypothesis Testing"</span>, <span class="st">"Model Selection"</span>, <span class="st">"Prediction"</span>, <span class="st">"Diagnostics"</span>),</span>
<span id="cb150-31"><a href="#cb150-31"></a>  <span class="at">Key_Formula =</span> <span class="fu">c</span>(</span>
<span id="cb150-32"><a href="#cb150-32"></a>    <span class="st">"β̂ = (X'X)⁻¹X'y"</span>,</span>
<span id="cb150-33"><a href="#cb150-33"></a>    <span class="st">"t = β̂ⱼ/SE(β̂ⱼ)"</span>,</span>
<span id="cb150-34"><a href="#cb150-34"></a>    <span class="st">"AIC = n ln(SSE/n) + 2(k+1)"</span>,</span>
<span id="cb150-35"><a href="#cb150-35"></a>    <span class="st">"ŷ ± t_{α/2} × SE(pred)"</span>,</span>
<span id="cb150-36"><a href="#cb150-36"></a>    <span class="st">"VIF = 1/(1-R²ⱼ)"</span></span>
<span id="cb150-37"><a href="#cb150-37"></a>  ),</span>
<span id="cb150-38"><a href="#cb150-38"></a>  <span class="at">R_Function =</span> <span class="fu">c</span>(<span class="st">"lm()"</span>, <span class="st">"summary()"</span>, <span class="st">"step(), AIC()"</span>, <span class="st">"predict()"</span>, <span class="st">"vif(), plot()"</span>),</span>
<span id="cb150-39"><a href="#cb150-39"></a>  <span class="at">Interpretation =</span> <span class="fu">c</span>(</span>
<span id="cb150-40"><a href="#cb150-40"></a>    <span class="st">"Least squares estimates"</span>,</span>
<span id="cb150-41"><a href="#cb150-41"></a>    <span class="st">"Test significance of βⱼ"</span>,</span>
<span id="cb150-42"><a href="#cb150-42"></a>    <span class="st">"Balance fit vs complexity"</span>,</span>
<span id="cb150-43"><a href="#cb150-43"></a>    <span class="st">"Individual prediction"</span>,</span>
<span id="cb150-44"><a href="#cb150-44"></a>    <span class="st">"Check multicollinearity"</span></span>
<span id="cb150-45"><a href="#cb150-45"></a>  )</span>
<span id="cb150-46"><a href="#cb150-46"></a>)</span>
<span id="cb150-47"><a href="#cb150-47"></a></span>
<span id="cb150-48"><a href="#cb150-48"></a><span class="fu">print</span>(<span class="st">"Key Formulas and Functions Summary:"</span>)</span>
<span id="cb150-49"><a href="#cb150-49"></a><span class="fu">print</span>(formula_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="chapter-summary" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="chapter-summary"><span class="header-section-number">1.7</span> Chapter Summary</h2>
<p>This chapter covered the fundamental concepts of building empirical models:</p>
<ol type="1">
<li><p><strong>Simple Linear Regression</strong> - Modeling relationships between two variables</p></li>
<li><p><strong>Parameter Estimation</strong> - Using least squares to fit models</p></li>
<li><p><strong>Hypothesis Testing</strong> - Testing significance of model parameters</p></li>
<li><p><strong>Model Validation</strong> - Checking assumptions through residual analysis</p></li>
<li><p><strong>Multiple Regression</strong> - Extending to multiple predictors</p></li>
<li><p><strong>Advanced Topics</strong> - Polynomial models, categorical variables, variable selection</p></li>
</ol>
<p><strong>Key Principles:</strong></p>
<ul>
<li><p>Always validate model assumptions</p></li>
<li><p>Use appropriate diagnostic tools</p></li>
<li><p>Consider both statistical and practical significance</p></li>
<li><p>Apply subject matter knowledge in model building</p></li>
<li><p>Validate models on independent data when possible</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 Muhammad Yaseen. Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></p>
</div>   
    <div class="nav-footer-center">
<p><strong>Math-3020: Statistics for Science &amp; Engineering</strong></p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MYaseen208">
      <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/MYaseen208">
      <i class="bi bi-twitter" role="img" aria-label="Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/muhammad-yaseen-247800b4/">
      <i class="bi bi-linkedin" role="img" aria-label="LinkedIn">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"fade","descPosition":"bottom","loop":false,"openEffect":"fade","selector":".lightbox","skin":"lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>